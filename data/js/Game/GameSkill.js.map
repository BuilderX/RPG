{"version":3,"sources":["src/Game/GameSkill.js"],"names":[],"mappings":"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","file":"src/Game/GameSkill.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n  Game.Skill = class GameSkill extends Sprite.Event {\n    static load (id, callback) {\n      Sprite.Loader.create()\n        .add(`/skill/${id}.json`)\n        .start()\n        .on(\"complete\", (event) => {\n        let skillData = event.data[0];\n        let skillObj = new Game.Skill(skillData);\n        Game.skills[id] = skillObj;\n        skillObj.on(\"complete\", () => {\n          if (typeof callback == \"function\") {\n            callback();\n          }\n        });\n      });\n    }\n\n    constructor (skillData) {\n      super ();\n\n      this.data = skillData;\n      this.id = this.data.id;\n\n      Sprite.Loader.create()\n        .add(`/skill/${this.data.image}`)\n        .add(`/skill/${this.data.icon}`)\n        .add(`/skill/${this.data.sound}`)\n        .start()\n        .on(\"complete\", (event) => {\n        let image = event.data[0];\n        this.icon = event.data[1];\n        this.sound = event.data[2];\n\n        let sheet = new Sprite.Sheet({\n          images: [image],\n          width: this.data.tilewidth,\n          height: this.data.tileheight,\n          animations: this.data.animations\n        });\n\n        sheet.centerX = Math.floor(this.data.tilewidth / 2);\n        sheet.centerY = Math.floor(this.data.tileheight / 2);\n\n        this.sprite = sheet;\n\n        // 发送完成事件，第二个参数代表一次性事件\n        this.emit(\"complete\", true);\n      });\n    }\n\n    get power () {\n      if (typeof this.data.power == \"number\") {\n        return this.data.power;\n      } else if (typeof this.data.power == \"string\") {\n        let m = this.data.power.match(/(\\d+)d(\\d+)/);\n        let times = parseInt(m[1]);\n        let dice = parseInt(m[2]);\n        let sum = 0;\n        for (let i = 0; i < times; i++) {\n          sum += Sprite.rand(0, dice);\n        }\n        return sum;\n      } else {\n        console.error(this, this.data, this.data.power);\n        throw new Error(\"Game.Skill.power invalid power\");\n      }\n    }\n\n    set power (value) {\n      throw new Error(\"Game.Skill.power readonly\");\n    }\n\n    get type () {\n      return this.data.type;\n    }\n\n    set type (value) {\n      throw new Error(\"Game.Skill.type readonly\");\n    }\n\n    can (attacker) {\n      let Type2Text = {\n        sword: \"剑\",\n        spear: \"枪\",\n        bow: \"弓\"\n      };\n\n      if (this.data.needweapontype && attacker == Game.hero) {\n        if (Game.hero.data.equipment.weapon) {\n          let weapon = Game.items[Game.hero.data.equipment.weapon];\n          if (weapon.data.type != this.data.needweapontype) {\n            Game.popup(Game.hero.sprite, `这个技能需要装备 '${Type2Text[this.data.needweapontype]}' 类型的武器`, 0, -40);\n            return false;\n          }\n        } else {\n          Game.popup(Game.hero.sprite, \"这个技能需要装备武器\", 0, -40);\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    fire (attacker, direction, callback) {\n\n      if (this.sound) {\n        this.sound.load();\n        this.sound.play();\n      }\n\n      let animation = \"attack\" + direction;\n      let sprite = this.sprite.clone();\n\n      // 矫正武器效果位置\n      sprite.x = attacker.sprite.x;\n      sprite.y = attacker.sprite.y;\n\n      switch (direction) {\n        case \"left\":\n          sprite.x -= 32;\n          break;\n        case \"up\":\n          sprite.y -= 32;\n          break;\n        case \"right\":\n          sprite.x += 32;\n          break;\n        case \"down\":\n          sprite.y += 32;\n          break;\n      }\n\n      // 矫正武器效果中心\n      if (this.data.animations[animation].centerX) {\n        sprite.centerX = this.data.animations[animation].centerX;\n      }\n      if (this.data.animations[animation].centerY) {\n        sprite.centerY = this.data.animations[animation].centerY;\n      }\n\n\n      // 如果是远距离攻击（this.data.distance > 0），那么distance是它已经走过的举例\n      let distance = 0;\n      // 被命中的actor列表\n      let hitted = [];\n      let CheckHit = () => {\n        // 技能所在当前方格\n        let l1 = Game.area.map.tile(sprite);\n        if (this.data.distance > 0\n          && (l1.x < 0\n            || l1.y < 0\n            || l1.x >= Game.area.map.data.width\n            || l1.y >= Game.area.map.data.height\n          )\n        ) {\n          distance = this.data.distance;\n        }\n        // 碰撞检测\n        for (let actor of Game.area.actors) {\n          if (actor != attacker && hitted.length <= 0) {\n            if (actor.hitTest(l1.x, l1.y)) {\n              hitted.push(actor);\n            }\n          }\n        }\n      };\n\n      let listener = Sprite.Ticker.on(\"tick\", () => {\n\n        if (this.data.distance > 0) {\n          distance += 4;\n        }\n\n        switch (animation) {\n          case \"attackdown\":\n            sprite.y += distance;\n            break;\n          case \"attackleft\":\n            sprite.x -= distance;\n            break;\n          case \"attackright\":\n            sprite.x += distance;\n            break;\n          case \"attackup\":\n            sprite.y -= distance;\n            break;\n        }\n\n        CheckHit();\n\n        // 如果击中了一个敌人（单体伤害）\n        if (hitted.length > 0) {\n          Finish();\n        }\n\n        // 如果是远程攻击，并且攻击距离已经到了\n        if (this.data.distance > 0 && distance >= this.data.distance) {\n          Finish();\n        }\n\n        // 如果是近战攻击（this.data.distance <= 0），而且动画已经停止\n        if (this.data.distance <= 0 && sprite.paused) {\n          Finish();\n        }\n\n      });\n\n      // 攻击结束时运行Stop函数\n      let Finish = () => {\n        Sprite.Ticker.off(\"tick\", listener);\n\n        if (hitted.length > 0 && this.data.animations[\"hitted\"]) {\n          let actor = hitted[0];\n          sprite.x = actor.sprite.x;\n          sprite.y = actor.sprite.y;\n          sprite.play(\"hitted\");\n          if (sprite.paused == true) {\n            Game.layers.skillLayer.removeChild(sprite);\n          } else {\n            sprite.on(\"animationend\", function () {\n              Game.layers.skillLayer.removeChild(sprite);\n            });\n          }\n        } else {\n          // 如果动画已经播完，则停止\n          if (sprite.paused == true) {\n            Game.layers.skillLayer.removeChild(sprite);\n          } else {\n            sprite.on(\"animationend\", function () {\n              Game.layers.skillLayer.removeChild(sprite);\n            });\n          }\n        }\n\n        if (typeof callback == \"function\") {\n          callback(hitted);\n        }\n      }\n\n      Game.layers.skillLayer.appendChild(sprite);\n      sprite.play(animation);\n\n      if ( this.data.animations[animation].actor\n        && attacker.data.animations[this.data.animations[animation].actor] ) {\n        attacker.play(this.data.animations[animation].actor, 3);\n      } else {\n        attacker.play(\"face\" + direction, 0);\n        attacker.play(\"attack\" + direction, 3);\n      }\n    }\n\n  };\n\n})();\n"]}