{"version":3,"sources":["src/Game/GameRegister.js"],"names":[],"mappings":"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","file":"src/Game/GameRegister.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n  Game.register = {};\n\n\n\n  // 英雄组件数据\n  var heroCustom = {\n    sex: \"male\",\n    body: \"light\",\n    eyes: \"blue\",\n    hair: \"\",\n    haircolor: \"black\",\n\n    head: \"\",\n    shirts: \"\",\n    pants: \"\",\n    shoes: \"\",\n\n    armorchest: \"\",\n    armorarm: \"\",\n    armorlegs: \"\",\n    armorhelms: \"\",\n    armorfeet: \"\"\n  };\n\n  // 13x21\n  heroCustom.width = 64 * 13; // 832;\n  heroCustom.height = 64 * 21; // 1344;\n  heroCustom.width *= 0.8125;\n  heroCustom.height *= 0.9375;\n  heroCustom.tilewidth = heroCustom.width / 13;\n  heroCustom.tileheight = heroCustom.height / 21;\n\n  Init();\n\n  function Init () {\n\n    window.SelectHero = function (event) {\n      var value = event.target.value;\n      var type = event.target.getAttribute(\"data-type\");\n      if (heroCustom[type] != value) {\n        if (type == \"sex\") {\n          heroCustom.hair = \"\";\n        }\n        heroCustom[type] = value;\n        DisplayHero();\n      }\n      if (heroCustom.sex == \"male\") {\n        document.getElementById(\"customMaleHair\").style.display = \"block\";\n        document.getElementById(\"customFemaleHair\").style.display = \"none\";\n      } else {\n        document.getElementById(\"customMaleHair\").style.display = \"none\";\n        document.getElementById(\"customFemaleHair\").style.display = \"block\";\n      }\n    };\n\n    DisplayHero();\n\n    function DisplayHero () {\n\n      var canvas = document.getElementById(\"registerPreview\");\n      var context = canvas.getContext(\"2d\");\n      context.clearRect(0, 0, canvas.width, canvas.height);\n\n      document.getElementById(\"loading\").innerHTML = \"正在载入预览\";\n      Game.drawHero(heroCustom, function (img) {\n        context.drawImage(img, 0, -128, img.width, img.height);\n        document.getElementById(\"loading\").innerHTML = \"预览\";\n      });\n    }\n\n  }\n\n  // 注册模块\n  Game.register.reg = function () {\n    document.getElementById(\"registerHeroName\").value = \"\";\n    Game.windows.register.show();\n    Init();\n  };\n\n  Game.register.back = function () {\n    Game.windows.main.show();\n  };\n\n  Game.register.submit = function () {\n    var name = document.getElementById(\"registerHeroName\").value;\n\n    if (name.trim().length <= 0) {\n      alert(\"Invalid Name\");\n      return;\n    }\n\n    HeroDefault.id = \"hero_\" + name;\n    HeroDefault.name = name;\n    HeroDefault.custom = heroCustom;\n    HeroDefault.tilewidth = heroCustom.tilewidth;\n    HeroDefault.tileheight = heroCustom.tileheight;\n\n    // 保存一个存档\n    Game.archive.save({\n      hero: HeroDefault\n    });\n\n    Game.windows.register.hide();\n\n    // 空调用，代表读取最新一个存档（last），即刚刚新建的存档\n    Game.archive.load();\n  };\n\n\n  // 含有$开头的代表是基础值\n  // 不含$的同名属性是计算后值，即经过各种加成，buff，nerf之后的值\n  var HeroDefault = {\n    level: 1, // 等级\n    exp: 0, // 经验值\n    // 337年6月4日 9时25分\n    time: 336*(60*24*30*12) + 5*(60*24*30) + 3*(60*24) + 9*(60) + 25,\n\n    // 最基本的属性，其他属性都由此延伸\n    $str: 10, // strength 力量： 物理攻击力\n    $dex: 10, // dexterity 敏捷： 闪避，暴击\n    $con: 10, // constitution 耐力： 生命值\n    $int: 10, // intelligence 智力： 精神力，魔法攻击\n    $cha: 10, // charisma 魅力： 队友能力\n\n    // 下面为0的值将由上面的基本属性计算出来\n\n    str: 0,\n    dex: 0,\n    int: 0,\n    con: 0,\n    cha: 0,\n\n    $hp: 0, // 生命力\n    $sp: 0, // 精神力\n\n    critical: 0, // 暴击率\n    doge: 0, // 闪避\n\n    hp: 0,\n    sp: 0,\n\n    $atk: 0, // 攻击\n    $def: 0, // 防御\n    $matk: 0, // 魔法攻击\n    $mdef: 0, // 魔法防御\n\n    atk: 0,\n    def: 0,\n    matk: 0,\n    mdef: 0,\n\n    buff: [], // 有益状态\n    nerf: [], // 有害状态\n\n    currentQuest: { }, // 当前任务\n    pastQuest: { }, // 完成的任务\n    area: \"starttown\", // 当前所在地图， 初始地图为starttown\n\n    type: \"hero\", // 标识这个actor的类别是hero，其他类别如npc，monster\n\n    // 能力\n    skills: [\n      \"sword01\", // 剑攻击Level1\n      \"spear01\", // 枪攻击Level1\n      \"bow01\", // 弓攻击Level1\n      \"fire01\", // 火球术Level1\n    ],\n\n    // 一共能学习多少能力\n    skillcount: 10,\n    // 技能快捷方式列表\n    bar: [\n      {\n        id: \"sword01\",\n        type: \"skill\"\n      },\n      {\n        id: \"bow01\",\n        type: \"skill\"\n      },\n      null,\n      null,\n      null,\n      null,\n      null,\n      {\n        id: \"potionHealWeak\",\n        type: \"item\"\n      }\n    ],\n\n    // 技能，例如生活技能，说服技能，交易技能\n    //skills: {\n    //  _trade: 0, // 交易，交易时的价格\n    //  _negotiate: 0, // 交涉，具体剧情，招揽同伴时的费用\n    //  _lock: 0, // 开锁\n    //  _knowledge: 0, // 知识，具体剧情，鉴定物品\n    //  _treatment: 0, // 医疗，在使用医疗物品时的效果\n    //  _animal: 0, // 动物战斗加成，动物驯养\n    //},\n\n    equipment: {\n      head: null,\n      body: \"clothNormal\",\n      feet: \"shoesNormal\",\n      weapon: \"swordIron\",\n      neck: null,\n      ring: null\n    },\n\n    items: {\n      \"swordIron\": 1,\n      \"spearIron\": 1,\n      \"bowWood\": 1 ,\n      \"clothNormal\": 1,\n      \"shoesNormal\": 1,\n      \"potionHealWeak\": 5\n    },\n\n    gold: 0,\n\n    animations: {\n      spellcastup: [0, 6, \"\", 40],\n      spellcastleft: [13, 19, \"\", 40],\n      spellcastdown: [26, 32, \"\", 40],\n      spellcastright: [39, 45, \"\", 40],\n\n      thrustup: [52, 59, \"\", 40],\n      thrustleft: [65, 72, \"\", 40],\n      thrustdown: [78, 85, \"\", 40],\n      thrustright: [91, 98, \"\", 40],\n\n      walkup: [104, 112, \"walkup\", 70],\n      walkleft: [117, 125, \"walkleft\", 70],\n      walkdown: [130, 138, \"walkdown\", 70],\n      walkright: [143, 151, \"walkright\", 70],\n\n      runup: [105, 112, \"runup\", 30],\n      runleft: [118, 125, \"runleft\", 30],\n      rundown: [131, 138, \"rundown\", 30],\n      runright: [144, 151, \"runright\", 30],\n\n      slashup: [156, 161, \"\", 40],\n      slashleft: [169, 174, \"\", 40],\n      slashdown: [182, 187, \"\", 40],\n      slashright: [195, 200, \"\", 40],\n\n      shootup: [208, 220, \"\", 40],\n      shootleft: [221, 233, \"\", 40],\n      shootdown: [234, 246, \"\", 40],\n      shootright: [247, 259, \"\", 40],\n\n      hurt: [260, 265, \"\", 60],\n\n      dead: 265,\n\n      faceup: 104,\n      faceleft: 117,\n      facedown: 130,\n      faceright: 143\n    }\n  };\n\n\n})();\n"]}