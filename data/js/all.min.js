(function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i=typeof require=="function"&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}var f=typeof require=="function"&&require;for(var g=0;g<d.length;g++)e(d[g]);return e})({1:[function(a,b,c){var d=b.exports={};var e=[];var f=false;var g;var h=-1;function i(){f=false;if(g.length){e=g.concat(e)}else{h=-1}if(e.length){j()}}function j(){if(f){return}var a=setTimeout(i);f=true;var b=e.length;while(b){g=e;e=[];while(++h<b){if(g){g[h].run()}}h=-1;b=e.length}g=null;f=false;clearTimeout(a)}d.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1){for(var c=1;c<arguments.length;c++){b[c-1]=arguments[c]}}e.push(new k(a,b));if(e.length===1&&!f){setTimeout(j,0)}};function k(a,b){this.fun=a;this.array=b}k.prototype.run=function(){this.fun.apply(null,this.array)};d.title="browser";d.browser=true;d.env={};d.argv=[];d.version="";d.versions={};function l(){}d.on=l;d.addListener=l;d.once=l;d.off=l;d.removeListener=l;d.removeAllListeners=l;d.emit=l;d.binding=function(a){throw new Error("process.binding is not supported")};d.cwd=function(){return"/"};d.chdir=function(a){throw new Error("process.chdir is not supported")};d.umask=function(){return 0}},{}],2:[function(a,b,c){(function(b){"use strict";a("core-js/shim");a("regenerator/runtime");if(b._babelPolyfill){throw new Error("only one instance of babel/polyfill is allowed")}b._babelPolyfill=true}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"core-js/shim":181,"regenerator/runtime":182}],3:[function(a,b,c){b.exports=function(a){if(typeof a!="function")throw TypeError(a+" is not a function!");return a}},{}],4:[function(a,b,c){var d=a("./$.is-object");b.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a}},{"./$.is-object":34}],5:[function(a,b,c){var d=a("./$.to-iobject"),e=a("./$.to-length"),f=a("./$.to-index");b.exports=function(a){return function(b,c,g){var h=d(b),i=e(h.length),j=f(g,i),k;if(a&&c!=c)while(i>j){k=h[j++];if(k!=k)return true}else for(;i>j;j++)if(a||j in h){if(h[j]===c)return a||j}return!a&&-1}}},{"./$.to-index":69,"./$.to-iobject":71,"./$.to-length":72}],6:[function(a,b,c){var d=a("./$.ctx"),e=a("./$.iobject"),f=a("./$.to-object"),g=a("./$.to-length");b.exports=function(a){var b=a==1,c=a==2,h=a==3,i=a==4,j=a==6,k=a==5||j;return function(l,m,n){var o=f(l),p=e(o),q=d(m,n,3),r=g(p.length),s=0,t=b?Array(r):c?[]:undefined,u,v;for(;r>s;s++)if(k||s in p){u=p[s];v=q(u,s,o);if(a){if(b)t[s]=v;else if(v)switch(a){case 3:return true;case 5:return u;case 6:return s;case 2:t.push(u)}else if(i)return false}}return j?-1:h||i?i:t}}},{"./$.ctx":15,"./$.iobject":31,"./$.to-length":72,"./$.to-object":73}],7:[function(a,b,c){var d=a("./$.to-object"),e=a("./$.iobject"),f=a("./$.enum-keys");b.exports=a("./$.fails")(function(){return Symbol()in Object.assign({})})?function g(a,b){var c=d(a),g=arguments.length,h=1;while(g>h){var i=e(arguments[h++]),j=f(i),k=j.length,l=0,m;while(k>l)c[m=j[l++]]=i[m]}return c}:Object.assign},{"./$.enum-keys":19,"./$.fails":21,"./$.iobject":31,"./$.to-object":73}],8:[function(a,b,c){var d=a("./$.cof"),e=a("./$.wks")("toStringTag"),f=d(function(){return arguments}())=="Arguments";b.exports=function(a){var b,c,g;return a===undefined?"Undefined":a===null?"Null":typeof(c=(b=Object(a))[e])=="string"?c:f?d(b):(g=d(b))=="Object"&&typeof b.callee=="function"?"Arguments":g}},{"./$.cof":9,"./$.wks":76}],9:[function(a,b,c){var d={}.toString;b.exports=function(a){return d.call(a).slice(8,-1)}},{}],10:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.hide"),f=a("./$.ctx"),g=a("./$.species"),h=a("./$.strict-new"),i=a("./$.defined"),j=a("./$.for-of"),k=a("./$.iter-step"),l=a("./$.uid")("id"),m=a("./$.has"),n=a("./$.is-object"),o=Object.isExtensible||n,p=a("./$.support-desc"),q=p?"_s":"size",r=0;var s=function(a,b){if(!n(a))return typeof a=="symbol"?a:(typeof a=="string"?"S":"P")+a;if(!m(a,l)){if(!o(a))return"F";if(!b)return"E";e(a,l,++r)}return"O"+a[l]};var t=function(a,b){var c=s(b),d;if(c!=="F")return a._i[c];for(d=a._f;d;d=d.n){if(d.k==b)return d}};b.exports={getConstructor:function(b,c,e,g){var k=b(function(a,b){h(a,k,c);a._i=d.create(null);a._f=undefined;a._l=undefined;a[q]=0;if(b!=undefined)j(b,e,a[g],a)});a("./$.mix")(k.prototype,{clear:function l(){for(var a=this,b=a._i,c=a._f;c;c=c.n){c.r=true;if(c.p)c.p=c.p.n=undefined;delete b[c.i]}a._f=a._l=undefined;a[q]=0},"delete":function(a){var b=this,c=t(b,a);if(c){var d=c.n,e=c.p;delete b._i[c.i];c.r=true;if(e)e.n=d;if(d)d.p=e;if(b._f==c)b._f=d;if(b._l==c)b._l=e;b[q]--}return!!c},forEach:function m(a){var b=f(a,arguments[1],3),c;while(c=c?c.n:this._f){b(c.v,c.k,this);while(c&&c.r)c=c.p}},has:function n(a){return!!t(this,a)}});if(p)d.setDesc(k.prototype,"size",{get:function(){return i(this[q])}});return k},def:function(a,b,c){var d=t(a,b),e,f;if(d){d.v=c}else{a._l=d={i:f=s(b,true),k:b,v:c,p:e=a._l,n:undefined,r:false};if(!a._f)a._f=d;if(e)e.n=d;a[q]++;if(f!=="F")a._i[f]=d}return a},getEntry:t,setStrong:function(b,c,d){a("./$.iter-define")(b,c,function(a,b){this._t=a;this._k=b;this._l=undefined},function(){var a=this,b=a._k,c=a._l;while(c&&c.r)c=c.p;if(!a._t||!(a._l=c=c?c.n:a._t._f)){a._t=undefined;return k(1)}if(b=="keys")return k(0,c.k);if(b=="values")return k(0,c.v);return k(0,[c.k,c.v])},d?"entries":"values",!d,true);g(b);g(a("./$.core")[c])}}},{"./$":41,"./$.core":14,"./$.ctx":15,"./$.defined":17,"./$.for-of":24,"./$.has":27,"./$.hide":28,"./$.is-object":34,"./$.iter-define":37,"./$.iter-step":39,"./$.mix":46,"./$.species":59,"./$.strict-new":60,"./$.support-desc":66,"./$.uid":74}],11:[function(a,b,c){var d=a("./$.for-of"),e=a("./$.classof");b.exports=function(a){return function b(){if(e(this)!=a)throw TypeError(a+"#toJSON isn't generic");var b=[];d(this,false,b.push,b);return b}}},{"./$.classof":8,"./$.for-of":24}],12:[function(a,b,c){"use strict";var d=a("./$.hide"),e=a("./$.an-object"),f=a("./$.strict-new"),g=a("./$.for-of"),h=a("./$.array-methods"),i=a("./$.uid")("weak"),j=a("./$.is-object"),k=a("./$.has"),l=Object.isExtensible||j,m=h(5),n=h(6),o=0;var p=function(a){return a._l||(a._l=new q)};var q=function(){this.a=[]};var r=function(a,b){return m(a.a,function(a){return a[0]===b})};q.prototype={get:function(a){var b=r(this,a);if(b)return b[1]},has:function(a){return!!r(this,a)},set:function(a,b){var c=r(this,a);if(c)c[1]=b;else this.a.push([a,b])},"delete":function(a){var b=n(this.a,function(b){return b[0]===a});if(~b)this.a.splice(b,1);return!!~b}};b.exports={getConstructor:function(b,c,d,e){var h=b(function(a,b){f(a,h,c);a._i=o++;a._l=undefined;if(b!=undefined)g(b,d,a[e],a)});a("./$.mix")(h.prototype,{"delete":function(a){if(!j(a))return false;if(!l(a))return p(this)["delete"](a);return k(a,i)&&k(a[i],this._i)&&delete a[i][this._i]},has:function m(a){if(!j(a))return false;if(!l(a))return p(this).has(a);return k(a,i)&&k(a[i],this._i)}});return h},def:function(a,b,c){if(!l(e(b))){p(a).set(b,c)}else{k(b,i)||d(b,i,{});b[i][a._i]=c}return a},frozenStore:p,WEAK:i}},{"./$.an-object":4,"./$.array-methods":6,"./$.for-of":24,"./$.has":27,"./$.hide":28,"./$.is-object":34,"./$.mix":46,"./$.strict-new":60,"./$.uid":74}],13:[function(a,b,c){"use strict";var d=a("./$.global"),e=a("./$.def"),f=a("./$.for-of"),g=a("./$.strict-new");b.exports=function(b,c,h,i,j,k){var l=d[b],m=l,n=j?"set":"add",o=m&&m.prototype,p={};var q=function(b){var c=o[b];a("./$.redef")(o,b,b=="delete"?function(a){return c.call(this,a===0?0:a)}:b=="has"?function d(a){return c.call(this,a===0?0:a)}:b=="get"?function e(a){return c.call(this,a===0?0:a)}:b=="add"?function f(a){c.call(this,a===0?0:a);return this}:function g(a,b){c.call(this,a===0?0:a,b);return this})};if(typeof m!="function"||!(k||o.forEach&&!a("./$.fails")(function(){(new m).entries().next()}))){m=i.getConstructor(c,b,j,n);a("./$.mix")(m.prototype,h)}else{var r=new m,s=r[n](k?{}:-0,1),t;if(!a("./$.iter-detect")(function(a){new m(a)})){m=c(function(a,c){g(a,m,b);var d=new l;if(c!=undefined)f(c,j,d[n],d);return d});m.prototype=o;o.constructor=m}k||r.forEach(function(a,b){t=1/b===-Infinity});if(t){q("delete");q("has");j&&q("get")}if(t||s!==r)q(n);if(k&&o.clear)delete o.clear}a("./$.tag")(m,b);p[b]=m;e(e.G+e.W+e.F*(m!=l),p);if(!k)i.setStrong(m,b,j);return m}},{"./$.def":16,"./$.fails":21,"./$.for-of":24,"./$.global":26,"./$.iter-detect":38,"./$.mix":46,"./$.redef":53,"./$.strict-new":60,"./$.tag":67}],14:[function(a,b,c){var d=b.exports={};if(typeof __e=="number")__e=d},{}],15:[function(a,b,c){var d=a("./$.a-function");b.exports=function(a,b,c){d(a);if(b===undefined)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},{"./$.a-function":3}],16:[function(a,b,c){var d=a("./$.global"),e=a("./$.core"),f=a("./$.hide"),g=a("./$.redef"),h="prototype";var i=function(a,b){return function(){return a.apply(b,arguments)}};var j=function(a,b,c){var k,l,m,n,o=a&j.G,p=a&j.P,q=o?d:a&j.S?d[b]||(d[b]={}):(d[b]||{})[h],r=o?e:e[b]||(e[b]={});if(o)c=b;for(k in c){l=!(a&j.F)&&q&&k in q;m=(l?q:c)[k];if(a&j.B&&l)n=i(m,d);else n=p&&typeof m=="function"?i(Function.call,m):m;if(q&&!l)g(q,k,m);if(r[k]!=m)f(r,k,n);if(p)(r[h]||(r[h]={}))[k]=m}};d.core=e;j.F=1;j.G=2;j.S=4;j.P=8;j.B=16;j.W=32;b.exports=j},{"./$.core":14,"./$.global":26,"./$.hide":28,"./$.redef":53}],17:[function(a,b,c){b.exports=function(a){if(a==undefined)throw TypeError("Can't call method on  "+a);return a}},{}],18:[function(a,b,c){var d=a("./$.is-object"),e=a("./$.global").document,f=d(e)&&d(e.createElement);b.exports=function(a){return f?e.createElement(a):{}}},{"./$.global":26,"./$.is-object":34}],19:[function(a,b,c){var d=a("./$");b.exports=function(a){var b=d.getKeys(a),c=d.getSymbols;if(c){var e=c(a),f=d.isEnum,g=0,h;while(e.length>g)if(f.call(a,h=e[g++]))b.push(h)}return b}},{"./$":41}],20:[function(a,b,c){b.exports=Math.expm1||function d(a){return(a=+a)==0?a:a>-1e-6&&a<1e-6?a+a*a/2:Math.exp(a)-1}},{}],21:[function(a,b,c){b.exports=function(a){try{return!!a()}catch(b){return true}}},{}],22:[function(a,b,c){"use strict";b.exports=function(b,c,d){var e=a("./$.defined"),f=a("./$.wks")(b),g=""[b];if(a("./$.fails")(function(){var a={};a[f]=function(){return 7};return""[b](a)!=7})){a("./$.redef")(String.prototype,b,d(e,f,g));a("./$.hide")(RegExp.prototype,f,c==2?function(a,b){return g.call(a,this,b)}:function(a){return g.call(a,this)})}}},{"./$.defined":17,"./$.fails":21,"./$.hide":28,"./$.redef":53,"./$.wks":76}],23:[function(a,b,c){"use strict";var d=a("./$.an-object");b.exports=function(){var a=d(this),b="";if(a.global)b+="g";if(a.ignoreCase)b+="i";if(a.multiline)b+="m";if(a.unicode)b+="u";if(a.sticky)b+="y";return b}},{"./$.an-object":4}],24:[function(a,b,c){var d=a("./$.ctx"),e=a("./$.iter-call"),f=a("./$.is-array-iter"),g=a("./$.an-object"),h=a("./$.to-length"),i=a("./core.get-iterator-method");b.exports=function(a,b,c,j){var k=i(a),l=d(c,j,b?2:1),m=0,n,o,p;if(typeof k!="function")throw TypeError(a+" is not iterable!");if(f(k))for(n=h(a.length);n>m;m++){b?l(g(o=a[m])[0],o[1]):l(a[m])}else for(p=k.call(a);!(o=p.next()).done;){e(p,l,o.value,b)}}},{"./$.an-object":4,"./$.ctx":15,"./$.is-array-iter":32,"./$.iter-call":35,"./$.to-length":72,"./core.get-iterator-method":77}],25:[function(a,b,c){var d={}.toString,e=a("./$.to-iobject"),f=a("./$").getNames;var g=typeof window=="object"&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var h=function(a){try{return f(a)}catch(b){return g.slice()}};b.exports.get=function i(a){if(g&&d.call(a)=="[object Window]")return h(a);return f(e(a))}},{"./$":41,"./$.to-iobject":71}],26:[function(a,b,c){var d="undefined";var e=b.exports=typeof window!=d&&window.Math==Math?window:typeof self!=d&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=e},{}],27:[function(a,b,c){var d={}.hasOwnProperty;b.exports=function(a,b){return d.call(a,b)}},{}],28:[function(a,b,c){var d=a("./$"),e=a("./$.property-desc");b.exports=a("./$.support-desc")?function(a,b,c){return d.setDesc(a,b,e(1,c))}:function(a,b,c){a[b]=c;return a}},{"./$":41,"./$.property-desc":52,"./$.support-desc":66}],29:[function(a,b,c){b.exports=a("./$.global").document&&document.documentElement},{"./$.global":26}],30:[function(a,b,c){b.exports=function(a,b,c){var d=c===undefined;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)}},{}],31:[function(a,b,c){var d=a("./$.cof");b.exports=0 in Object("z")?Object:function(a){return d(a)=="String"?a.split(""):Object(a)}},{"./$.cof":9}],32:[function(a,b,c){var d=a("./$.iterators"),e=a("./$.wks")("iterator");b.exports=function(a){return(d.Array||Array.prototype[e])===a}},{"./$.iterators":40,"./$.wks":76}],33:[function(a,b,c){var d=a("./$.is-object"),e=Math.floor;b.exports=function f(a){return!d(a)&&isFinite(a)&&e(a)===a}},{"./$.is-object":34}],34:[function(a,b,c){b.exports=function(a){return a!==null&&(typeof a=="object"||typeof a=="function")}},{}],35:[function(a,b,c){var d=a("./$.an-object");b.exports=function(a,b,c,e){try{return e?b(d(c)[0],c[1]):b(c)}catch(f){var g=a["return"];if(g!==undefined)d(g.call(a));throw f}}},{"./$.an-object":4}],36:[function(a,b,c){"use strict";var d=a("./$"),e={};a("./$.hide")(e,a("./$.wks")("iterator"),function(){return this});b.exports=function(b,c,f){b.prototype=d.create(e,{next:a("./$.property-desc")(1,f)});a("./$.tag")(b,c+" Iterator")}},{"./$":41,"./$.hide":28,"./$.property-desc":52,"./$.tag":67,"./$.wks":76}],37:[function(a,b,c){"use strict";var d=a("./$.library"),e=a("./$.def"),f=a("./$.redef"),g=a("./$.hide"),h=a("./$.has"),i=a("./$.wks")("iterator"),j=a("./$.iterators"),k=!([].keys&&"next"in[].keys()),l="@@iterator",m="keys",n="values";var o=function(){return this};b.exports=function(b,c,p,q,r,s,t){a("./$.iter-create")(p,c,q);var u=function(a){switch(a){case m:return function b(){return new p(this,a)};case n:return function c(){return new p(this,a)}}return function d(){return new p(this,a)}};var v=c+" Iterator",w=b.prototype,x=w[i]||w[l]||r&&w[r],y=x||u(r),z,A;if(x){var B=a("./$").getProto(y.call(new b));a("./$.tag")(B,v,true);if(!d&&h(w,l))g(B,i,o)}if(!d||t)g(w,i,y);j[c]=y;j[v]=o;if(r){z={keys:s?y:u(m),values:r==n?y:u(n),entries:r!=n?y:u("entries")};if(t)for(A in z){if(!(A in w))f(w,A,z[A])}else e(e.P+e.F*k,c,z)}}},{"./$":41,"./$.def":16,"./$.has":27,"./$.hide":28,"./$.iter-create":36,"./$.iterators":40,"./$.library":43,"./$.redef":53,"./$.tag":67,"./$.wks":76}],38:[function(a,b,c){var d=a("./$.wks")("iterator"),e=false;try{var f=[7][d]();f["return"]=function(){e=true};Array.from(f,function(){throw 2})}catch(g){}b.exports=function(a){if(!e)return false;var b=false;try{var c=[7],f=c[d]();f.next=function(){b=true};c[d]=function(){return f};a(c)}catch(g){}return b}},{"./$.wks":76}],39:[function(a,b,c){b.exports=function(a,b){return{value:b,done:!!a}}},{}],40:[function(a,b,c){b.exports={}},{}],41:[function(a,b,c){var d=Object;b.exports={create:d.create,getProto:d.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:d.getOwnPropertyDescriptor,setDesc:d.defineProperty,setDescs:d.defineProperties,getKeys:d.keys,getNames:d.getOwnPropertyNames,getSymbols:d.getOwnPropertySymbols,each:[].forEach}},{}],42:[function(a,b,c){var d=a("./$"),e=a("./$.to-iobject");b.exports=function(a,b){var c=e(a),f=d.getKeys(c),g=f.length,h=0,i;while(g>h)if(c[i=f[h++]]===b)return i}},{"./$":41,"./$.to-iobject":71}],43:[function(a,b,c){b.exports=false},{}],44:[function(a,b,c){b.exports=Math.log1p||function d(a){return(a=+a)>-1e-8&&a<1e-8?a-a*a/2:Math.log(1+a)}},{}],45:[function(a,b,c){var d=a("./$.global"),e=a("./$.task").set,f=d.MutationObserver||d.WebKitMutationObserver,g=d.process,h=a("./$.cof")(g)=="process",i,j,k;var l=function(){var a,b;if(h&&(a=g.domain)){g.domain=null;a.exit()}while(i){b=i.domain;if(b)b.enter();i.fn.call();if(b)b.exit();i=i.next}j=undefined;if(a)a.enter()};if(h){k=function(){g.nextTick(l)}}else if(f){var m=1,n=document.createTextNode("");new f(l).observe(n,{characterData:true});k=function(){n.data=m=-m}}else{k=function(){e.call(d,l)}}b.exports=function o(a){var b={fn:a,next:undefined,domain:h&&g.domain};if(j)j.next=b;if(!i){i=b;k()}j=b}},{"./$.cof":9,"./$.global":26,"./$.task":68}],46:[function(a,b,c){var d=a("./$.redef");b.exports=function(a,b){for(var c in b)d(a,c,b[c]);return a}},{"./$.redef":53}],47:[function(a,b,c){b.exports=function(b,c){var d=a("./$.def"),e=(a("./$.core").Object||{})[b]||Object[b],f={};f[b]=c(e);d(d.S+d.F*a("./$.fails")(function(){e(1)}),"Object",f)}},{"./$.core":14,"./$.def":16,"./$.fails":21}],48:[function(a,b,c){var d=a("./$"),e=a("./$.to-iobject");b.exports=function(a){return function(b){var c=e(b),f=d.getKeys(c),g=f.length,h=0,i=Array(g),j;if(a)while(g>h)i[h]=[j=f[h++],c[j]];else while(g>h)i[h]=c[f[h++]];return i}}},{"./$":41,"./$.to-iobject":71}],49:[function(a,b,c){var d=a("./$"),e=a("./$.an-object"),f=a("./$.global").Reflect;b.exports=f&&f.ownKeys||function g(a){var b=d.getNames(e(a)),c=d.getSymbols;return c?b.concat(c(a)):b}},{"./$":41,"./$.an-object":4,"./$.global":26}],50:[function(a,b,c){"use strict";var d=a("./$.path"),e=a("./$.invoke"),f=a("./$.a-function");b.exports=function(){var a=f(this),b=arguments.length,c=Array(b),g=0,h=d._,i=false;while(b>g)if((c[g]=arguments[g++])===h)i=true;return function(){var d=this,f=arguments.length,g=0,j=0,k;if(!i&&!f)return e(a,c,d);k=c.slice();if(i)for(;b>g;g++)if(k[g]===h)k[g]=arguments[j++];while(f>j)k.push(arguments[j++]);return e(a,k,d)}}},{"./$.a-function":3,"./$.invoke":30,"./$.path":51}],51:[function(a,b,c){b.exports=a("./$.global")},{"./$.global":26}],52:[function(a,b,c){b.exports=function(a,b){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:b}}},{}],53:[function(a,b,c){var d=a("./$.global"),e=a("./$.hide"),f=a("./$.uid")("src"),g="toString",h=Function[g],i=(""+h).split(g);a("./$.core").inspectSource=function(a){return h.call(a)};(b.exports=function(a,b,c,g){if(typeof c=="function"){e(c,f,a[b]?""+a[b]:i.join(String(b)));if(!("name"in c))c.name=b}if(a===d){a[b]=c}else{if(!g)delete a[b];e(a,b,c)}})(Function.prototype,g,function j(){return typeof this=="function"&&this[f]||h.call(this)})},{"./$.core":14,"./$.global":26,"./$.hide":28,"./$.uid":74}],54:[function(a,b,c){b.exports=function(a,b){var c=b===Object(b)?function(a){return b[a]}:b;return function(b){return String(b).replace(a,c)}}},{}],55:[function(a,b,c){b.exports=Object.is||function d(a,b){return a===b?a!==0||1/a===1/b:a!=a&&b!=b}},{}],56:[function(a,b,c){var d=a("./$").getDesc,e=a("./$.is-object"),f=a("./$.an-object");var g=function(a,b){f(a);if(!e(b)&&b!==null)throw TypeError(b+": can't set as prototype!")};b.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(b,c){try{c=a("./$.ctx")(Function.call,d(Object.prototype,"__proto__").set,2);c({},[])}catch(e){b=true}return function f(a,d){g(a,d);if(b)a.__proto__=d;else c(a,d);return a}}():undefined),check:g}},{"./$":41,"./$.an-object":4,"./$.ctx":15,"./$.is-object":34}],57:[function(a,b,c){var d=a("./$.global"),e="__core-js_shared__",f=d[e]||(d[e]={});b.exports=function(a){return f[a]||(f[a]={})}},{"./$.global":26}],58:[function(a,b,c){b.exports=Math.sign||function d(a){return(a=+a)==0||a!=a?a:a<0?-1:1}},{}],59:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.wks")("species");b.exports=function(b){if(a("./$.support-desc")&&!(e in b))d.setDesc(b,e,{configurable:true,get:function(){return this}})}},{"./$":41,"./$.support-desc":66,"./$.wks":76}],60:[function(a,b,c){b.exports=function(a,b,c){if(!(a instanceof b))throw TypeError(c+": use the 'new' operator!");return a}},{}],61:[function(a,b,c){var d=a("./$.to-integer"),e=a("./$.defined");b.exports=function(a){return function(b,c){var f=String(e(b)),g=d(c),h=f.length,i,j;if(g<0||g>=h)return a?"":undefined;i=f.charCodeAt(g);return i<55296||i>56319||g+1===h||(j=f.charCodeAt(g+1))<56320||j>57343?a?f.charAt(g):i:a?f.slice(g,g+2):(i-55296<<10)+(j-56320)+65536}}},{"./$.defined":17,"./$.to-integer":70}],62:[function(a,b,c){var d=a("./$.defined"),e=a("./$.cof");b.exports=function(a,b,c){if(e(b)=="RegExp")throw TypeError("String#"+c+" doesn't accept regex!");return String(d(a))}},{"./$.cof":9,"./$.defined":17}],63:[function(a,b,c){var d=a("./$.to-length"),e=a("./$.string-repeat"),f=a("./$.defined");b.exports=function(a,b,c,g){var h=String(f(a)),i=h.length,j=c===undefined?" ":String(c),k=d(b);if(k<=i)return h;if(j=="")j=" ";var l=k-i,m=e.call(j,Math.ceil(l/j.length));if(m.length>l)m=g?m.slice(m.length-l):m.slice(0,l);return g?m+h:h+m}},{"./$.defined":17,"./$.string-repeat":64,"./$.to-length":72}],64:[function(a,b,c){"use strict";var d=a("./$.to-integer"),e=a("./$.defined");b.exports=function f(a){var b=String(e(this)),c="",f=d(a);if(f<0||f==Infinity)throw RangeError("Count can't be negative");for(;f>0;(f>>>=1)&&(b+=b))if(f&1)c+=b;return c}},{"./$.defined":17,"./$.to-integer":70}],65:[function(a,b,c){var d=function(a,b){a=String(f(a));if(b&1)a=a.replace(j,"");if(b&2)a=a.replace(k,"");return a};var e=a("./$.def"),f=a("./$.defined"),g="	\n\f\r   ᠎    "+"         　\u2028\u2029\ufeff",h="["+g+"]",i="​",j=RegExp("^"+h+h+"*"),k=RegExp(h+h+"*$");b.exports=function(b,c){var f={};f[b]=c(d);e(e.P+e.F*a("./$.fails")(function(){return!!g[b]()||i[b]()!=i}),"String",f)}},{"./$.def":16,"./$.defined":17,"./$.fails":21}],66:[function(a,b,c){b.exports=!a("./$.fails")(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},{"./$.fails":21}],67:[function(a,b,c){var d=a("./$.has"),e=a("./$.hide"),f=a("./$.wks")("toStringTag");b.exports=function(a,b,c){if(a&&!d(a=c?a:a.prototype,f))e(a,f,b)}},{"./$.has":27,"./$.hide":28,"./$.wks":76}],68:[function(a,b,c){"use strict";var d=a("./$.ctx"),e=a("./$.invoke"),f=a("./$.html"),g=a("./$.dom-create"),h=a("./$.global"),i=h.process,j=h.setImmediate,k=h.clearImmediate,l=h.MessageChannel,m=0,n={},o="onreadystatechange",p,q,r;var s=function(){var a=+this;if(n.hasOwnProperty(a)){var b=n[a];delete n[a];b()}};var t=function(a){s.call(a.data)};if(!j||!k){j=function u(a){var b=[],c=1;while(arguments.length>c)b.push(arguments[c++]);n[++m]=function(){e(typeof a=="function"?a:Function(a),b)};p(m);return m};k=function v(a){delete n[a]};if(a("./$.cof")(i)=="process"){p=function(a){i.nextTick(d(s,a,1))}}else if(l){q=new l;r=q.port2;q.port1.onmessage=t;p=d(r.postMessage,r,1)}else if(h.addEventListener&&typeof postMessage=="function"&&!h.importScript){p=function(a){h.postMessage(a+"","*")};h.addEventListener("message",t,false)}else if(o in g("script")){p=function(a){f.appendChild(g("script"))[o]=function(){f.removeChild(this);s.call(a)}}}else{p=function(a){setTimeout(d(s,a,1),0)}}}b.exports={set:j,clear:k}},{"./$.cof":9,"./$.ctx":15,"./$.dom-create":18,"./$.global":26,"./$.html":29,"./$.invoke":30}],69:[function(a,b,c){var d=a("./$.to-integer"),e=Math.max,f=Math.min;b.exports=function(a,b){a=d(a);return a<0?e(a+b,0):f(a,b)}},{"./$.to-integer":70}],70:[function(a,b,c){var d=Math.ceil,e=Math.floor;b.exports=function(a){return isNaN(a=+a)?0:(a>0?e:d)(a)}},{}],71:[function(a,b,c){var d=a("./$.iobject"),e=a("./$.defined");b.exports=function(a){return d(e(a))}},{"./$.defined":17,"./$.iobject":31}],72:[function(a,b,c){var d=a("./$.to-integer"),e=Math.min;b.exports=function(a){return a>0?e(d(a),9007199254740991):0}},{"./$.to-integer":70}],73:[function(a,b,c){var d=a("./$.defined");b.exports=function(a){return Object(d(a))}},{"./$.defined":17}],74:[function(a,b,c){var d=0,e=Math.random();b.exports=function(a){return"Symbol(".concat(a===undefined?"":a,")_",(++d+e).toString(36))}},{}],75:[function(a,b,c){var d=a("./$.wks")("unscopables");if(!(d in[]))a("./$.hide")(Array.prototype,d,{});b.exports=function(a){[][d][a]=true}},{"./$.hide":28,"./$.wks":76}],76:[function(a,b,c){var d=a("./$.shared")("wks"),e=a("./$.global").Symbol;b.exports=function(b){return d[b]||(d[b]=e&&e[b]||(e||a("./$.uid"))("Symbol."+b))}},{"./$.global":26,"./$.shared":57,"./$.uid":74}],77:[function(a,b,c){var d=a("./$.classof"),e=a("./$.wks")("iterator"),f=a("./$.iterators");b.exports=a("./$.core").getIteratorMethod=function(a){if(a!=undefined)return a[e]||a["@@iterator"]||f[d(a)]}},{"./$.classof":8,"./$.core":14,"./$.iterators":40,"./$.wks":76}],78:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.support-desc"),f=a("./$.property-desc"),g=a("./$.html"),h=a("./$.dom-create"),i=a("./$.has"),j=a("./$.cof"),k=a("./$.def"),l=a("./$.invoke"),m=a("./$.array-methods"),n=a("./$.uid")("__proto__"),o=a("./$.is-object"),p=a("./$.an-object"),q=a("./$.a-function"),r=a("./$.to-object"),s=a("./$.to-iobject"),t=a("./$.to-integer"),u=a("./$.to-index"),v=a("./$.to-length"),w=a("./$.iobject"),x=a("./$.fails"),y=Object.prototype,z=[],A=z.slice,B=z.join,C=d.setDesc,D=d.getDesc,E=d.setDescs,F=a("./$.array-includes")(false),G={},H;if(!e){H=!x(function(){return C(h("div"),"a",{get:function(){return 7}}).a!=7});d.setDesc=function(a,b,c){if(H)try{return C(a,b,c)}catch(d){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");if("value"in c)p(a)[b]=c.value;return a};d.getDesc=function(a,b){if(H)try{return D(a,b)}catch(c){}if(i(a,b))return f(!y.propertyIsEnumerable.call(a,b),a[b])};d.setDescs=E=function(a,b){p(a);var c=d.getKeys(b),e=c.length,f=0,g;while(e>f)d.setDesc(a,g=c[f++],b[g]);return a}}k(k.S+k.F*!e,"Object",{getOwnPropertyDescriptor:d.getDesc,defineProperty:d.setDesc,defineProperties:E});var I=("constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,"+"toLocaleString,toString,valueOf").split(","),J=I.concat("length","prototype"),K=I.length;var L=function(){var a=h("iframe"),b=K,c=">",d;a.style.display="none";g.appendChild(a);a.src="javascript:";d=a.contentWindow.document;d.open();d.write("<script>document.F=Object</script"+c);d.close();L=d.F;while(b--)delete L.prototype[I[b]];return L()};var M=function(a,b){return function(c){var d=s(c),e=0,f=[],g;for(g in d)if(g!=n)i(d,g)&&f.push(g);while(b>e)if(i(d,g=a[e++])){~F(f,g)||f.push(g)}return f}};var N=function(){};k(k.S,"Object",{getPrototypeOf:d.getProto=d.getProto||function(a){a=r(a);if(i(a,n))return a[n];if(typeof a.constructor=="function"&&a instanceof a.constructor){return a.constructor.prototype}return a instanceof Object?y:null},getOwnPropertyNames:d.getNames=d.getNames||M(J,J.length,true),create:d.create=d.create||function(a,b){var c;if(a!==null){N.prototype=p(a);c=new N;N.prototype=null;c[n]=a}else c=L();return b===undefined?c:E(c,b)},keys:d.getKeys=d.getKeys||M(I,K,false)});var O=function(a,b,c){if(!(b in G)){for(var d=[],e=0;e<b;e++)d[e]="a["+e+"]";G[b]=Function("F,a","return new F("+d.join(",")+")")}return G[b](a,c)};k(k.P,"Function",{bind:function V(a){var b=q(this),c=A.call(arguments,1);var d=function(){var e=c.concat(A.call(arguments));return this instanceof d?O(b,e.length,e):l(b,e,a)};if(o(b.prototype))d.prototype=b.prototype;return d}});var P=x(function(){if(g)A.call(g)});k(k.P+k.F*P,"Array",{slice:function(a,b){var c=v(this.length),d=j(this);b=b===undefined?c:b;if(d=="Array")return A.call(this,a,b);var e=u(a,c),f=u(b,c),g=v(f-e),h=Array(g),i=0;for(;i<g;i++)h[i]=d=="String"?this.charAt(e+i):this[e+i];return h}});k(k.P+k.F*(w!=Object),"Array",{join:function(){return B.apply(w(this),arguments)}});k(k.S,"Array",{isArray:function(a){return j(a)=="Array"}});var Q=function(a){return function(b,c){q(b);var d=w(this),e=v(d.length),f=a?e-1:0,g=a?-1:1;if(arguments.length<2)for(;;){if(f in d){c=d[f];f+=g;break}f+=g;if(a?f<0:e<=f){throw TypeError("Reduce of empty array with no initial value")}}for(;a?f>=0:e>f;f+=g)if(f in d){c=b(c,d[f],f,this)}return c}};var R=function(a){return function(b){return a(this,b,arguments[1])}};k(k.P,"Array",{forEach:d.each=d.each||R(m(0)),map:R(m(1)),filter:R(m(2)),some:R(m(3)),every:R(m(4)),reduce:Q(false),reduceRight:Q(true),indexOf:R(F),lastIndexOf:function(a,b){var c=s(this),d=v(c.length),e=d-1;if(arguments.length>1)e=Math.min(e,t(b));if(e<0)e=v(d+e);for(;e>=0;e--)if(e in c)if(c[e]===a)return e;return-1}});k(k.S,"Date",{now:function(){return+new Date}});var S=function(a){return a>9?a:"0"+a};var T=new Date(-5e13-1),U=!(T.toISOString&&T.toISOString()=="0385-07-25T07:06:39.999Z"&&x(function(){new Date(NaN).toISOString()}));k(k.P+k.F*U,"Date",{toISOString:function W(){if(!isFinite(this))throw RangeError("Invalid time value");var a=this,b=a.getUTCFullYear(),c=a.getUTCMilliseconds(),d=b<0?"-":b>9999?"+":"";return d+("00000"+Math.abs(b)).slice(d?-6:-4)+"-"+S(a.getUTCMonth()+1)+"-"+S(a.getUTCDate())+"T"+S(a.getUTCHours())+":"+S(a.getUTCMinutes())+":"+S(a.getUTCSeconds())+"."+(c>99?c:"0"+S(c))+"Z"}})},{"./$":41,"./$.a-function":3,"./$.an-object":4,"./$.array-includes":5,"./$.array-methods":6,"./$.cof":9,"./$.def":16,"./$.dom-create":18,"./$.fails":21,"./$.has":27,"./$.html":29,"./$.invoke":30,"./$.iobject":31,"./$.is-object":34,"./$.property-desc":52,"./$.support-desc":66,"./$.to-index":69,"./$.to-integer":70,"./$.to-iobject":71,"./$.to-length":72,"./$.to-object":73,"./$.uid":74}],79:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.to-object"),f=a("./$.to-index"),g=a("./$.to-length");d(d.P,"Array",{copyWithin:function h(a,b){var c=e(this),d=g(c.length),h=f(a,d),i=f(b,d),j=arguments[2],k=j===undefined?d:f(j,d),l=Math.min(k-i,d-h),m=1;if(i<h&&h<i+l){m=-1;i=i+l-1;h=h+l-1}while(l-->0){if(i in c)c[h]=c[i];else delete c[h];h+=m;i+=m}return c}});a("./$.unscope")("copyWithin")},{"./$.def":16,"./$.to-index":69,"./$.to-length":72,"./$.to-object":73,"./$.unscope":75}],80:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.to-object"),f=a("./$.to-index"),g=a("./$.to-length");d(d.P,"Array",{fill:function h(a){var b=e(this,true),c=g(b.length),d=f(arguments[1],c),h=arguments[2],i=h===undefined?c:f(h,c);while(i>d)b[d++]=a;return b}});a("./$.unscope")("fill")},{"./$.def":16,"./$.to-index":69,"./$.to-length":72,"./$.to-object":73,"./$.unscope":75}],81:[function(a,b,c){"use strict";var d="findIndex",e=a("./$.def"),f=true,g=a("./$.array-methods")(6);if(d in[])Array(1)[d](function(){f=false});e(e.P+e.F*f,"Array",{findIndex:function h(a){return g(this,a,arguments[1])}});a("./$.unscope")(d)},{"./$.array-methods":6,"./$.def":16,"./$.unscope":75}],82:[function(a,b,c){"use strict";var d="find",e=a("./$.def"),f=true,g=a("./$.array-methods")(5);if(d in[])Array(1)[d](function(){f=false});e(e.P+e.F*f,"Array",{find:function h(a){return g(this,a,arguments[1])}});a("./$.unscope")(d)},{"./$.array-methods":6,"./$.def":16,"./$.unscope":75}],83:[function(a,b,c){"use strict";var d=a("./$.ctx"),e=a("./$.def"),f=a("./$.to-object"),g=a("./$.iter-call"),h=a("./$.is-array-iter"),i=a("./$.to-length"),j=a("./core.get-iterator-method");e(e.S+e.F*!a("./$.iter-detect")(function(a){Array.from(a)}),"Array",{from:function k(a){var b=f(a),c=typeof this=="function"?this:Array,e=arguments[1],k=e!==undefined,l=0,m=j(b),n,o,p,q;if(k)e=d(e,arguments[2],2);if(m!=undefined&&!(c==Array&&h(m))){for(q=m.call(b),o=new c;!(p=q.next()).done;l++){o[l]=k?g(q,e,[p.value,l],true):p.value}}else{for(o=new c(n=i(b.length));n>l;l++){o[l]=k?e(b[l],l):b[l]}}o.length=l;return o}})},{"./$.ctx":15,"./$.def":16,"./$.is-array-iter":32,"./$.iter-call":35,"./$.iter-detect":38,"./$.to-length":72,"./$.to-object":73,"./core.get-iterator-method":77}],84:[function(a,b,c){"use strict";var d=a("./$.unscope"),e=a("./$.iter-step"),f=a("./$.iterators"),g=a("./$.to-iobject");a("./$.iter-define")(Array,"Array",function(a,b){this._t=g(a);this._i=0;this._k=b},function(){var a=this._t,b=this._k,c=this._i++;if(!a||c>=a.length){this._t=undefined;return e(1)}if(b=="keys")return e(0,c);if(b=="values")return e(0,a[c]);return e(0,[c,a[c]]);
},"values");f.Arguments=f.Array;d("keys");d("values");d("entries")},{"./$.iter-define":37,"./$.iter-step":39,"./$.iterators":40,"./$.to-iobject":71,"./$.unscope":75}],85:[function(a,b,c){"use strict";var d=a("./$.def");d(d.S+d.F*a("./$.fails")(function(){function a(){}return!(Array.of.call(a)instanceof a)}),"Array",{of:function e(){var a=0,b=arguments.length,c=new(typeof this=="function"?this:Array)(b);while(b>a)c[a]=arguments[a++];c.length=b;return c}})},{"./$.def":16,"./$.fails":21}],86:[function(a,b,c){a("./$.species")(Array)},{"./$.species":59}],87:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.is-object"),f=a("./$.wks")("hasInstance"),g=Function.prototype;if(!(f in g))d.setDesc(g,f,{value:function(a){if(typeof this!="function"||!e(a))return false;if(!e(this.prototype))return a instanceof this;while(a=d.getProto(a))if(this.prototype===a)return true;return false}})},{"./$":41,"./$.is-object":34,"./$.wks":76}],88:[function(a,b,c){var d=a("./$").setDesc,e=a("./$.property-desc"),f=a("./$.has"),g=Function.prototype,h=/^\s*function ([^ (]*)/,i="name";i in g||a("./$.support-desc")&&d(g,i,{configurable:true,get:function(){var a=(""+this).match(h),b=a?a[1]:"";f(this,i)||d(this,i,e(5,b));return b}})},{"./$":41,"./$.has":27,"./$.property-desc":52,"./$.support-desc":66}],89:[function(a,b,c){"use strict";var d=a("./$.collection-strong");a("./$.collection")("Map",function(a){return function b(){return a(this,arguments[0])}},{get:function e(a){var b=d.getEntry(this,a);return b&&b.v},set:function f(a,b){return d.def(this,a===0?0:a,b)}},d,true)},{"./$.collection":13,"./$.collection-strong":10}],90:[function(a,b,c){var d=a("./$.def"),e=a("./$.log1p"),f=Math.sqrt,g=Math.acosh;d(d.S+d.F*!(g&&Math.floor(g(Number.MAX_VALUE))==710),"Math",{acosh:function h(a){return(a=+a)<1?NaN:a>94906265.62425156?Math.log(a)+Math.LN2:e(a-1+f(a-1)*f(a+1))}})},{"./$.def":16,"./$.log1p":44}],91:[function(a,b,c){var d=a("./$.def");function e(a){return!isFinite(a=+a)||a==0?a:a<0?-e(-a):Math.log(a+Math.sqrt(a*a+1))}d(d.S,"Math",{asinh:e})},{"./$.def":16}],92:[function(a,b,c){var d=a("./$.def");d(d.S,"Math",{atanh:function e(a){return(a=+a)==0?a:Math.log((1+a)/(1-a))/2}})},{"./$.def":16}],93:[function(a,b,c){var d=a("./$.def"),e=a("./$.sign");d(d.S,"Math",{cbrt:function f(a){return e(a=+a)*Math.pow(Math.abs(a),1/3)}})},{"./$.def":16,"./$.sign":58}],94:[function(a,b,c){var d=a("./$.def");d(d.S,"Math",{clz32:function e(a){return(a>>>=0)?31-Math.floor(Math.log(a+.5)*Math.LOG2E):32}})},{"./$.def":16}],95:[function(a,b,c){var d=a("./$.def"),e=Math.exp;d(d.S,"Math",{cosh:function f(a){return(e(a=+a)+e(-a))/2}})},{"./$.def":16}],96:[function(a,b,c){var d=a("./$.def");d(d.S,"Math",{expm1:a("./$.expm1")})},{"./$.def":16,"./$.expm1":20}],97:[function(a,b,c){var d=a("./$.def"),e=a("./$.sign"),f=Math.pow,g=f(2,-52),h=f(2,-23),i=f(2,127)*(2-h),j=f(2,-126);var k=function(a){return a+1/g-1/g};d(d.S,"Math",{fround:function l(a){var b=Math.abs(a),c=e(a),d,f;if(b<j)return c*k(b/j/h)*j*h;d=(1+h/g)*b;f=d-(d-b);if(f>i||f!=f)return c*Infinity;return c*f}})},{"./$.def":16,"./$.sign":58}],98:[function(a,b,c){var d=a("./$.def"),e=Math.abs;d(d.S,"Math",{hypot:function f(a,b){var c=0,d=0,f=arguments.length,g=0,h,i;while(d<f){h=e(arguments[d++]);if(g<h){i=g/h;c=c*i*i+1;g=h}else if(h>0){i=h/g;c+=i*i}else c+=h}return g===Infinity?Infinity:g*Math.sqrt(c)}})},{"./$.def":16}],99:[function(a,b,c){var d=a("./$.def");d(d.S+d.F*a("./$.fails")(function(){return Math.imul(4294967295,5)!=-5}),"Math",{imul:function e(a,b){var c=65535,d=+a,e=+b,f=c&d,g=c&e;return 0|f*g+((c&d>>>16)*g+f*(c&e>>>16)<<16>>>0)}})},{"./$.def":16,"./$.fails":21}],100:[function(a,b,c){var d=a("./$.def");d(d.S,"Math",{log10:function e(a){return Math.log(a)/Math.LN10}})},{"./$.def":16}],101:[function(a,b,c){var d=a("./$.def");d(d.S,"Math",{log1p:a("./$.log1p")})},{"./$.def":16,"./$.log1p":44}],102:[function(a,b,c){var d=a("./$.def");d(d.S,"Math",{log2:function e(a){return Math.log(a)/Math.LN2}})},{"./$.def":16}],103:[function(a,b,c){var d=a("./$.def");d(d.S,"Math",{sign:a("./$.sign")})},{"./$.def":16,"./$.sign":58}],104:[function(a,b,c){var d=a("./$.def"),e=a("./$.expm1"),f=Math.exp;d(d.S,"Math",{sinh:function g(a){return Math.abs(a=+a)<1?(e(a)-e(-a))/2:(f(a-1)-f(-a-1))*(Math.E/2)}})},{"./$.def":16,"./$.expm1":20}],105:[function(a,b,c){var d=a("./$.def"),e=a("./$.expm1"),f=Math.exp;d(d.S,"Math",{tanh:function g(a){var b=e(a=+a),c=e(-a);return b==Infinity?1:c==Infinity?-1:(b-c)/(f(a)+f(-a))}})},{"./$.def":16,"./$.expm1":20}],106:[function(a,b,c){var d=a("./$.def");d(d.S,"Math",{trunc:function e(a){return(a>0?Math.floor:Math.ceil)(a)}})},{"./$.def":16}],107:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.global"),f=a("./$.has"),g=a("./$.cof"),h=a("./$.is-object"),i=a("./$.fails"),j="Number",k=e[j],l=k,m=k.prototype,n=g(d.create(m))==j;var o=function(a){var b,c;if(typeof(b=a.valueOf)=="function"&&!h(c=b.call(a)))return c;if(typeof(b=a.toString)=="function"&&!h(c=b.call(a)))return c;throw TypeError("Can't convert object to number")};var p=function(a){if(h(a))a=o(a);if(typeof a=="string"&&a.length>2&&a.charCodeAt(0)==48){var b=false;switch(a.charCodeAt(1)){case 66:case 98:b=true;case 79:case 111:return parseInt(a.slice(2),b?2:8)}}return+a};if(!(k("0o1")&&k("0b1"))){k=function q(a){var b=this;return b instanceof k&&(n?i(function(){m.valueOf.call(b)}):g(b)!=j)?new l(p(a)):p(a)};d.each.call(a("./$.support-desc")?d.getNames(l):("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,"+"EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,"+"MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger").split(","),function(a){if(f(l,a)&&!f(k,a)){d.setDesc(k,a,d.getDesc(l,a))}});k.prototype=m;m.constructor=k;a("./$.redef")(e,j,k)}},{"./$":41,"./$.cof":9,"./$.fails":21,"./$.global":26,"./$.has":27,"./$.is-object":34,"./$.redef":53,"./$.support-desc":66}],108:[function(a,b,c){var d=a("./$.def");d(d.S,"Number",{EPSILON:Math.pow(2,-52)})},{"./$.def":16}],109:[function(a,b,c){var d=a("./$.def"),e=a("./$.global").isFinite;d(d.S,"Number",{isFinite:function f(a){return typeof a=="number"&&e(a)}})},{"./$.def":16,"./$.global":26}],110:[function(a,b,c){var d=a("./$.def");d(d.S,"Number",{isInteger:a("./$.is-integer")})},{"./$.def":16,"./$.is-integer":33}],111:[function(a,b,c){var d=a("./$.def");d(d.S,"Number",{isNaN:function e(a){return a!=a}})},{"./$.def":16}],112:[function(a,b,c){var d=a("./$.def"),e=a("./$.is-integer"),f=Math.abs;d(d.S,"Number",{isSafeInteger:function g(a){return e(a)&&f(a)<=9007199254740991}})},{"./$.def":16,"./$.is-integer":33}],113:[function(a,b,c){var d=a("./$.def");d(d.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{"./$.def":16}],114:[function(a,b,c){var d=a("./$.def");d(d.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{"./$.def":16}],115:[function(a,b,c){var d=a("./$.def");d(d.S,"Number",{parseFloat:parseFloat})},{"./$.def":16}],116:[function(a,b,c){var d=a("./$.def");d(d.S,"Number",{parseInt:parseInt})},{"./$.def":16}],117:[function(a,b,c){var d=a("./$.def");d(d.S+d.F,"Object",{assign:a("./$.assign")})},{"./$.assign":7,"./$.def":16}],118:[function(a,b,c){var d=a("./$.is-object");a("./$.object-sap")("freeze",function(a){return function b(c){return a&&d(c)?a(c):c}})},{"./$.is-object":34,"./$.object-sap":47}],119:[function(a,b,c){var d=a("./$.to-iobject");a("./$.object-sap")("getOwnPropertyDescriptor",function(a){return function b(c,e){return a(d(c),e)}})},{"./$.object-sap":47,"./$.to-iobject":71}],120:[function(a,b,c){a("./$.object-sap")("getOwnPropertyNames",function(){return a("./$.get-names").get})},{"./$.get-names":25,"./$.object-sap":47}],121:[function(a,b,c){var d=a("./$.to-object");a("./$.object-sap")("getPrototypeOf",function(a){return function b(c){return a(d(c))}})},{"./$.object-sap":47,"./$.to-object":73}],122:[function(a,b,c){var d=a("./$.is-object");a("./$.object-sap")("isExtensible",function(a){return function b(c){return d(c)?a?a(c):true:false}})},{"./$.is-object":34,"./$.object-sap":47}],123:[function(a,b,c){var d=a("./$.is-object");a("./$.object-sap")("isFrozen",function(a){return function b(c){return d(c)?a?a(c):false:true}})},{"./$.is-object":34,"./$.object-sap":47}],124:[function(a,b,c){var d=a("./$.is-object");a("./$.object-sap")("isSealed",function(a){return function b(c){return d(c)?a?a(c):false:true}})},{"./$.is-object":34,"./$.object-sap":47}],125:[function(a,b,c){var d=a("./$.def");d(d.S,"Object",{is:a("./$.same")})},{"./$.def":16,"./$.same":55}],126:[function(a,b,c){var d=a("./$.to-object");a("./$.object-sap")("keys",function(a){return function b(c){return a(d(c))}})},{"./$.object-sap":47,"./$.to-object":73}],127:[function(a,b,c){var d=a("./$.is-object");a("./$.object-sap")("preventExtensions",function(a){return function b(c){return a&&d(c)?a(c):c}})},{"./$.is-object":34,"./$.object-sap":47}],128:[function(a,b,c){var d=a("./$.is-object");a("./$.object-sap")("seal",function(a){return function b(c){return a&&d(c)?a(c):c}})},{"./$.is-object":34,"./$.object-sap":47}],129:[function(a,b,c){var d=a("./$.def");d(d.S,"Object",{setPrototypeOf:a("./$.set-proto").set})},{"./$.def":16,"./$.set-proto":56}],130:[function(a,b,c){"use strict";var d=a("./$.classof"),e={};e[a("./$.wks")("toStringTag")]="z";if(e+""!="[object z]"){a("./$.redef")(Object.prototype,"toString",function f(){return"[object "+d(this)+"]"},true)}},{"./$.classof":8,"./$.redef":53,"./$.wks":76}],131:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.library"),f=a("./$.global"),g=a("./$.ctx"),h=a("./$.classof"),i=a("./$.def"),j=a("./$.is-object"),k=a("./$.an-object"),l=a("./$.a-function"),m=a("./$.strict-new"),n=a("./$.for-of"),o=a("./$.set-proto").set,p=a("./$.same"),q=a("./$.species"),r=a("./$.wks")("species"),s=a("./$.uid")("record"),t=a("./$.microtask"),u="Promise",v=f.process,w=h(v)=="process",x=f[u],y;var z=function(a){var b=new x(function(){});if(a)b.constructor=Object;return x.resolve(b)===b};var A=function(){var b=false;function c(a){var b=new x(a);o(b,c.prototype);return b}try{b=x&&x.resolve&&z();o(c,x);c.prototype=d.create(x.prototype,{constructor:{value:c}});if(!(c.resolve(5).then(function(){})instanceof c)){b=false}if(b&&a("./$.support-desc")){var e=false;x.resolve(d.setDesc({},"then",{get:function(){e=true}}));b=e}}catch(f){b=false}return b}();var B=function(a){return j(a)&&(A?h(a)=="Promise":s in a)};var C=function(a,b){if(e&&a===x&&b===y)return true;return p(a,b)};var D=function(a){var b=k(a)[r];return b!=undefined?b:a};var E=function(a){var b;return j(a)&&typeof(b=a.then)=="function"?b:false};var F=function(a,b){if(a.n)return;a.n=true;var c=a.c;t(function(){var d=a.v,e=a.s==1,g=0;var h=function(b){var c=e?b.ok:b.fail,f,g;try{if(c){if(!e)a.h=true;f=c===true?d:c(d);if(f===b.P){b.rej(TypeError("Promise-chain cycle"))}else if(g=E(f)){g.call(f,b.res,b.rej)}else b.res(f)}else b.rej(d)}catch(h){b.rej(h)}};while(c.length>g)h(c[g++]);c.length=0;a.n=false;if(b)setTimeout(function(){if(G(a.p)){if(w){v.emit("unhandledRejection",d,a.p)}else if(f.console&&console.error){console.error("Unhandled promise rejection",d)}}a.a=undefined},1)})};var G=function(a){var b=a[s],c=b.a||b.c,d=0,e;if(b.h)return false;while(c.length>d){e=c[d++];if(e.fail||!G(e.P))return false}return true};var H=function(a){var b=this;if(b.d)return;b.d=true;b=b.r||b;b.v=a;b.s=2;b.a=b.c.slice();F(b,true)};var I=function(a){var b=this,c;if(b.d)return;b.d=true;b=b.r||b;try{if(c=E(a)){t(function(){var d={r:b,d:false};try{c.call(a,g(I,d,1),g(H,d,1))}catch(e){H.call(d,e)}})}else{b.v=a;b.s=1;F(b,false)}}catch(d){H.call({r:b,d:false},d)}};if(!A){x=function J(a){l(a);var b={p:m(this,x,u),c:[],a:undefined,s:0,d:false,v:undefined,h:false,n:false};this[s]=b;try{a(g(I,b,1),g(H,b,1))}catch(c){H.call(b,c)}};a("./$.mix")(x.prototype,{then:function K(a,b){var c=k(k(this).constructor)[r];var d={ok:typeof a=="function"?a:true,fail:typeof b=="function"?b:false};var e=d.P=new(c!=undefined?c:x)(function(a,b){d.res=l(a);d.rej=l(b)});var f=this[s];f.c.push(d);if(f.a)f.a.push(d);if(f.s)F(f,false);return e},"catch":function(a){return this.then(undefined,a)}})}i(i.G+i.W+i.F*!A,{Promise:x});a("./$.tag")(x,u);q(x);q(y=a("./$.core")[u]);i(i.S+i.F*!A,u,{reject:function L(a){return new this(function(b,c){c(a)})}});i(i.S+i.F*(!A||z(true)),u,{resolve:function M(a){return B(a)&&C(a.constructor,this)?a:new this(function(b){b(a)})}});i(i.S+i.F*!(A&&a("./$.iter-detect")(function(a){x.all(a)["catch"](function(){})})),u,{all:function N(a){var b=D(this),c=[];return new b(function(e,f){n(a,false,c.push,c);var g=c.length,h=Array(g);if(g)d.each.call(c,function(a,c){b.resolve(a).then(function(a){h[c]=a;--g||e(h)},f)});else e(h)})},race:function O(a){var b=D(this);return new b(function(c,d){n(a,false,function(a){b.resolve(a).then(c,d)})})}})},{"./$":41,"./$.a-function":3,"./$.an-object":4,"./$.classof":8,"./$.core":14,"./$.ctx":15,"./$.def":16,"./$.for-of":24,"./$.global":26,"./$.is-object":34,"./$.iter-detect":38,"./$.library":43,"./$.microtask":45,"./$.mix":46,"./$.same":55,"./$.set-proto":56,"./$.species":59,"./$.strict-new":60,"./$.support-desc":66,"./$.tag":67,"./$.uid":74,"./$.wks":76}],132:[function(a,b,c){var d=a("./$.def"),e=Function.apply;d(d.S,"Reflect",{apply:function f(a,b,c){return e.call(a,b,c)}})},{"./$.def":16}],133:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=a("./$.a-function"),g=a("./$.an-object"),h=a("./$.is-object"),i=Function.bind||a("./$.core").Function.prototype.bind;e(e.S+e.F*a("./$.fails")(function(){function a(){}return!(Reflect.construct(function(){},[],a)instanceof a)}),"Reflect",{construct:function j(a,b){f(a);var c=arguments.length<3?a:f(arguments[2]);if(a==c){if(b!=undefined)switch(g(b).length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3])}var e=[null];e.push.apply(e,b);return new(i.apply(a,e))}var j=c.prototype,k=d.create(h(j)?j:Object.prototype),l=Function.apply.call(a,k,b);return h(l)?l:k}})},{"./$":41,"./$.a-function":3,"./$.an-object":4,"./$.core":14,"./$.def":16,"./$.fails":21,"./$.is-object":34}],134:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=a("./$.an-object");e(e.S+e.F*a("./$.fails")(function(){Reflect.defineProperty(d.setDesc({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function g(a,b,c){f(a);try{d.setDesc(a,b,c);return true}catch(e){return false}}})},{"./$":41,"./$.an-object":4,"./$.def":16,"./$.fails":21}],135:[function(a,b,c){var d=a("./$.def"),e=a("./$").getDesc,f=a("./$.an-object");d(d.S,"Reflect",{deleteProperty:function g(a,b){var c=e(f(a),b);return c&&!c.configurable?false:delete a[b]}})},{"./$":41,"./$.an-object":4,"./$.def":16}],136:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.an-object");var f=function(a){this._t=e(a);this._i=0;var b=this._k=[],c;for(c in a)b.push(c)};a("./$.iter-create")(f,"Object",function(){var a=this,b=a._k,c;do{if(a._i>=b.length)return{value:undefined,done:true}}while(!((c=b[a._i++])in a._t));return{value:c,done:false}});d(d.S,"Reflect",{enumerate:function g(a){return new f(a)}})},{"./$.an-object":4,"./$.def":16,"./$.iter-create":36}],137:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=a("./$.an-object");e(e.S,"Reflect",{getOwnPropertyDescriptor:function g(a,b){return d.getDesc(f(a),b)}})},{"./$":41,"./$.an-object":4,"./$.def":16}],138:[function(a,b,c){var d=a("./$.def"),e=a("./$").getProto,f=a("./$.an-object");d(d.S,"Reflect",{getPrototypeOf:function g(a){return e(f(a))}})},{"./$":41,"./$.an-object":4,"./$.def":16}],139:[function(a,b,c){var d=a("./$"),e=a("./$.has"),f=a("./$.def"),g=a("./$.is-object"),h=a("./$.an-object");function i(a,b){var c=arguments.length<3?a:arguments[2],f,j;if(h(a)===c)return a[b];if(f=d.getDesc(a,b))return e(f,"value")?f.value:f.get!==undefined?f.get.call(c):undefined;if(g(j=d.getProto(a)))return i(j,b,c)}f(f.S,"Reflect",{get:i})},{"./$":41,"./$.an-object":4,"./$.def":16,"./$.has":27,"./$.is-object":34}],140:[function(a,b,c){var d=a("./$.def");d(d.S,"Reflect",{has:function e(a,b){return b in a}})},{"./$.def":16}],141:[function(a,b,c){var d=a("./$.def"),e=a("./$.an-object"),f=Object.isExtensible;d(d.S,"Reflect",{isExtensible:function g(a){e(a);return f?f(a):true}})},{"./$.an-object":4,"./$.def":16}],142:[function(a,b,c){var d=a("./$.def");d(d.S,"Reflect",{ownKeys:a("./$.own-keys")})},{"./$.def":16,"./$.own-keys":49}],143:[function(a,b,c){var d=a("./$.def"),e=a("./$.an-object"),f=Object.preventExtensions;d(d.S,"Reflect",{preventExtensions:function g(a){e(a);try{if(f)f(a);return true}catch(b){return false}}})},{"./$.an-object":4,"./$.def":16}],144:[function(a,b,c){var d=a("./$.def"),e=a("./$.set-proto");if(e)d(d.S,"Reflect",{setPrototypeOf:function f(a,b){e.check(a,b);try{e.set(a,b);return true}catch(c){return false}}})},{"./$.def":16,"./$.set-proto":56}],145:[function(a,b,c){var d=a("./$"),e=a("./$.has"),f=a("./$.def"),g=a("./$.property-desc"),h=a("./$.an-object"),i=a("./$.is-object");function j(a,b,c){var f=arguments.length<4?a:arguments[3],k=d.getDesc(h(a),b),l,m;if(!k){if(i(m=d.getProto(a))){return j(m,b,c,f)}k=g(0)}if(e(k,"value")){if(k.writable===false||!i(f))return false;l=d.getDesc(f,b)||g(0);l.value=c;d.setDesc(f,b,l);return true}return k.set===undefined?false:(k.set.call(f,c),true)}f(f.S,"Reflect",{set:j})},{"./$":41,"./$.an-object":4,"./$.def":16,"./$.has":27,"./$.is-object":34,"./$.property-desc":52}],146:[function(a,b,c){var d=a("./$"),e=a("./$.global"),f=a("./$.cof"),g=a("./$.flags"),h=e.RegExp,i=h,j=h.prototype,k=/a/g,l=new h(k)!==k,m=function(){try{return h(k,"i")=="/a/i"}catch(a){}}();if(a("./$.support-desc")){if(!l||!m){h=function n(a,b){var c=f(a)=="RegExp",d=b===undefined;if(!(this instanceof h)&&c&&d)return a;return l?new i(c&&!d?a.source:a,b):new i(c?a.source:a,c&&d?g.call(a):b)};d.each.call(d.getNames(i),function(a){a in h||d.setDesc(h,a,{configurable:true,get:function(){return i[a]},set:function(b){i[a]=b}})});j.constructor=h;h.prototype=j;a("./$.redef")(e,"RegExp",h)}}a("./$.species")(h)},{"./$":41,"./$.cof":9,"./$.flags":23,"./$.global":26,"./$.redef":53,"./$.species":59,"./$.support-desc":66}],147:[function(a,b,c){var d=a("./$");if(a("./$.support-desc")&&/./g.flags!="g")d.setDesc(RegExp.prototype,"flags",{configurable:true,get:a("./$.flags")})},{"./$":41,"./$.flags":23,"./$.support-desc":66}],148:[function(a,b,c){a("./$.fix-re-wks")("match",1,function(a,b){return function c(d){"use strict";var e=a(this),f=d==undefined?undefined:d[b];return f!==undefined?f.call(d,e):new RegExp(d)[b](String(e))}})},{"./$.fix-re-wks":22}],149:[function(a,b,c){a("./$.fix-re-wks")("replace",2,function(a,b,c){return function d(e,f){"use strict";var g=a(this),h=e==undefined?undefined:e[b];return h!==undefined?h.call(e,g,f):c.call(String(g),e,f)}})},{"./$.fix-re-wks":22}],150:[function(a,b,c){a("./$.fix-re-wks")("search",1,function(a,b){return function c(d){"use strict";var e=a(this),f=d==undefined?undefined:d[b];return f!==undefined?f.call(d,e):new RegExp(d)[b](String(e))}})},{"./$.fix-re-wks":22}],151:[function(a,b,c){a("./$.fix-re-wks")("split",2,function(a,b,c){return function d(e,f){"use strict";var g=a(this),h=e==undefined?undefined:e[b];return h!==undefined?h.call(e,g,f):c.call(String(g),e,f)}})},{"./$.fix-re-wks":22}],152:[function(a,b,c){"use strict";var d=a("./$.collection-strong");a("./$.collection")("Set",function(a){return function b(){return a(this,arguments[0])}},{add:function e(a){return d.def(this,a=a===0?0:a,a)}},d)},{"./$.collection":13,"./$.collection-strong":10}],153:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.string-at")(false);d(d.P,"String",{codePointAt:function f(a){return e(this,a)}})},{"./$.def":16,"./$.string-at":61}],154:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.to-length"),f=a("./$.string-context");d(d.P+d.F*!a("./$.fails")(function(){"q".endsWith(/./)}),"String",{endsWith:function g(a){var b=f(this,a,"endsWith"),c=arguments[1],d=e(b.length),g=c===undefined?d:Math.min(e(c),d),h=String(a);return b.slice(g-h.length,g)===h}})},{"./$.def":16,"./$.fails":21,"./$.string-context":62,"./$.to-length":72}],155:[function(a,b,c){var d=a("./$.def"),e=a("./$.to-index"),f=String.fromCharCode,g=String.fromCodePoint;d(d.S+d.F*(!!g&&g.length!=1),"String",{fromCodePoint:function h(a){var b=[],c=arguments.length,d=0,g;while(c>d){g=+arguments[d++];if(e(g,1114111)!==g)throw RangeError(g+" is not a valid code point");b.push(g<65536?f(g):f(((g-=65536)>>10)+55296,g%1024+56320))}return b.join("")}})},{"./$.def":16,"./$.to-index":69}],156:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.string-context");d(d.P,"String",{includes:function f(a){return!!~e(this,a,"includes").indexOf(a,arguments[1])}})},{"./$.def":16,"./$.string-context":62}],157:[function(a,b,c){"use strict";var d=a("./$.string-at")(true);a("./$.iter-define")(String,"String",function(a){this._t=String(a);this._i=0},function(){var a=this._t,b=this._i,c;if(b>=a.length)return{value:undefined,done:true};c=d(a,b);this._i+=c.length;return{value:c,done:false}})},{"./$.iter-define":37,"./$.string-at":61}],158:[function(a,b,c){var d=a("./$.def"),e=a("./$.to-iobject"),f=a("./$.to-length");d(d.S,"String",{raw:function g(a){var b=e(a.raw),c=f(b.length),d=arguments.length,g=[],h=0;while(c>h){g.push(String(b[h++]));if(h<d)g.push(String(arguments[h]))}return g.join("")}})},{"./$.def":16,"./$.to-iobject":71,"./$.to-length":72}],159:[function(a,b,c){var d=a("./$.def");d(d.P,"String",{repeat:a("./$.string-repeat")})},{"./$.def":16,"./$.string-repeat":64}],160:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.to-length"),f=a("./$.string-context");d(d.P+d.F*!a("./$.fails")(function(){"q".startsWith(/./)}),"String",{startsWith:function g(a){var b=f(this,a,"startsWith"),c=e(Math.min(arguments[1],b.length)),d=String(a);return b.slice(c,c+d.length)===d}})},{"./$.def":16,"./$.fails":21,"./$.string-context":62,"./$.to-length":72}],161:[function(a,b,c){"use strict";a("./$.string-trim")("trim",function(a){return function b(){return a(this,3)}})},{"./$.string-trim":65}],162:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.global"),f=a("./$.has"),g=a("./$.support-desc"),h=a("./$.def"),i=a("./$.redef"),j=a("./$.shared"),k=a("./$.tag"),l=a("./$.uid"),m=a("./$.wks"),n=a("./$.keyof"),o=a("./$.get-names"),p=a("./$.enum-keys"),q=a("./$.is-object"),r=a("./$.an-object"),s=a("./$.to-iobject"),t=a("./$.property-desc"),u=d.getDesc,v=d.setDesc,w=d.create,x=o.get,y=e.Symbol,z=false,A=m("_hidden"),B=d.isEnum,C=j("symbol-registry"),D=j("symbols"),E=typeof y=="function",F=Object.prototype;var G=g?function(){try{return w(v({},A,{get:function(){return v(this,A,{value:false})[A]}}))[A]||v}catch(a){return function(a,b,c){var d=u(F,b);if(d)delete F[b];v(a,b,c);if(d&&a!==F)v(F,b,d)}}}():v;var H=function(a){var b=D[a]=w(y.prototype);b._k=a;g&&z&&G(F,a,{configurable:true,set:function(b){if(f(this,A)&&f(this[A],a))this[A][a]=false;G(this,a,t(1,b))}});return b};var I=function Q(a,b,c){if(c&&f(D,b)){if(!c.enumerable){if(!f(a,A))v(a,A,t(1,{}));a[A][b]=true}else{if(f(a,A)&&a[A][b])a[A][b]=false;c=w(c,{enumerable:t(0,false)})}return G(a,b,c)}return v(a,b,c)};var J=function R(a,b){r(a);var c=p(b=s(b)),d=0,e=c.length,f;while(e>d)I(a,f=c[d++],b[f]);return a};var K=function S(a,b){return b===undefined?w(a):J(w(a),b)};var L=function T(a){var b=B.call(this,a);return b||!f(this,a)||!f(D,a)||f(this,A)&&this[A][a]?b:true};var M=function U(a,b){var c=u(a=s(a),b);if(c&&f(D,b)&&!(f(a,A)&&a[A][b]))c.enumerable=true;return c};var N=function V(a){var b=x(s(a)),c=[],d=0,e;while(b.length>d)if(!f(D,e=b[d++])&&e!=A)c.push(e);return c};var O=function W(a){var b=x(s(a)),c=[],d=0,e;while(b.length>d)if(f(D,e=b[d++]))c.push(D[e]);return c};if(!E){y=function X(){if(this instanceof y)throw TypeError("Symbol is not a constructor");return H(l(arguments[0]))};i(y.prototype,"toString",function Y(){return this._k});d.create=K;d.isEnum=L;d.getDesc=M;d.setDesc=I;d.setDescs=J;d.getNames=o.get=N;d.getSymbols=O;if(g&&!a("./$.library")){i(F,"propertyIsEnumerable",L,true)}}if(!E||a("./$.fails")(function(){return JSON.stringify([{a:y()},[y()]])!="[{},[null]]"}))i(y.prototype,"toJSON",function Z(){if(E&&q(this))return this});var P={"for":function(a){return f(C,a+="")?C[a]:C[a]=y(a)},keyFor:function $(a){return n(C,a)},useSetter:function(){z=true},useSimple:function(){z=false}};d.each.call(("hasInstance,isConcatSpreadable,iterator,match,replace,search,"+"species,split,toPrimitive,toStringTag,unscopables").split(","),function(a){var b=m(a);P[a]=E?b:H(b)});z=true;h(h.G+h.W,{Symbol:y});h(h.S,"Symbol",P);h(h.S+h.F*!E,"Object",{create:K,defineProperty:I,defineProperties:J,getOwnPropertyDescriptor:M,getOwnPropertyNames:N,getOwnPropertySymbols:O});k(y,"Symbol");k(Math,"Math",true);k(e.JSON,"JSON",true)},{"./$":41,"./$.an-object":4,"./$.def":16,"./$.enum-keys":19,"./$.fails":21,"./$.get-names":25,"./$.global":26,"./$.has":27,"./$.is-object":34,"./$.keyof":42,"./$.library":43,"./$.property-desc":52,"./$.redef":53,"./$.shared":57,"./$.support-desc":66,"./$.tag":67,"./$.to-iobject":71,"./$.uid":74,"./$.wks":76}],163:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.collection-weak"),f=a("./$.is-object"),g=a("./$.has"),h=e.frozenStore,i=e.WEAK,j=Object.isExtensible||f,k={};var l=a("./$.collection")("WeakMap",function(a){return function b(){return a(this,arguments[0])}},{get:function m(a){if(f(a)){if(!j(a))return h(this).get(a);if(g(a,i))return a[i][this._i]}},set:function n(a,b){return e.def(this,a,b)}},e,true,true);if((new l).set((Object.freeze||Object)(k),7).get(k)!=7){d.each.call(["delete","has","get","set"],function(b){var c=l.prototype,d=c[b];a("./$.redef")(c,b,function(a,c){if(f(a)&&!j(a)){var e=h(this)[b](a,c);return b=="set"?this:e}return d.call(this,a,c)})})}},{"./$":41,"./$.collection":13,"./$.collection-weak":12,"./$.has":27,"./$.is-object":34,"./$.redef":53}],164:[function(a,b,c){"use strict";var d=a("./$.collection-weak");a("./$.collection")("WeakSet",function(a){return function b(){return a(this,arguments[0])}},{add:function e(a){return d.def(this,a,true)}},d,false,true)},{"./$.collection":13,"./$.collection-weak":12}],165:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.array-includes")(true);d(d.P,"Array",{includes:function f(a){return e(this,a,arguments[1])}});a("./$.unscope")("includes")},{"./$.array-includes":5,"./$.def":16,"./$.unscope":75}],166:[function(a,b,c){var d=a("./$.def");d(d.P,"Map",{toJSON:a("./$.collection-to-json")("Map")})},{"./$.collection-to-json":11,"./$.def":16}],167:[function(a,b,c){var d=a("./$.def"),e=a("./$.object-to-array")(true);d(d.S,"Object",{entries:function f(a){return e(a)}})},{"./$.def":16,"./$.object-to-array":48}],168:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=a("./$.own-keys"),g=a("./$.to-iobject"),h=a("./$.property-desc");e(e.S,"Object",{getOwnPropertyDescriptors:function i(a){var b=g(a),c=d.setDesc,e=d.getDesc,i=f(b),j={},k=0,l,m;while(i.length>k){m=e(b,l=i[k++]);if(l in j)c(j,l,h(0,m));else j[l]=m}return j}})},{"./$":41,"./$.def":16,"./$.own-keys":49,"./$.property-desc":52,"./$.to-iobject":71}],169:[function(a,b,c){var d=a("./$.def"),e=a("./$.object-to-array")(false);d(d.S,"Object",{values:function f(a){return e(a)}})},{"./$.def":16,"./$.object-to-array":48}],170:[function(a,b,c){var d=a("./$.def"),e=a("./$.replacer")(/[\\^$*+?.()|[\]{}]/g,"\\$&");d(d.S,"RegExp",{escape:function f(a){return e(a)}})},{"./$.def":16,"./$.replacer":54}],171:[function(a,b,c){var d=a("./$.def");d(d.P,"Set",{toJSON:a("./$.collection-to-json")("Set")})},{"./$.collection-to-json":11,"./$.def":16}],172:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.string-at")(true);d(d.P,"String",{at:function f(a){return e(this,a)}})},{"./$.def":16,"./$.string-at":61}],173:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.string-pad");d(d.P,"String",{padLeft:function f(a){return e(this,a,arguments[1],true)}})},{"./$.def":16,"./$.string-pad":63}],174:[function(a,b,c){"use strict";var d=a("./$.def"),e=a("./$.string-pad");d(d.P,"String",{padRight:function f(a){return e(this,a,arguments[1],false)}})},{"./$.def":16,"./$.string-pad":63}],175:[function(a,b,c){"use strict";a("./$.string-trim")("trimLeft",function(a){return function b(){return a(this,1)}})},{"./$.string-trim":65}],176:[function(a,b,c){"use strict";a("./$.string-trim")("trimRight",function(a){return function b(){return a(this,2)}})},{"./$.string-trim":65}],177:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=a("./$.core").Array||Array,g={};var h=function(b,c){d.each.call(b.split(","),function(b){if(c==undefined&&b in f)g[b]=f[b];else if(b in[])g[b]=a("./$.ctx")(Function.call,[][b],c)})};h("pop,reverse,shift,keys,values,entries",1);h("indexOf,every,some,forEach,map,filter,find,findIndex,includes",3);h("join,slice,concat,push,splice,unshift,sort,lastIndexOf,"+"reduce,reduceRight,copyWithin,fill");e(e.S,"Array",g)},{"./$":41,"./$.core":14,"./$.ctx":15,"./$.def":16}],178:[function(a,b,c){a("./es6.array.iterator");var d=a("./$.global"),e=a("./$.hide"),f=a("./$.iterators"),g=a("./$.wks")("iterator"),h=d.NodeList,i=d.HTMLCollection,j=h&&h.prototype,k=i&&i.prototype,l=f.NodeList=f.HTMLCollection=f.Array;if(h&&!(g in j))e(j,g,l);if(i&&!(g in k))e(k,g,l)},{"./$.global":26,"./$.hide":28,"./$.iterators":40,"./$.wks":76,"./es6.array.iterator":84}],179:[function(a,b,c){var d=a("./$.def"),e=a("./$.task");d(d.G+d.B,{setImmediate:e.set,clearImmediate:e.clear})},{"./$.def":16,"./$.task":68}],180:[function(a,b,c){var d=a("./$.global"),e=a("./$.def"),f=a("./$.invoke"),g=a("./$.partial"),h=d.navigator,i=!!h&&/MSIE .\./.test(h.userAgent);var j=function(a){return i?function(b,c){return a(f(g,[].slice.call(arguments,2),typeof b=="function"?b:Function(b)),c)}:a};e(e.G+e.B+e.F*i,{setTimeout:j(d.setTimeout),setInterval:j(d.setInterval)})},{"./$.def":16,"./$.global":26,"./$.invoke":30,"./$.partial":50}],181:[function(a,b,c){a("./modules/es5");a("./modules/es6.symbol");a("./modules/es6.object.assign");a("./modules/es6.object.is");a("./modules/es6.object.set-prototype-of");a("./modules/es6.object.to-string");a("./modules/es6.object.freeze");a("./modules/es6.object.seal");a("./modules/es6.object.prevent-extensions");a("./modules/es6.object.is-frozen");a("./modules/es6.object.is-sealed");a("./modules/es6.object.is-extensible");a("./modules/es6.object.get-own-property-descriptor");a("./modules/es6.object.get-prototype-of");a("./modules/es6.object.keys");a("./modules/es6.object.get-own-property-names");a("./modules/es6.function.name");a("./modules/es6.function.has-instance");a("./modules/es6.number.constructor");a("./modules/es6.number.epsilon");a("./modules/es6.number.is-finite");a("./modules/es6.number.is-integer");a("./modules/es6.number.is-nan");a("./modules/es6.number.is-safe-integer");a("./modules/es6.number.max-safe-integer");a("./modules/es6.number.min-safe-integer");a("./modules/es6.number.parse-float");a("./modules/es6.number.parse-int");a("./modules/es6.math.acosh");a("./modules/es6.math.asinh");a("./modules/es6.math.atanh");a("./modules/es6.math.cbrt");a("./modules/es6.math.clz32");a("./modules/es6.math.cosh");a("./modules/es6.math.expm1");a("./modules/es6.math.fround");a("./modules/es6.math.hypot");a("./modules/es6.math.imul");a("./modules/es6.math.log10");a("./modules/es6.math.log1p");a("./modules/es6.math.log2");a("./modules/es6.math.sign");a("./modules/es6.math.sinh");a("./modules/es6.math.tanh");a("./modules/es6.math.trunc");a("./modules/es6.string.from-code-point");a("./modules/es6.string.raw");a("./modules/es6.string.trim");a("./modules/es6.string.iterator");a("./modules/es6.string.code-point-at");a("./modules/es6.string.ends-with");a("./modules/es6.string.includes");a("./modules/es6.string.repeat");a("./modules/es6.string.starts-with");a("./modules/es6.array.from");a("./modules/es6.array.of");a("./modules/es6.array.iterator");a("./modules/es6.array.species");a("./modules/es6.array.copy-within");a("./modules/es6.array.fill");a("./modules/es6.array.find");a("./modules/es6.array.find-index");a("./modules/es6.regexp.constructor");a("./modules/es6.regexp.flags");a("./modules/es6.regexp.match");a("./modules/es6.regexp.replace");
a("./modules/es6.regexp.search");a("./modules/es6.regexp.split");a("./modules/es6.promise");a("./modules/es6.map");a("./modules/es6.set");a("./modules/es6.weak-map");a("./modules/es6.weak-set");a("./modules/es6.reflect.apply");a("./modules/es6.reflect.construct");a("./modules/es6.reflect.define-property");a("./modules/es6.reflect.delete-property");a("./modules/es6.reflect.enumerate");a("./modules/es6.reflect.get");a("./modules/es6.reflect.get-own-property-descriptor");a("./modules/es6.reflect.get-prototype-of");a("./modules/es6.reflect.has");a("./modules/es6.reflect.is-extensible");a("./modules/es6.reflect.own-keys");a("./modules/es6.reflect.prevent-extensions");a("./modules/es6.reflect.set");a("./modules/es6.reflect.set-prototype-of");a("./modules/es7.array.includes");a("./modules/es7.string.at");a("./modules/es7.string.pad-left");a("./modules/es7.string.pad-right");a("./modules/es7.string.trim-left");a("./modules/es7.string.trim-right");a("./modules/es7.regexp.escape");a("./modules/es7.object.get-own-property-descriptors");a("./modules/es7.object.values");a("./modules/es7.object.entries");a("./modules/es7.map.to-json");a("./modules/es7.set.to-json");a("./modules/js.array.statics");a("./modules/web.timers");a("./modules/web.immediate");a("./modules/web.dom.iterable");b.exports=a("./modules/$.core")},{"./modules/$.core":14,"./modules/es5":78,"./modules/es6.array.copy-within":79,"./modules/es6.array.fill":80,"./modules/es6.array.find":82,"./modules/es6.array.find-index":81,"./modules/es6.array.from":83,"./modules/es6.array.iterator":84,"./modules/es6.array.of":85,"./modules/es6.array.species":86,"./modules/es6.function.has-instance":87,"./modules/es6.function.name":88,"./modules/es6.map":89,"./modules/es6.math.acosh":90,"./modules/es6.math.asinh":91,"./modules/es6.math.atanh":92,"./modules/es6.math.cbrt":93,"./modules/es6.math.clz32":94,"./modules/es6.math.cosh":95,"./modules/es6.math.expm1":96,"./modules/es6.math.fround":97,"./modules/es6.math.hypot":98,"./modules/es6.math.imul":99,"./modules/es6.math.log10":100,"./modules/es6.math.log1p":101,"./modules/es6.math.log2":102,"./modules/es6.math.sign":103,"./modules/es6.math.sinh":104,"./modules/es6.math.tanh":105,"./modules/es6.math.trunc":106,"./modules/es6.number.constructor":107,"./modules/es6.number.epsilon":108,"./modules/es6.number.is-finite":109,"./modules/es6.number.is-integer":110,"./modules/es6.number.is-nan":111,"./modules/es6.number.is-safe-integer":112,"./modules/es6.number.max-safe-integer":113,"./modules/es6.number.min-safe-integer":114,"./modules/es6.number.parse-float":115,"./modules/es6.number.parse-int":116,"./modules/es6.object.assign":117,"./modules/es6.object.freeze":118,"./modules/es6.object.get-own-property-descriptor":119,"./modules/es6.object.get-own-property-names":120,"./modules/es6.object.get-prototype-of":121,"./modules/es6.object.is":125,"./modules/es6.object.is-extensible":122,"./modules/es6.object.is-frozen":123,"./modules/es6.object.is-sealed":124,"./modules/es6.object.keys":126,"./modules/es6.object.prevent-extensions":127,"./modules/es6.object.seal":128,"./modules/es6.object.set-prototype-of":129,"./modules/es6.object.to-string":130,"./modules/es6.promise":131,"./modules/es6.reflect.apply":132,"./modules/es6.reflect.construct":133,"./modules/es6.reflect.define-property":134,"./modules/es6.reflect.delete-property":135,"./modules/es6.reflect.enumerate":136,"./modules/es6.reflect.get":139,"./modules/es6.reflect.get-own-property-descriptor":137,"./modules/es6.reflect.get-prototype-of":138,"./modules/es6.reflect.has":140,"./modules/es6.reflect.is-extensible":141,"./modules/es6.reflect.own-keys":142,"./modules/es6.reflect.prevent-extensions":143,"./modules/es6.reflect.set":145,"./modules/es6.reflect.set-prototype-of":144,"./modules/es6.regexp.constructor":146,"./modules/es6.regexp.flags":147,"./modules/es6.regexp.match":148,"./modules/es6.regexp.replace":149,"./modules/es6.regexp.search":150,"./modules/es6.regexp.split":151,"./modules/es6.set":152,"./modules/es6.string.code-point-at":153,"./modules/es6.string.ends-with":154,"./modules/es6.string.from-code-point":155,"./modules/es6.string.includes":156,"./modules/es6.string.iterator":157,"./modules/es6.string.raw":158,"./modules/es6.string.repeat":159,"./modules/es6.string.starts-with":160,"./modules/es6.string.trim":161,"./modules/es6.symbol":162,"./modules/es6.weak-map":163,"./modules/es6.weak-set":164,"./modules/es7.array.includes":165,"./modules/es7.map.to-json":166,"./modules/es7.object.entries":167,"./modules/es7.object.get-own-property-descriptors":168,"./modules/es7.object.values":169,"./modules/es7.regexp.escape":170,"./modules/es7.set.to-json":171,"./modules/es7.string.at":172,"./modules/es7.string.pad-left":173,"./modules/es7.string.pad-right":174,"./modules/es7.string.trim-left":175,"./modules/es7.string.trim-right":176,"./modules/js.array.statics":177,"./modules/web.dom.iterable":178,"./modules/web.immediate":179,"./modules/web.timers":180}],182:[function(a,b,c){(function(a,c){!function(c){"use strict";var d=Object.prototype.hasOwnProperty;var e;var f=typeof Symbol==="function"&&Symbol.iterator||"@@iterator";var g=typeof b==="object";var h=c.regeneratorRuntime;if(h){if(g){b.exports=h}return}h=c.regeneratorRuntime=g?b.exports:{};function i(a,b,c,d){var e=Object.create((b||p).prototype);e._invoke=w(a,c||null,new z(d||[]));return e}h.wrap=i;function j(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(d){return{type:"throw",arg:d}}}var k="suspendedStart";var l="suspendedYield";var m="executing";var n="completed";var o={};function p(){}function q(){}function r(){}var s=r.prototype=p.prototype;q.prototype=s.constructor=r;r.constructor=q;q.displayName="GeneratorFunction";function t(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}h.isGeneratorFunction=function(a){var b=typeof a==="function"&&a.constructor;return b?b===q||(b.displayName||b.name)==="GeneratorFunction":false};h.mark=function(a){a.__proto__=r;a.prototype=Object.create(s);return a};h.awrap=function(a){return new u(a)};function u(a){this.arg=a}function v(b){function c(a,c){var f=b[a](c);var g=f.value;return g instanceof u?Promise.resolve(g.arg).then(d,e):Promise.resolve(g).then(function(a){f.value=a;return f})}if(typeof a==="object"&&a.domain){c=a.domain.bind(c)}var d=c.bind(b,"next");var e=c.bind(b,"throw");var f=c.bind(b,"return");var g;function h(a,b){var d=g?g.then(function(){return c(a,b)}):new Promise(function(d){d(c(a,b))});g=d["catch"](function(a){});return d}this._invoke=h}t(v.prototype);h.async=function(a,b,c,d){var e=new v(i(a,b,c,d));return h.isGeneratorFunction(b)?e:e.next().then(function(a){return a.done?a.value:e.next()})};function w(a,b,c){var d=k;return function f(g,h){if(d===m){throw new Error("Generator is already running")}if(d===n){if(g==="throw"){throw h}return B()}while(true){var i=c.delegate;if(i){if(g==="return"||g==="throw"&&i.iterator[g]===e){c.delegate=null;var p=i.iterator["return"];if(p){var q=j(p,i.iterator,h);if(q.type==="throw"){g="throw";h=q.arg;continue}}if(g==="return"){continue}}var q=j(i.iterator[g],i.iterator,h);if(q.type==="throw"){c.delegate=null;g="throw";h=q.arg;continue}g="next";h=e;var r=q.arg;if(r.done){c[i.resultName]=r.value;c.next=i.nextLoc}else{d=l;return r}c.delegate=null}if(g==="next"){if(d===l){c.sent=h}else{c.sent=e}}else if(g==="throw"){if(d===k){d=n;throw h}if(c.dispatchException(h)){g="next";h=e}}else if(g==="return"){c.abrupt("return",h)}d=m;var q=j(a,b,c);if(q.type==="normal"){d=c.done?n:l;var r={value:q.arg,done:c.done};if(q.arg===o){if(c.delegate&&g==="next"){h=e}}else{return r}}else if(q.type==="throw"){d=n;g="throw";h=q.arg}}}}t(s);s[f]=function(){return this};s.toString=function(){return"[object Generator]"};function x(a){var b={tryLoc:a[0]};if(1 in a){b.catchLoc=a[1]}if(2 in a){b.finallyLoc=a[2];b.afterLoc=a[3]}this.tryEntries.push(b)}function y(a){var b=a.completion||{};b.type="normal";delete b.arg;a.completion=b}function z(a){this.tryEntries=[{tryLoc:"root"}];a.forEach(x,this);this.reset(true)}h.keys=function(a){var b=[];for(var c in a){b.push(c)}b.reverse();return function d(){while(b.length){var c=b.pop();if(c in a){d.value=c;d.done=false;return d}}d.done=true;return d}};function A(a){if(a){var b=a[f];if(b){return b.call(a)}if(typeof a.next==="function"){return a}if(!isNaN(a.length)){var c=-1,g=function h(){while(++c<a.length){if(d.call(a,c)){h.value=a[c];h.done=false;return h}}h.value=e;h.done=true;return h};return g.next=g}}return{next:B}}h.values=A;function B(){return{value:e,done:true}}z.prototype={constructor:z,reset:function(a){this.prev=0;this.next=0;this.sent=e;this.done=false;this.delegate=null;this.tryEntries.forEach(y);if(!a){for(var b in this){if(b.charAt(0)==="t"&&d.call(this,b)&&!isNaN(+b.slice(1))){this[b]=e}}}},stop:function(){this.done=true;var a=this.tryEntries[0];var b=a.completion;if(b.type==="throw"){throw b.arg}return this.rval},dispatchException:function(a){if(this.done){throw a}var b=this;function c(c,d){g.type="throw";g.arg=a;b.next=c;return!!d}for(var e=this.tryEntries.length-1;e>=0;--e){var f=this.tryEntries[e];var g=f.completion;if(f.tryLoc==="root"){return c("end")}if(f.tryLoc<=this.prev){var h=d.call(f,"catchLoc");var i=d.call(f,"finallyLoc");if(h&&i){if(this.prev<f.catchLoc){return c(f.catchLoc,true)}else if(this.prev<f.finallyLoc){return c(f.finallyLoc)}}else if(h){if(this.prev<f.catchLoc){return c(f.catchLoc,true)}}else if(i){if(this.prev<f.finallyLoc){return c(f.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;c>=0;--c){var e=this.tryEntries[c];if(e.tryLoc<=this.prev&&d.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var f=e;break}}if(f&&(a==="break"||a==="continue")&&f.tryLoc<=b&&b<=f.finallyLoc){f=null}var g=f?f.completion:{};g.type=a;g.arg=b;if(f){this.next=f.finallyLoc}else{this.complete(g)}return o},complete:function(a,b){if(a.type==="throw"){throw a.arg}if(a.type==="break"||a.type==="continue"){this.next=a.arg}else if(a.type==="return"){this.rval=a.arg;this.next="end"}else if(a.type==="normal"&&b){this.next=b}},finish:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.finallyLoc===a){this.complete(c.completion,c.afterLoc);y(c);return o}}},"catch":function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.tryLoc===a){var d=c.completion;if(d.type==="throw"){var e=d.arg;y(c)}return e}}throw new Error("illegal catch attempt")},delegateYield:function(a,b,c){this.delegate={iterator:A(a),resultName:b,nextLoc:c};return o}}}(typeof c==="object"?c:typeof window==="object"?window:typeof self==="object"?self:this)}).call(this,a("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:1}]},{},[2]);"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";var a=function(){function a(){_classCallCheck(this,a)}_createClass(a,[{key:"assign",value:function b(a,c){Object.defineProperty(this,a,{enumerable:false,configurable:false,writable:false,value:c});return this}}]);return a}();var b=window.Sprite=new a;b.assign("Namespace",function(){var a=new WeakMap;return function(b){if(a.has(b)==false){a.set(b,{})}return a.get(b)}});b.assign("rand",function(a,b){var c=b-a;c*=Math.random();return a+Math.floor(c)});b.assign("copy",function(a){return JSON.parse(JSON.stringify(a))});b.assign("each",function(a,b){if(a.forEach){a.forEach(b)}else{for(var c in a){b(a[c],c,a)}}});b.assign("uuid",function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/x|y/g,function(a){var b=Math.floor(Math.random()*16);if(a=="x"){return b.toString(16)}else{return(b&3|8).toString(16)}})});b.assign("btoa",function(a){return window.btoa(unescape(encodeURIComponent(a)))});b.assign("atob",function(a){return decodeURIComponent(escape(window.atob(a)))})})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Canvas",function(){_createClass(b,null,[{key:"support",value:function c(){var a=document.createElement("canvas");var b=a.getContext("2d");if(b){return true}return false}}]);function b(c,d){_classCallCheck(this,b);var e=a(this);var f=document.createElement("canvas");f.width=c||640;f.height=d||480;var g=f.getContext("2d");if(!g){throw new Error("Sprite.Canvas canvas is not supported")}console.log("canvas inited");e.color="#000000";e.canvas=f;e.context=g;e.alpha=1;e.filter=new Map;this.filter("brightness",0);this.filter("contrast",0)}_createClass(b,[{key:"filter",value:function d(b,c){var d=a(this);if(Number.isFinite(c)){if(b=="brightness"){c+=1}if(b=="contrast"){c+=1}if(d.filter.get(b)!=c){(function(){d.filter.set(b,c);var a=[];d.filter.forEach(function(b,c,d){a.push(c+"("+b+")")});a=a.join(" ");d.canvas.style.filter=a;d.canvas.style.webkitFilter=a})()}}else{return d.filter.get(b)}}},{key:"drawImage",value:function e(){var b=a(this);b.context.globalAlpha=this.alpha;b.context.drawImage.apply(b.context,arguments)}},{key:"release",value:function f(){}},{key:"clear",value:function g(){var b=a(this);b.context.fillStyle=b.color;b.context.fillRect(0,0,this.width,this.height)}},{key:"color",get:function h(){return a(this).color},set:function i(b){if(b.match(/^#([\da-fA-F][\da-fA-F])([\da-fA-F][\da-fA-F])([\da-fA-F][\da-fA-F])$/)){a(this).color=b}else{console.error(b,this);throw new Error("Sprite.Canvas invalid color value")}}},{key:"alpha",get:function j(){return a(this).alpha},set:function k(b){if(Number.isFinite(b)&&b>=0&&b<=1){a(this).alpha=b}else{console.error(b,this);throw new Error("Sprite.Canvas got invalid alpha number")}}},{key:"width",get:function l(){return a(this).canvas.width},set:function m(b){if(Number.isFinite(b)&&b>0&&b<1e4){a(this).canvas.width=b}else{console.error(b,this);throw new Error("Sprite.Canvas got invalid width number")}}},{key:"height",get:function n(){return a(this).canvas.height},set:function o(b){var c=a(this);if(Number.isFinite(b)&&b>0&&b<1e4){if(b!=c.canvas.height){c.canvas.height=b}}else{console.error(b,this);throw new Error("Sprite.Canvas got invalid height number")}}},{key:"canvas",get:function p(){return a(this).canvas},set:function q(a){throw new Error("Sprite.Canvas.canvas cannot write")}}]);return b}())})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";var a=Sprite.Namespace();function b(a){return a>0&&(a-1&a)===0}var c="\n  precision mediump float;\n  attribute vec2 a_texCoord;\n  varying vec2 v_texCoord;\n\n  attribute vec2 aVertex;\n  uniform vec2 resolution;\n\n  uniform vec4 position;\n\n  void main(void) {\n     vec2 a = aVertex * (position.zw / resolution) + (position.xy / resolution);\n     vec2 b = a * 2.0 - 1.0;\n\n     gl_Position = vec4(b * vec2(1.0, -1.0), 0.0, 1.0);\n     v_texCoord = a_texCoord;\n  }";var d="\n  precision mediump float;\n\n  uniform vec4 crop;\n  uniform float brightness;\n  uniform float alpha;\n  uniform float contrast;\n\n  uniform sampler2D image;\n\n  // the texCoords passed in from the vertex shader.\n  varying vec2 v_texCoord;\n\n  void main(void) {\n\n    vec2 t = v_texCoord;\n    t.x *= crop.z;\n    t.y *= crop.w;\n    t += crop.xy;\n\n     vec4 color = texture2D(image, t).rgba;\n\n     if (contrast != 0.0) {\n       if (contrast > 0.0) {\n         color.xyz = (color.xyz - 0.5) / (1.0 - contrast) + 0.5;\n       } else {\n         color.xyz = (color.xyz - 0.5) * (1.0 + contrast) + 0.5;\n       }\n     }\n\n     if (brightness != 0.0) {\n       color.xyz += brightness;\n     }\n\n     if (alpha != 1.0) {\n       color.a *=  alpha;\n     }\n\n     gl_FragColor = color;\n  }";Sprite.assign("Webgl",function(){_createClass(e,null,[{key:"support",value:function f(){var a=document.createElement("canvas");var b=a.getContext("webgl");if(!b){a.getContext("experimental-webgl")}if(!b){return false}return true}}]);function e(b,f){_classCallCheck(this,e);var g=a(this);var h=document.createElement("canvas");h.width=b||640;h.height=f||480;var i={antialias:false,preserveDrawingBuffer:true};var j=h.getContext("webgl",i);if(!j){j=h.getContext("experimental-webgl",i)}g.gl=j;if(!j){throw new Error("Sprite.Webgl webgl is not supported")}g.color=[0,0,0];g.filter=new Map;g.textureCache=new Map;g.canvas=h;g.maxTextureSize=j.getParameter(j.MAX_TEXTURE_SIZE);j.viewport(0,0,h.width,h.height);var k=j.createShader(j.VERTEX_SHADER);var l=j.createShader(j.FRAGMENT_SHADER);j.shaderSource(k,c);j.shaderSource(l,d);j.compileShader(k);j.compileShader(l);var m=j.createProgram();j.attachShader(m,k);j.attachShader(m,l);j.linkProgram(m);j.useProgram(m);j.cullFace(j.BACK);j.frontFace(j.CW);j.enable(j.CULL_FACE);j.enable(j.BLEND);j.disable(j.DEPTH_TEST);j.blendFunc(j.SRC_ALPHA,j.ONE_MINUS_SRC_ALPHA);g.cropLoc=j.getUniformLocation(m,"crop");g.brightnessLoc=j.getUniformLocation(m,"brightness");g.contrastLoc=j.getUniformLocation(m,"contrast");g.alphaLoc=j.getUniformLocation(m,"alpha");g.resolutionLoc=j.getUniformLocation(m,"resolution");j.uniform2f(g.resolutionLoc,h.width,h.height);g.positionLoc=j.getUniformLocation(m,"position");g.tLoc=j.getAttribLocation(m,"a_texCoord");j.enableVertexAttribArray(g.tLoc);g.texCoordBuffer=j.createBuffer();j.bindBuffer(j.ARRAY_BUFFER,g.texCoordBuffer);j.vertexAttribPointer(g.tLoc,2,j.FLOAT,false,0,0);j.bufferData(j.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),j.STATIC_DRAW);g.vLoc=j.getAttribLocation(m,"aVertex");j.enableVertexAttribArray(g.vLoc);g.vertexBuff=j.createBuffer();j.bindBuffer(j.ARRAY_BUFFER,g.vertexBuff);j.bufferData(j.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),j.STATIC_DRAW);j.enableVertexAttribArray(g.vLoc);j.vertexAttribPointer(g.vLoc,2,j.FLOAT,false,0,0);g.currentTexture=null;this.filter("brightness",0);this.filter("contrast",0);this.alpha=1;console.log("webgl inited. max texture size: %d",j.getParameter(j.MAX_TEXTURE_SIZE))}_createClass(e,[{key:"drawImage9",value:function g(b,c,d,e,f,h,i,j,k){var l=a(this);var m=l.gl;var n=this.createTexture(m,b);if(l.currentTexture!=n){m.bindTexture(m.TEXTURE_2D,n);l.currentTexture=n}m.uniform4f(l.cropLoc,c/b.width,d/b.height,e/b.width,f/b.height);m.uniform4f(l.positionLoc,h,i,j,k);m.drawArrays(m.TRIANGLE_FAN,0,4)}},{key:"release",value:function h(){var b=a(this);var c=true;var d=false;var e=undefined;try{for(var f=b.textureCache.values()[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;b.gl.deleteTexture(h)}}catch(i){d=true;e=i}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}b.textureCache=new Map}},{key:"createTexture",value:function i(c,d){var e=a(this);if(e.textureCache.has(d)){return e.textureCache.get(d)}else{c.activeTexture(c.TEXTURE0);var f=c.createTexture();c.bindTexture(c.TEXTURE_2D,f);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,d);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);if(b(d.width)&&b(d.height)){c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR_MIPMAP_LINEAR);c.generateMipmap(c.TEXTURE_2D)}else{c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST)}c.bindTexture(c.TEXTURE_2D,null);e.textureCache.set(d,f);return f}}},{key:"drawImage",value:function j(a,b,c,d,e,f,g,h,i){if(arguments.length==9){}else if(arguments.length==5){f=b;g=c;h=d;i=e;b=0;c=0;d=a.width;e=a.height}else if(arguments.length==3){f=b;g=c;h=a.width;i=a.height;b=0;c=0;d=a.width;e=a.height}else{console.error(arguments,this);throw new Error("Sprite.Webgl.drawImage invalid arguments")}this.drawImage9(a,b,c,d,e,f,g,h,i)}},{key:"filter",value:function k(b,c){var d=a(this);var e=d.gl;if(Number.isFinite(c)){d.filter.set(b,c);e.uniform1f(d.brightnessLoc,d.filter.get("brightness"));e.uniform1f(d.contrastLoc,d.filter.get("contrast"))}else{return d.get(b)}}},{key:"clear",value:function l(){var b=a(this);var c=b.gl;var d=b.color;c.clearColor(d[0],d[1],d[2],1);c.clear(c.COLOR_BUFFER_BIT)}},{key:"alpha",get:function m(){var b=a(this);return b.alpha},set:function n(b){var c=a(this);var d=c.gl;if(Number.isFinite(b)&&!isNaN(b)&&b>=0&&b<=1){if(b!=c.alpha){c.alpha=b;d.uniform1f(c.alphaLoc,c.alpha)}}else{console.error(b,this);throw new Error("Sprite.Webgl got invalid alpha number")}}},{key:"color",get:function o(){var b=a(this);var c=b.color;var d=c[0].toString(16);var e=c[1].toString(16);var f=c[2].toString(16);if(d.length<2)d="0"+d;if(e.length<2)e="0"+e;if(f.length<2)f="0"+f;return"#"+d+e+f},set:function p(b){var c=a(this);var d=b.match(/^#([\da-fA-F][\da-fA-F])([\da-fA-F][\da-fA-F])([\da-fA-F][\da-fA-F])$/);if(d){var e=d[1];var f=d[2];var g=d[3];c.color[0]=parseInt(e,16);c.color[1]=parseInt(f,16);c.color[2]=parseInt(g,16)}else{console.error(b,this);throw new Error("Sprite.Webgl.color invalid color format")}}},{key:"width",get:function q(){var b=a(this);return b.canvas.width},set:function r(b){var c=a(this);if(Number.isFinite(b)&&!isNaN(b)&&b>0&&b<=4096){if(b!=c.canvas.width){c.canvas.width=b;c.gl.viewport(0,0,c.canvas.width,c.canvas.height);c.gl.uniform2f(c.resolutionLoc,c.canvas.width,c.canvas.height)}}else{console.error(b,this);throw new Error("Sprite.Webgl got invalid width number")}}},{key:"height",get:function s(){var b=a(this);return b.canvas.height},set:function t(b){var c=a(this);if(Number.isFinite(b)&&!isNaN(b)&&b>0&&b<=4096){if(b!=c.canvas.height){c.canvas.height=b;c.gl.viewport(0,0,c.canvas.width,c.canvas.height);c.gl.uniform2f(resolutionLoc,c.canvas.width,c.canvas.height)}}else{console.error(b,this);throw new Error("Sprite.Webgl got invalid height number")}}},{key:"canvas",get:function u(){return a(this).canvas},set:function v(a){console.error(a,this);throw new Error("Sprite.Webgl.canvas cannot write")}}]);return e}())})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Event",function(){function b(){_classCallCheck(this,b);var c=a(this);c.listeners=new Map;c.once=new Map;c.parent=null}_createClass(b,[{key:"on",value:function c(b,d){var e=a(this);if(e.once.has(b)){d({type:b,target:this,data:e.once.get(b)});return null}else{if(e.listeners.has(b)==false){e.listeners.set(b,new Map)}var f=Sprite.uuid();e.listeners.get(b).set(f,d);return f}}},{key:"off",value:function d(b,c){var d=a(this);if(d.listeners.has(b)&&d.listeners.get(b).has(c)){d.listeners.get(b)["delete"](c);if(d.listeners.get(b).size<=0){d.listeners["delete"](b)}return true}return false}},{key:"emitBubble",value:function e(b,c,d){var e=a(this);var f=true;if(e.listeners.has(b)){var g=true;var h=false;var i=undefined;try{for(var j=e.listeners.get(b).values()[Symbol.iterator](),k;!(g=(k=j.next()).done);g=true){var l=k.value;if(l({type:b,target:c,data:d})===false){f=false}}}catch(m){h=true;i=m}finally{try{if(!g&&j["return"]){j["return"]()}}finally{if(h){throw i}}}}if(e.parent&&f==true){e.parent.emitBubble(b,c,d)}}},{key:"emit",value:function f(b,c,d){var e=a(this);if(c){if(typeof d!="undefined"){e.once.set(b,d)}else{e.once.set(b,null)}}var f=true;if(e.listeners.has(b)){var g=true;var h=false;var i=undefined;try{for(var j=e.listeners.get(b).values()[Symbol.iterator](),k;!(g=(k=j.next()).done);g=true){var l=k.value;if(l({type:b,target:this,data:d})===false){f=false}}}catch(m){h=true;i=m}finally{try{if(!g&&j["return"]){j["return"]()}}finally{if(h){throw i}}}}if(e.parent&&f==true){e.parent.emitBubble(b,this,d)}}},{key:"parent",get:function g(){var b=a(this);return b.parent},set:function h(b){var c=a(this);c.parent=b}}]);return b}())})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function b(a,c,d){var e=true;a:while(e){var f=a,g=c,h=d;i=j=k=undefined;e=false;if(f===null)f=Function.prototype;var i=Object.getOwnPropertyDescriptor(f,g);if(i===undefined){var j=Object.getPrototypeOf(f);if(j===null){return undefined}else{a=j;c=g;d=h;e=true;continue a}}else if("value"in i){return i.value}else{var k=i.get;if(k===undefined){return undefined}return k.call(h)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Tween",function(b){_inherits(c,b);_createClass(c,null,[{key:"get",value:function d(a){return new Sprite.Tween(a)}}]);function c(b){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var d=a(this);d.object=b;d.callback=null;d.action=[];d.doing=false}_createClass(c,[{key:"nextAction",value:function e(){var b=a(this);if(b.doing==false&&b.action.length>0){var c=b.action[0];b.action.splice(0,1);switch(c.type){case"to":this.toAction(c.attributes,c.time);break;case"wait":this.waitAction(c.time);break;case"call":this.callAction(c.callback);break;case"promise":this.promiseAction(c.callback);break;default:console.error(c);throw new Error("Sprite.Tween got invalid action")}}}},{key:"toAction",value:function f(b,c){var d=this;var e=a(this);e.doing=true;var f=Math.min(100,c);var g=c/f;var h={};for(var i in b){if(Number.isFinite(b[i])){h[i]=b[i]-e.object[i];h[i]/=f}}var j=0;var k=setInterval(function(){j++;if(j>=f){for(var a in b){e.object[a]=b[a]}clearInterval(k);e.doing=false;d.nextAction()}else{for(var a in h){e.object[a]+=h[a]}}},g)}},{key:"to",value:function g(b,c){a(this).action.push({type:"to",attributes:b,time:c});this.nextAction();return this}},{key:"promiseAction",value:function h(a){var b=this;this.doing=true;a().then(function(){b.doing=false;b.nextAction()})}},{key:"promise",value:function i(b){a(this).action.push({type:"promise",callback:b});this.nextAction();return this}},{key:"callAction",value:function j(a){this.doing=true;a();this.doing=false;this.nextAction()}},{key:"call",value:function k(b){a(this).action.push({type:"call",callback:b});this.nextAction();return this}},{key:"waitAction",value:function l(b){var c=this;var d=a(this);d.doing=true;setTimeout(function(){d.doing=false;c.nextAction()},b)}},{key:"wait",value:function m(b){a(this).action.push({type:"wait",time:b});this.nextAction();return this}}]);return c}(Sprite.Event))})();"use strict";(function(){"use strict";var a=Sprite.Namespace();var b=new Map;var c=new Map;function d(a,e){var f=arguments.length<=2||arguments[2]===undefined?0:arguments[2];var g=null;if(a.match(/js$/)){g="js"}else if(a.match(/jpg$|jpeg$|png$|bmp$|gif$/i)){g="image"}else if(a.match(/wav$|mp3$|ogg$/i)){g="audio"}else if(a.match(/json$/i)){g="json"}else{console.error(a);throw new Error("Fetch got an invalid url")}var h=function k(d){b.set(a,d);if(g=="json"){d=Sprite.copy(d)}if(e){e(d)}if(c.has(a)){var f=c.get(a);var h=true;var i=false;var j=undefined;try{for(var k=f[Symbol.iterator](),l;!(h=(l=k.next()).done);h=true){var m=l.value;if(m){m(d)}}}catch(n){i=true;j=n}finally{try{if(!h&&k["return"]){k["return"]()}}finally{if(i){throw j}}}c["delete"](a)}};if(b.has(a)){h(b.get(a));return}if(!f){if(c.has(a)){c.get(a).push(e);return}c.set(a,[])}var i=new XMLHttpRequest;i.open("GET",a,true);i.timeout=5e3;switch(g){case"js":i.responseType="text";break;case"image":i.responseType="blob";break;case"audio":i.responseType="blob";break;case"json":i.responseType="json";break;default:console.error(g,a);throw new Error("Fetch something wrong")}if(typeof e!="function")e=function(){};i.ontimeout=function(){if(f>=2){console.error(a);throw new Error("Sprite.Loader.Fetch timeout 3 times")}else{d(a,e,f+1)}};var j=false;i.onreadystatechange=function(){if(i.readyState==4&&!j){j=true;if(i.response){if(g=="js"){var b=null;try{b=new Function(i.response)}catch(c){console.error(i.response,a);throw c}h(b)}else if(g=="image"){(function(){var a=i.response;var b=new Image;b.onload=function(){b.onload=null;h(b)};b.src=window.URL.createObjectURL(a)})()}else if(g=="audio"){(function(){var a=i.response;var b=new Audio;b.oncanplay=function(){b.oncanplay=null;h(b)};b.src=window.URL.createObjectURL(a)})()}else if(g=="json"){var d=i.response;if(!d){console.error(a);throw new Error("Sprite.Loader invalid json")}h(d)}}else{console.error("url: ",a);console.error("response: ",i.response," readyState: ",i.readyState," status: ",i.status," statusText: ",i.statusText);throw new Error("Sprite.Loader.Fetch Error")}}};i.send()}Sprite.assign("load",function(){var a=Array.prototype.slice.call(arguments);return new Promise(function(b,c){var e=[];var f=true;var g=false;var h=undefined;try{for(var i=a[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;if(typeof k=="string"){e.push(k)}else if(k instanceof Array){var l=true;var m=false;var n=undefined;try{for(var o=k[Symbol.iterator](),p;!(l=(p=o.next()).done);l=true){var q=p.value;e.push(q)}}catch(r){m=true;n=r}finally{try{if(!l&&o["return"]){o["return"]()}}finally{if(m){throw n}}}}else{console.error(k,a);throw new Error("Sprite.load got invalid argument")}}}catch(r){g=true;h=r}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}var s=0;var t=[];t.length=e.length;var u=function v(){s++;if(s>=t.length){b(t)}};e.forEach(function(a,b){d(a,function(a){t[b]=a;u()})})})})})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function c(a,b,d){var e=true;a:while(e){var f=a,g=b,h=d;i=j=k=undefined;e=false;if(f===null)f=Function.prototype;var i=Object.getOwnPropertyDescriptor(f,g);if(i===undefined){var j=Object.getPrototypeOf(f);if(j===null){return undefined}else{a=j;b=g;d=h;e=true;continue a}}else if("value"in i){return i.value}else{var k=i.get;if(k===undefined){return undefined}return k.call(h)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b;
}(function(){"use strict";var a=0;var b=function(b){_inherits(c,b);function c(){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);this.tick()}_createClass(c,[{key:"tick",value:function d(){var b=this;a++;this.emit("tick",false,a);window.requestAnimationFrame(function(){b.tick()})}},{key:"after",value:function e(a,b){var c=this;var d=0;var e=this.on("tick",function(){d++;if(d>=a){c.off("tick",e);if(b){b()}}});return e}},{key:"clearAfter",value:function f(a){this.off("tick",a)}},{key:"whiles",value:function g(a,b){var c=this;var d=0;var e=this.on("tick",function(){d++;if(d>=a){if(b){b(true)}c.off("tick",e)}else{if(b){b(false)}}});return e}},{key:"clearWhiles",value:function h(a){this.off("tick",a)}}]);return c}(Sprite.Event);Sprite.assign("Ticker",new b)})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function d(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();var b=document.createElement("canvas");b.width=1;b.height=1;var c=b.getContext("2d");c.clearRect(0,0,1,1);var d=c.getImageData(0,0,1,1).data;Sprite.assign("Display",function(b){_inherits(e,b);function e(){_classCallCheck(this,e);_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var b=a(this);b.x=0;b.y=0;b.centerX=0;b.centerY=0;b.alpha=1;b.visible=true;b.width=0;b.height=0}_createClass(e,[{key:"draw",value:function f(a){console.error("sub-class should override this function");throw new Error("Invalid call Sprite.Display.draw")}},{key:"hitTest",value:function g(a,b){c.clearRect(0,0,1,1);c.save();c.translate(-a,-b);this.draw(c);c.restore();var e=c.getImageData(0,0,1,1).data;if(d[0]!=e[0]||d[1]!=e[1]||d[2]!=e[2]){return true}return false}},{key:"drawPosition",value:function h(){var a=this.centerX;var b=this.centerY;var c=this.x;var d=this.y;var e=this.alpha;var f=this.parent;while(f){a+=f.centerX;b+=f.centerY;c+=f.x;d+=f.y;e*=f.alpha;if(e<=.001){return null}if(f.visible==false){return null}f=f.parent}return{x:c-a,y:d-b,alpha:e}}},{key:"drawImage",value:function i(a,b,c,d,e,f){if(this.visible!=true||this.alpha<.01){return}var g=this.drawPosition();if(!g){return}a.alpha=g.alpha;try{a.drawImage(b,c,d,e,f,g.x,g.y,e,f)}catch(h){console.error(b,c,d,e,f,g.x,g.y,e,f);throw h}}},{key:"width",get:function j(){return a(this).width},set:function k(b){a(this).width=b}},{key:"height",get:function l(){return a(this).height},set:function m(b){a(this).height=b}},{key:"x",get:function n(){return a(this).x},set:function o(b){var c=a(this);if(Number.isFinite(b)){if(b!=c.x){c.x=Math.floor(b);this.emit("change")}}else{console.error(b,this);throw new Error("Sprite.Display.set x : invalid argument")}}},{key:"y",get:function p(){return a(this).y},set:function q(b){var c=a(this);if(Number.isFinite(b)){if(b!=c.y){c.y=Math.floor(b);this.emit("change")}}else{console.error(b,this);throw new Error("Sprite.Display.set y : invalid argument")}}},{key:"centerX",get:function r(){return a(this).centerX},set:function s(b){var c=a(this);if(Number.isFinite(b)){if(b!=c.centerX){c.centerX=Math.floor(b);this.emit("change")}}else{console.error(b,this);throw new Error("Sprite.Display.set centerX : invalid argument")}}},{key:"centerY",get:function t(){return a(this).centerY},set:function u(b){var c=a(this);if(Number.isFinite(b)){if(b!=c.centerY){c.centerY=Math.floor(b);this.emit("change")}}else{console.error(b,this);throw new Error("Sprite.Display.set centerY : invalid argument")}}},{key:"alpha",get:function v(){var b=a(this);return b.alpha},set:function w(b){var c=a(this);if(Number.isFinite(b)&&(b>=0||b<=1)){if(b!=c.alpha){c.alpha=b;this.emit("change")}}else{console.error(b,this);throw new Error("Sprite.Display.set alpha : invalid argument")}}},{key:"visible",get:function x(){var b=a(this);return b.visible},set:function y(b){var c=a(this);if(b!=c.visible){c.visible=b;this.emit("change")}}}]);return e}(Sprite.Event))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function e(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Container",function(b){_inherits(c,b);function c(){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var b=a(this);b.children=[];b.cacheCanvas=null}_createClass(c,[{key:"findMinMax",value:function d(){var a=null,b=null,c=null,d=null;var e=true;var f=false;var g=undefined;try{for(var h=this.children[Symbol.iterator](),i;!(e=(i=h.next()).done);e=true){var j=i.value;if(j.findMinMax){var k=j.findMinMax();if(a===null||a>k.minX){a=k.minX}if(b===null||b>k.minY){b=k.minY}if(c===null||c<k.maxX){c=k.maxX}if(d===null||d<k.maxY){d=k.maxY}}else{if(a===null||a>j.x){a=j.x}if(b===null||b>j.y){b=j.y}if(j.width&&j.height){if(c===null||c<j.x+j.width){c=j.x+j.width}if(d===null||d<j.y+j.height){d=j.y+j.height}}}}}catch(l){f=true;g=l}finally{try{if(!e&&h["return"]){h["return"]()}}finally{if(f){throw g}}}return{minX:a,minY:b,maxX:c,maxY:d}}},{key:"clearCache",value:function e(){var b=a(this);b.cacheCanvas=null;if(b.cacheX){delete b.cacheX}if(b.cacheY){delete b.cacheY}if(b.cacheWidth){delete b.cacheWidth}if(b.cacheHeight){delete b.cacheHeight}}},{key:"cache",value:function f(b,c,d,e){var f=a(this);if(f.cacheCanvas){this.clearCache()}var g=this.parent;this.parent=null;var h=this.findMinMax();if(h&&Number.isFinite(h.minX)&&Number.isFinite(h.minY)&&Number.isFinite(h.maxX)&&Number.isFinite(h.maxY)){var i=h.maxX-h.minX;var j=h.maxY-h.minY;var k=document.createElement("canvas");k.width=i;k.height=j;var l=k.getContext("2d");l.save();l.translate(-h.minX,-h.minY);this.draw(l);l.restore();f.cacheX=h.minX;f.cacheY=h.minY;f.cacheWidth=i;f.cacheHeight=j;f.cacheCanvas=k}else{console.error(h);throw new Error("Sprite.Container.cache cannot work something wrong")}this.parent=g}},{key:"hitTest",value:function g(b,d){var e=a(this);if(this.cacheCanvas){return _get(Object.getPrototypeOf(c.prototype),"hitTest",this).call(this,b,d)}else{var f=[];var g=true;var h=false;var i=undefined;try{for(var j=this.children[Symbol.iterator](),k;!(g=(k=j.next()).done);g=true){var l=k.value;var m=l.hitTest(b,d);if(m instanceof Array){f=f.concat(m)}else if(m===true){f.push(l)}}}catch(n){h=true;i=n}finally{try{if(!g&&j["return"]){j["return"]()}}finally{if(h){throw i}}}return f}}},{key:"draw",value:function h(b){var c=a(this);if(this.alpha<.01||this.visible!=true){return}if(this.cacheCanvas){var d=this.x;var e=this.y;this.x+=c.cacheX;this.y+=c.cacheY;this.drawImage(b,this.cacheCanvas,0,0,this.cacheCanvas.width,this.cacheCanvas.height);this.x=d;this.y=e}else{if(this.children.length>0){var f=true;var g=false;var h=undefined;try{for(var i=this.children[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;if(k.visible==true&&k.alpha>=.01){k.draw(b)}}}catch(l){g=true;h=l}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}}}}},{key:"hasChild",value:function i(a){if(this.children.indexOf(a)!=-1){return true}return false}},{key:"appendChild",value:function j(){var a=Array.prototype.slice.call(arguments);if(a.length<=0){throw new Error("Sprite.Container.appendChild got an invalid arguments")}var b=true;var c=false;var d=undefined;try{for(var e=a[Symbol.iterator](),f;!(b=(f=e.next()).done);b=true){var g=f.value;if(g instanceof Sprite.Display==false){console.error(g);throw new Error("Sprite.Container.appendChild only accept Sprite.Display or it's sub-class")}g.parent=this;this.children.push(g)}}catch(h){c=true;d=h}finally{try{if(!b&&e["return"]){e["return"]()}}finally{if(c){throw d}}}this.emit("addedChildren")}},{key:"appendChildAt",value:function k(){var a=Array.prototype.slice.call(arguments);if(a.length<=1){console.log(arguments,this);throw new TypeError("Sprite.Container.appendChildAt has an invalid arguments")}var b=a[0];for(var c=1,d=a.length;c<d;c++){if(a[c]instanceof Sprite.Display==false){console.error(a[c]);throw new Error("Sprite.Container.appendChildAt only can accept Sprite.Display or it's sub-class")}a[c].parent=this;this.children.splice(b,0,a[c])}this.emit("addedChildren")}},{key:"removeChild",value:function l(a){var b=this.children.indexOf(a);if(b!=-1){this.children[b].parent=null;this.children.splice(b,1);this.emit("removedChildren");return true}else{return false}}},{key:"clear",value:function m(){var b=a(this);var c=true;var d=false;var e=undefined;try{for(var f=b.children[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;h.parent=null}}catch(i){d=true;e=i}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}b.children=[];this.clearCache();this.emit("removedChildren")}},{key:"children",get:function n(){return a(this).children},set:function o(a){throw new Error("Sprite.Container.children readonly")}},{key:"cacheCanvas",get:function p(){return a(this).cacheCanvas},set:function q(a){throw new Error("Sprite.Container.cacheCanvas readonly")}},{key:"cacheX",get:function r(){return a(this).cacheX},set:function s(a){throw new Error("Sprite.Container.cacheX readonly")}},{key:"cacheY",get:function t(){return a(this).cacheY},set:function u(a){throw new Error("Sprite.Container.cacheY readonly")}}]);return c}(Sprite.Display))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function f(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Stage",function(b){_inherits(c,b);function c(b,d){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var e=a(this);if(!e.renderer&&Sprite.Webgl.support()){e.renderer=new Sprite.Webgl(b,d);e.rendererType="webgl"}if(!e.renderer&&Sprite.Canvas.support()){e.renderer=new Sprite.Canvas(b,d);e.rendererType="canvas"}if(!e.renderer){throw new Error("Sprite.Stage all renderer not support")}e.color="#000000"}_createClass(c,[{key:"releaseRenderer",value:function d(){a(this).renderer.release()}},{key:"filter",value:function e(b,c){return a(this).renderer.filter(b,c)}},{key:"findHit",value:function f(a){var b=this.hitTest(this.mouseX,this.mouseY);b.reverse();if(b.length)return b;return null}},{key:"clear",value:function g(){a(this).renderer.clear()}},{key:"update",value:function h(){this.emit("beforeDraw");this.draw(this.renderer);this.emit("afterDraw")}},{key:"draw",value:function i(a){if(this.children.length<=0){return false}this.clear();var b=true;var c=false;var d=undefined;try{for(var e=this.children[Symbol.iterator](),f;!(b=(f=e.next()).done);b=true){var g=f.value;g.draw(a)}}catch(h){c=true;d=h}finally{try{if(!b&&e["return"]){e["return"]()}}finally{if(c){throw d}}}}},{key:"renderer",get:function j(){return a(this).renderer},set:function k(a){throw new Error("Sprite.Stage renderer readonly")}},{key:"rendererType",get:function l(){return a(this).rendererType},set:function m(a){throw new Error("Sprite.Stage.rendererType readonly")}},{key:"width",get:function n(){return a(this).renderer.width},set:function o(b){a(this).renderer.width=b}},{key:"height",get:function p(){return a(this).renderer.height},set:function q(b){a(this).renderer.height=b}},{key:"color",get:function r(){return a(this).renderer.color},set:function s(b){a(this).renderer.color=b}},{key:"canvas",get:function t(){return this.renderer.canvas},set:function u(a){throw new Error("Sprite.Stage.canvas readonly")}}]);return c}(Sprite.Container))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function g(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();var b=document.createElement("canvas");b.width=1;b.height=1;var c=b.getContext("2d");Sprite.assign("Text",function(b){_inherits(d,b);function d(b){_classCallCheck(this,d);_get(Object.getPrototypeOf(d.prototype),"constructor",this).call(this);var c=a(this);c.text=b.text||"Invalid Text";c.maxWidth=b.maxWidth||1e3;c.color=b.color||"black";c.fontSize=b.fontSize||14;c.fontFamily=b.fontFamily||"Ariel";c.image=null;this.generate()}_createClass(d,[{key:"clone",value:function e(){var b=a(this);var c=new Text({text:b.text,maxWidth:b.maxWidth,color:b.color,fontSize:b.fontSize,fontFamily:b.fontFamily});c.x=this.x;c.y=this.y;c.centerX=this.centerX;c.centerY=this.centerY;c.alpha=this.alpha;c.visible=this.visible;return c}},{key:"generate",value:function f(){var b=a(this);c.font=this.fontSize+"px "+b.fontFamily;var d=Math.ceil(c.measureText("龍").width*1.2);this.width=0;var e=[];var f="";for(var g=0,h=this.text.length;g<h;g++){if(c.measureText(f+this.text[g]).width>this.maxWidth){e.push(f);f=this.text[g]}else{f+=this.text[g]}if(c.measureText(f).width>this.width)this.width=Math.ceil(c.measureText(f).width)}if(f.length){e.push(f)}this.height=e.length*d;var i=document.createElement("canvas");i.width=this.width;i.height=this.height;var j=i.getContext("2d");j.font=this.fontSize+"px "+this.fontFamily;j.fillStyle=this.color;j.textAlign="center";j.textBaseline="top";e.forEach(function(a,b){j.fillText(a,i.width/2,b*d)});b.image=null;b.image=i}},{key:"draw",value:function g(b){var c=a(this);var d=c.image;if(d&&d.width>0&&d.height>0){this.drawImage(b,d,0,0,d.width,d.height)}}},{key:"text",get:function h(){var b=a(this);return b.text},set:function i(b){var c=a(this);if(b!=this.text){c.text=b;this.generate()}}},{key:"color",get:function j(){var b=a(this);return b.color},set:function k(b){var c=a(this);if(b!=this.color){c.color=b;this.generate()}}},{key:"fontSize",get:function l(){var b=a(this);return b.fontSize},set:function m(b){var c=a(this);if(b!=this.fontSize){c.fontSize=b;this.generate()}}},{key:"fontFamily",get:function n(){return a(this).fontFamily},set:function o(b){var c=a(this);if(b!=c.fontFamily){c.fontFamily=b;this.generate()}}}]);return d}(Sprite.Display))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function h(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Frame",function(b){_inherits(c,b);function c(b,d,e,f,g){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var h=a(this);h.image=b;h.sx=d;h.sy=e;this.width=f;this.height=g}_createClass(c,[{key:"print",value:function d(){console.log(a(this))}},{key:"clone",value:function e(){var a=new Sprite.Frame(this.image,this.sx,this.sy,this.width,this.height);a.x=this.x;a.y=this.y;a.parent=this.parent;return a}},{key:"draw",value:function f(a){this.drawImage(a,this.image,this.sx,this.sy,this.width,this.height)}},{key:"image",get:function g(){var b=a(this);return b.image},set:function h(a){throw new Error("Sprite.Frame.image readonly")}},{key:"sx",get:function i(){var b=a(this);return b.sx},set:function j(a){throw new Error("Sprite.Frame.sx readonly")}},{key:"sy",get:function k(){var b=a(this);return b.sy},set:function l(a){throw new Error("Sprite.Frame.sy readonly")}}]);return c}(Sprite.Display))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function i(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Sheet",function(b){_inherits(c,b);function c(b){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var d=a(this);if(!b.images||!b.images.length||!Number.isFinite(b.width)||b.width<=0||b.width>4096||!Number.isFinite(b.height)||b.height<=0||b.height>4096){console.error(b);throw new Error("Sprite.Sheet.constructor get invalid arguments")}d.images=b.images;d.tilewidth=b.width;this.width=b.width;d.tileheight=b.height;this.height=b.height;d.animations=b.animations||{};d.currentAnimation=null;d.currentFrame=0;d.animationTimer=null;d.frameCount=0;var e=true;var f=false;var g=undefined;try{for(var h=d.images[Symbol.iterator](),i;!(e=(i=h.next()).done);e=true){var j=i.value;if(!(j instanceof Image)&&!(j.getContext&&j.getContext("2d"))){console.error(j,d,this);throw new Error("Sprite.Sheet got invalid image, not Image or Canvas")}if(j.width<=0||!Number.isFinite(j.width)||j.height<=0||!Number.isFinite(j.height)){console.error(j,d,this);throw new Error("Sprite.Sheet got invalid image, invalid width or height")}var k=Math.floor(j.width/d.tilewidth);var l=Math.floor(j.height/d.tileheight);d.frameCount+=k*l}}catch(m){f=true;g=m}finally{try{if(!e&&h["return"]){h["return"]()}}finally{if(f){throw g}}}}_createClass(c,[{key:"clone",value:function d(){var b=a(this);var c=new Sprite.Sheet({images:b.images,width:b.tilewidth,height:b.tileheight,animations:b.animations});c.x=this.x;c.y=this.y;c.centerX=this.centerX;c.centerY=this.centerY;c.play(this.currentFrame);c.alpha=this.alpha;c.visible=this.visible;return c}},{key:"play",value:function e(b){var c=this;var d=a(this);if(d.animationTimer){clearInterval(d.animationTimer);d.animationTimer=null}if(Number.isInteger(b)){d.currentFrame=b;this.emit("change")}else if(typeof b=="string"){var e=function(){var a=d.animations[b];if(!a){console.error(a,d.animations,b);throw new Error("Sprite.Sheet.play invalid animation")}if(Number.isFinite(a)){d.currentAnimation=b;return{v:c.play(a)}}var e=null;var f=null;var g=null;var h=null;if(a instanceof Array){e=a[0];f=a[1];g=a[2];h=a[3]}else if(a.frames&&a.frames instanceof Array){e=a.frames[0];f=a.frames[a.frames.length-1];g=a.next;h=a.speed}if(!Number.isFinite(e)||e<0||e>=d.frameCount||!Number.isFinite(f)||f<0||f>=d.frameCount||!Number.isFinite(h)||h<=0){console.error(e,f,h,c);throw new Error("Sprite.Sheet.play Invalid animation data")}d.currentAnimation=b;d.currentFrame=e;c.emit("change");d.animationTimer=setInterval(function(){d.currentFrame++;if(d.currentFrame>f){clearInterval(d.animationTimer);d.animationTimer=null;if(g&&g.length&&d.animations[g]){c.play(g)}else{d.currentFrame--}c.emit("animationend")}c.emit("change")},h)}();if(typeof e==="object")return e.v}else{console.error(b,a(this).animations,this);throw new Error("Sprite.Sheet.play has an invalid argument")}}},{key:"getFrame",value:function f(b){var c=a(this);if(!Number.isInteger(b)){b=c.currentFrame}if(b<0||b>=c.frameCount){console.error(b,c,this);throw new Error("Sprite.Sheet.getFrame index out of range")}var d=null;var e=true;var f=false;var g=undefined;try{for(var h=c.images[Symbol.iterator](),i;!(e=(i=h.next()).done);e=true){var j=i.value;var k=Math.floor(j.width/c.tilewidth);var l=Math.floor(j.height/c.tileheight);if(b<k*l){var m=Math.floor(b/k);var n=b-k*m;d=new Sprite.Frame(j,n*c.tilewidth,m*c.tileheight,c.tilewidth,c.tileheight);d.parent=this;break}b-=k*l}}catch(o){f=true;g=o}finally{try{if(!e&&h["return"]){h["return"]()}}finally{if(f){throw g}}}if(!d){console.error(b,c,this);throw new Error("Sprite.Sheet.getFrame unknown error")}return d}},{key:"draw",value:function g(b){if(this.visible==false||this.alpha<=.01){return}var c=a(this);var d=this.getFrame(this.currentFrame);if(!d||!d.image){console.error(d,this.currentFrame,this);throw new Error("Sprite.Sheet.draw invalid frame")}d.draw(b)}},{key:"paused",get:function h(){var b=a(this);if(b.animationTimer){return false}return true},set:function i(a){throw new Error("Sprite.Sheet.paused readonly")}},{key:"currentFrame",get:function j(){var b=a(this);return b.currentFrame},set:function k(a){throw new Error("Sprite.Sheet.currentFrame readonly")}},{key:"currentAnimation",get:function l(){var b=a(this);return b.currentAnimation},set:function m(a){throw new Error("Sprite.Sheet.currentAnimation readonly")}}]);return c}(Sprite.Display))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";var a={tab:9,enter:13,shift:16,esc:27,space:32,left:37,up:38,right:39,down:40,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122};var b=new Map;window.addEventListener("keydown",function(a){a=a||window.event;var c=a.keyCode;b.set(c,true)});window.addEventListener("keyup",function(a){a=a||window.event;var c=a.keyCode;if(b.has(c)){b["delete"](c)}});Sprite.assign("Input",function(){function c(){_classCallCheck(this,c)}_createClass(c,null,[{key:"isPressed",value:function d(c){if(Number.isFinite(c)){if(b.has(c)){return true}return false}else if(typeof c=="string"){c=a[c];if(b.has(c)){return true}return false}else{console.error(c);throw new Error("Sprite.Input.isPressed got invalid argument")}}},{key:"whenPress",value:function e(b,c){if(c){window.addEventListener("keypress",function(d){d=d||window.event;var e=d.keyCode;var f=true;var g=false;var h=undefined;try{for(var i=b[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;var l=a[k];if(l&&l==e){c(k)}}}catch(m){g=true;h=m}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}})}else{console.error(c);throw new Error("Sprite.Input.whenPress got invalid arguments")}}},{key:"whenDown",value:function f(b,c){if(c){window.addEventListener("keydown",function(d){d=d||window.event;var e=d.keyCode;var f=true;var g=false;var h=undefined;try{for(var i=b[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;var l=a[k];if(l&&l==e){c(k)}}}catch(m){g=true;h=m}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}})}else{console.error(c);throw new Error("Sprite.Input.whenDown got invalid arguments")}}},{key:"whenUp",value:function g(b,c){if(c){window.addEventListener("keyup",function(d){d=d||window.event;var e=d.keyCode;var f=true;var g=false;var h=undefined;try{for(var i=b[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;var l=a[k];if(l&&l==e){c(k)}}}catch(m){g=true;h=m}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}})}else{console.error(c);throw new Error("Sprite.Input.whenUp got invalid arguments")}}}]);return c}())})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function j(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Shape",function(b){_inherits(c,b);function c(){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var b=a(this);b.children=[];this.width=0;this.height=0;b.image=null}_createClass(c,[{key:"clone",value:function d(){var b=a(this);var c=new Sprite.Shape;a(c).children=b.children.slice();a(c).image=b.image;c.width=this.width;c.height=this.height;c.x=this.x;c.y=this.y;c.centerX=this.centerX;c.centerY=this.centerY;return c}},{key:"clear",value:function e(){var b=a(this);b.children=[];this.width=0;this.height=0;this.generate();return this}},{key:"makeConfig",value:function f(a,b){if(b){for(var c in b){a[c]=b[c]}}var d=[];for(var c in a){d.push(c+'="'+a[c]+'"')}return d.join(" ")}},{key:"rect",value:function g(b){var c=a(this);var d={x:0,y:0,width:10,height:10,stroke:"black","stroke-width":1,fill:"white","fill-opacity":1,"stroke-opacity":1,opacity:1};c.children.push("<rect "+this.makeConfig(d,b)+" />");if(d.x+d.width>this.width){this.width=d.x+d.width}if(d.y+d.height>this.height){this.height=d.y+d.height}this.generate()}},{key:"circle",value:function h(b){var c=a(this);var d={cx:10,cy:10,r:10,stroke:"black","stroke-width":1,fill:"white","fill-opacity":1,"stroke-opacity":1,opacity:1};c.children.push("<circle "+this.makeConfig(d,b)+" />");if(d.cx+d.r>this.width){this.width=d.cx+d.r}if(d.cy+d.r>this.height){this.height=d.cy+d.r}this.generate()}},{key:"ellipse",value:function i(b){var c=a(this);var d={cx:10,cy:10,rx:5,ry:10,stroke:"black","stroke-width":1,fill:"white","fill-opacity":1,"stroke-opacity":1,opacity:1};c.children.push("<ellipse "+this.makeConfig(d,b)+" />");if(d.cx+d.rx>this.width){this.width=d.cx+d.rx}if(d.cy+d.ry>this.height){this.height=d.cy+d.ry}this.generate()}},{key:"line",value:function j(b){var c=a(this);var d={x1:10,y1:10,x2:20,y2:20,stroke:"black","stroke-width":1,"stroke-opacity":1,opacity:1};c.children.push("<line "+this.makeConfig(d,b)+" />");if(Math.max(d.x1,d.x2)>this.width){this.width=Math.max(d.x1,d.x2)}if(Math.max(d.y1,d.y2)>this.height){this.height=Math.max(d.y1,d.y2)}this.generate()}},{key:"polyline",value:function k(b){var c=a(this);var d={points:"20, 20, 30, 20, 30, 30, 20, 30",stroke:"black","stroke-width":1,fill:"white","fill-opacity":1,"stroke-opacity":1,opacity:1};c.children.push("<polyline "+this.makeConfig(d,b)+" />");var e=-1;d.points.split(/, /).forEach(function(a){var b=parseInt(a);if(!isNaN(b)&&b>e){e=b}});if(e!=-1&&e>this.width){this.width=e}if(e!=-1&&e>this.height){this.height=e}this.generate()}},{key:"polygon",value:function l(b){var c=a(this);var d={points:"20,20 30,20 30,30 20,30",stroke:"black","stroke-width":1,fill:"white","fill-opacity":1,"stroke-opacity":1,opacity:1};c.children.push("<polyline "+this.makeConfig(d,b)+" />");
var e=-1;var f=-1;d.points.split(/,| /).forEach(function(a,b){var c=parseInt(a);if(b%2==0){if(c>e)e=c}else{if(c>f)f=c}});if(e>0&&e>this.width)this.width=e;if(f>0&&f>this.height)this.height=f;this.generate()}},{key:"generate",value:function m(){var b=this;var c=a(this);var d='<?xml version="1.0"?>\n<svg width="'+this.width+'" height="'+this.height+'" '+('style="width: '+this.width+"px; height: "+this.height+'px;" ')+'xmlns="http://www.w3.org/2000/svg" version="1.1">\n';var e=true;var f=false;var g=undefined;try{for(var h=c.children[Symbol.iterator](),i;!(e=(i=h.next()).done);e=true){var j=i.value;d+="  "+j+"\n"}}catch(k){f=true;g=k}finally{try{if(!e&&h["return"]){h["return"]()}}finally{if(f){throw g}}}d+="</svg>";var l=new Blob([d],{type:"image/svg+xml;charset=utf-8"});var m=window.URL.createObjectURL(l);var n=new Image;n.src=m;var o=function p(){c.image=n;window.URL.revokeObjectURL(m);b.emit("change")};if(n.complete){o()}else{n.onload=o}}},{key:"draw",value:function n(b){var c=a(this);var d=c.image;if(d instanceof Image&&d.width>0&&d.height>0){this.drawImage(b,d,0,0,d.width,d.height,0,0,d.width,d.height)}}}]);return c}(Sprite.Display))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function k(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Sprite.assign("Bitmap",function(b){_inherits(c,b);function c(b){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);if(!(b instanceof Image)&&!(b.getContext&&b.getContext("2d"))){console.error(b,this);throw new Error("Sprite.Bitmap got invalid image, not Image or Canvas")}if(b.width<=0||!Number.isFinite(b.width)||b.height<=0||!Number.isFinite(b.height)){console.error(b);throw new Error("Sprite.Bitmap got invalid image, invalid width or height")}a(this).image=b}_createClass(c,[{key:"clone",value:function d(){var b=new Sprite.Bitmap(a(this).image);b.x=this.x;b.y=this.y;b.centerX=this.centerX;b.centerY=this.centerY;b.alpha=this.alpha;b.visible=this.visible;return b}},{key:"draw",value:function e(b){if(this.alpha<=.01||this.visible!=true){return}var c=a(this).image;this.drawImage(b,c,0,0,c.width,c.height)}},{key:"image",get:function f(){return a(this).image},set:function g(a){console.error(this);throw new Error("Sprite.Bitmap.image readonly")}},{key:"width",get:function h(){return a(this).image.width},set:function i(a){console.error(this);throw new Error("Sprite.Bitmap.width readonly")}},{key:"height",get:function j(){return a(this).image.height},set:function k(a){console.error(this);throw new Error("Sprite.Bitmap.height readonly")}}]);return c}(Sprite.Display))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";var a=Sprite.Namespace();var b=function(){function b(){_classCallCheck(this,b);var c=a(this);c.items={};c.skills={};c.sounds={};c.layers={};c.windows={};c.config={width:800,height:450,scale:true,fps:35};c.paused=true;c.stage=null}_createClass(b,[{key:"addBag",value:function d(a,b){return new Promise(function(d,e){var f=true;var g=false;var h=undefined;try{for(var i=c.area.bags[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;if(k.hitTest(a,b)){return d(k)}}}catch(l){g=true;h=l}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}c.Item.load("bag").then(function(e){e.x=a;e.y=b;e.inner={};e.draw();c.area.bags.add(e);d(e)})})}},{key:"assign",value:function e(a,b){Object.defineProperty(this,a,{enumerable:false,configurable:false,writable:false,value:b});return this}},{key:"start",value:function f(){a(this).paused=false}},{key:"pause",value:function g(){a(this).paused=true}},{key:"clearStage",value:function h(){if(c.area){var a=true;var b=false;var d=undefined;try{for(var e=c.area.actors[Symbol.iterator](),f;!(a=(f=e.next()).done);a=true){var g=f.value;g.erase()}}catch(h){b=true;d=h}finally{try{if(!a&&e["return"]){e["return"]()}}finally{if(b){throw d}}}var i=true;var j=false;var k=undefined;try{for(var l=c.area.bags[Symbol.iterator](),m;!(i=(m=l.next()).done);i=true){var n=m.value;n.erase()}}catch(h){j=true;k=h}finally{try{if(!i&&l["return"]){l["return"]()}}finally{if(j){throw k}}}}this.layers.mapLayer.clear();this.layers.mapHideLayer.clear();var o=true;var p=false;var q=undefined;try{for(var r=this.stage.children[Symbol.iterator](),s;!(o=(s=r.next()).done);o=true){var t=s.value;t.clear()}}catch(h){p=true;q=h}finally{try{if(!o&&r["return"]){r["return"]()}}finally{if(p){throw q}}}this.stage.releaseRenderer()}},{key:"init",value:function i(){var b=a(this);b.stage=new Sprite.Stage(b.config.width,b.config.height);b.windows.stage=c.Window.create("stage").appendChild(b.stage.canvas).show();b.layers.mapLayer=new Sprite.Container;b.layers.mapLayer.name="mapLayer";b.layers.mapHideLayer=new Sprite.Container;b.layers.mapHideLayer.name="mapHideLayer";b.layers.itemLayer=new Sprite.Container;b.layers.itemLayer.name="itemLayer";b.layers.actorLayer=new Sprite.Container;b.layers.actorLayer.name="actorLayer";b.layers.infoLayer=new Sprite.Container;b.layers.infoLayer.name="inforLayer";b.layers.skillLayer=new Sprite.Container;b.layers.skillLayer.name="skillLayer";b.layers.dialogueLayer=new Sprite.Container;b.layers.dialogueLayer.name="dialogueLayer";b.stage.appendChild(b.layers.mapLayer,b.layers.mapHideLayer,b.layers.itemLayer,b.layers.actorLayer,b.layers.infoLayer,b.layers.skillLayer,b.layers.dialogueLayer);b.stage.on("beforeDraw",function(){if(c.hero){c.layers.actorLayer.children.sort(function(a,b){if(a.y<b.y)return-1;if(a.y>b.y)return 1;return 0})}});Sprite.Ticker.on("tick",function(){if(c.paused==false){c.stage.update()}});var d=document.createElement("div");d.style.position="absolute";d.style.left="0";d.style.top="0";d.style.color="white";d.style.zIndex=999999;document.body.appendChild(d);var e=0;var f=(new Date).getTime();b.stage.on("afterDraw",function(){e++});setInterval(function(){var a=(new Date).getTime();var b=e/((a-f)/1e3);e=0;f=a;d.textContent=b.toFixed(1)},1e3);console.log("RPG Game 0.1.1 Flying!")}},{key:"paused",get:function j(){return a(this).paused},set:function k(a){throw new Error("Game.paused readonly, use Game.pause() instead")}},{key:"windows",get:function l(){return a(this).windows},set:function m(a){throw new Error("Game.windows readonly")}},{key:"config",get:function n(){return a(this).config},set:function o(a){throw new Error("Game.config readonly")}},{key:"items",get:function p(){return a(this).items},set:function q(a){throw new Error("Game.items readonly")}},{key:"skills",get:function r(){return a(this).skills},set:function s(a){throw new Error("Game.skills readonly")}},{key:"sounds",get:function t(){return a(this).sounds},set:function u(a){throw new Error("Game.sounds readonly")}},{key:"layers",get:function v(){return a(this).layers},set:function w(a){throw new Error("Game.layers readonly")}},{key:"stage",get:function x(){return a(this).stage},set:function y(a){throw new Error("Game.stage readonly")}}]);return b}();var c=window.Game=new b;if(window.require){c.config.scale=true}function d(){if(document.readyState=="complete"){c.init();c.Input.init();c.windows.main.show();return true}return false}if(d()==false){document.addEventListener("readystatechange",function(){d()})}})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function l(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();var b=new Set;var c=227;var d=document.createElement("div");d.style.width=Game.config.width+"px";d.style.height=Game.config.height+"px";d.style.position="fixed";document.body.appendChild(d);Game.assign("Window",function(f){_inherits(g,f);_createClass(g,null,[{key:"create",value:function h(a){var b=new Game.Window(a);return b}}]);function g(c){var e=this;_classCallCheck(this,g);_get(Object.getPrototypeOf(g.prototype),"constructor",this).call(this);var f=a(this);f.id=c;f.css=document.createElement("style");f.html=document.createElement("div");f.index=-1;f.html.id="GW"+Math.random().toString(16).substr(2);f.html.classList.add(c);f.html.classList.add("game-window");f.html.style.display="none";d.appendChild(f.html);document.head.appendChild(f.css);f.html.addEventListener("mousedown",function(a){var b=a.clientX;var c=a.clientY;var f=null;var g=null;var h=null;if(d.style.left){var i=d.style.left.match(/(\d+)px/);if(i){f=parseInt(i[1])}}if(d.style.top){var i=d.style.top.match(/(\d+)px/);if(i){g=parseInt(i[1])}}if(d.style.transform){var i=d.style.transform.match(/scale\(([\d\.]+), ([\d\.]+)\)/);if(i){h=parseFloat(i[1])}else{h=1}}else{h=1}if(Number.isFinite(f)&&Number.isFinite(g)&&Number.isFinite(h)){b-=f;c-=g;b/=h;c/=h;e.emit("mousedown",false,{x:b,y:c})}});b.add(this)}_createClass(g,[{key:"destroy",value:function i(){var c=a(this);if(this.showing){this.hide()}if(c.html){c.html.parentNode.removeChild(c.html);c.html=null}if(c.css){document.head.removeChild(c.css);c.css=null}if(b.has(this)){b["delete"](this)}}},{key:"whenPress",value:function j(a,b){var c=this;Sprite.Input.whenPress(a,function(a){if(c.atop){b(a)}});return this}},{key:"whenUp",value:function k(a,b){var c=this;Sprite.Input.whenUp(a,function(a){if(c.atop){b(a)}});return this}},{key:"whenDown",value:function l(a,b){var c=this;Sprite.Input.whenDown(a,function(a){if(c.atop){b(a)}});return this}},{key:"assign",value:function m(a,b){Object.defineProperty(this,a,{enumerable:false,configurable:false,writable:false,value:b});return this}},{key:"show",value:function n(){var d=a(this);e();if(this.showing==false&&d.html){this.emit("beforeShow");var f=true;var g=false;var h=undefined;try{for(var i=b[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;if(k.atop){k.emit("deactive")}}}catch(l){g=true;h=l}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}d.index=c;d.html.style.zIndex=d.index;d.html.style.display="block";c++;this.emit("afterShow");this.emit("active")}return this}},{key:"hide",value:function o(){var c=a(this);if(c.html){this.emit("beforeHide");c.index=-1;this.emit("afterHide");this.emit("deactive");if(c&&c.html){c.html.style.zIndex=c.index;c.html.style.display="none"}var d=true;var e=false;var f=undefined;try{for(var g=b[Symbol.iterator](),h;!(d=(h=g.next()).done);d=true){var i=h.value;if(i.atop){i.emit("active")}}}catch(j){e=true;f=j}finally{try{if(!d&&g["return"]){g["return"]()}}finally{if(e){throw f}}}}return this}},{key:"querySelector",value:function p(b){var c=a(this);return document.querySelector("#"+c.html.id+" "+b)}},{key:"querySelectorAll",value:function q(b){var c=a(this);return document.querySelectorAll("#"+c.html.id+" "+b)}},{key:"appendChild",value:function r(b){a(this).html.appendChild(b);return this}},{key:"removeChild",value:function s(b){a(this).html.removeChild(b);return this}},{key:"index",get:function t(){var b=a(this);return b.index},set:function u(a){console.error(this);throw new Error("Game.Window.index readonly")}},{key:"showing",get:function v(){var b=a(this);if(b.html&&b.html.style.display!="none"){return true}return false},set:function w(a){throw new Error("Game.Window.showing readonly")}},{key:"atop",get:function x(){var a=true;var c=false;var d=undefined;try{for(var e=b[Symbol.iterator](),f;!(a=(f=e.next()).done);a=true){var g=f.value;if(g.showing&&g.index>this.index){return false}}}catch(h){c=true;d=h}finally{try{if(!a&&e["return"]){e["return"]()}}finally{if(c){throw d}}}return true},set:function y(a){throw new Error("Game.Window.atop readonly")}},{key:"html",get:function z(){return a(this).html.innerHTML},set:function A(b){a(this).html.innerHTML=b}},{key:"css",get:function B(){return a(this).css.innerHTML},set:function C(b){a(this).css.innerHTML=b}}]);return g}(Sprite.Event));function e(){var a=window.innerWidth;var b=window.innerHeight;var c=1;var e=0;var f=0;var g=false;if(Game.config.scale==false){e=Math.floor((a-Game.config.width)/2);f=Math.floor((b-Game.config.height)/2)}else{var h=Game.config.width/Game.config.height;var i=a;var j=i/h;if(j>b){j=b;i=j*h}i=Math.floor(i);j=Math.floor(j);e=Math.floor((a-i)/2);f=Math.floor((b-j)/2);c=Math.min(i/Game.config.width,j/Game.config.height)}var k=d.style;k.left=e+"px";k.top=f+"px";k.transformOrigin="left top 0";k.webkitTransformOrigin="left top 0";k.transform="scale("+c+", "+c+") translateZ(0)";k.webkitTransform="scale("+c+", "+c+") translateZ(0)";k.filter="none";k.webkitFilter="blur(0px)"}e();window.addEventListener("resize",function(){e()})})();"use strict";(function(){"use strict";var a=Game.windows.archive=Game.Window.create("archiveWindow");a.html='\n    <div class="window-box">\n      <div id="archiveWindowItemBar">\n        <button id="archiveWindowClose" class="brownButton">关闭</button>\n        <button id="archiveWindowSave" class="brownButton">保存</button>\n      </div>\n      <div id="archiveWindowTable"></div>\n    </div>\n  ';a.css="\n    #archiveWindowTable {\n      width: 100%;\n      overflow-y: auto;\n      height: 320px;\n    }\n\n    .archiveWindowItem {\n      border: 1px solid gray;\n      border-radius: 10px;\n      margin: 10px 10px;\n    }\n\n    .archiveWindowItem > button {\n      width: 100px;\n      height: 40px;\n      border-radius: 5px;\n    }\n\n    #archiveWindowItemBar button {\n      width: 100px;\n      height: 30px;\n      font-size: 16px;\n      display: block;\n      margin-bottom: 5px;\n    }\n\n    #archiveWindowClose {\n      float: right;\n    }\n  ";var b=a.querySelector("button#archiveWindowSave");var c=a.querySelector("button#archiveWindowClose");var d=a.querySelector("#archiveWindowTable");b.addEventListener("click",function(){var b=document.createElement("canvas");b.width=80;b.height=45;var c=b.getContext("2d");c.drawImage(Game.stage.canvas,0,0,Game.stage.canvas.width,Game.stage.canvas.height,0,0,80,45);Game.Archive.save({hero:Game.hero.data,screenshot:b.toDataURL("image/jpeg")});a.open()});c.addEventListener("click",function(){a.hide();if(!Game.windows["interface"].showing){Game.windows.main.show()}});a.whenUp(["esc"],function(a){setTimeout(function(){c.click()},20)});a.assign("open",function(){if(Game.windows["interface"].showing&&Game.hero){b.style.visibility="visible"}else{b.style.visibility="hidden"}var a="";var c=Game.Archive.list();c.forEach(function(b){var c='<div class="archiveWindowItem">\n';var d=Game.Archive.get("SAVE_"+b);c+='  <button data-type="remove" data-id="SAVE_'+b+'" class="brownButton" style="float: right;">删除</button>\n';c+='  <button data-type="load" data-id="SAVE_'+b+'" class="brownButton" style="float: right;">读取</button>\n';c+='  <img alt="" src="'+(d.screenshot||"")+'" width="80" height="45" style="display: inline-block; margin: 5px;">\n';c+='  <label style="font-size: 20px; margin: 10px;">'+d.name+"</label>\n";c+='  <label style="margin: 10px;">'+d.date+"</label>\n";c+="</div>\n";a+=c});d.innerHTML=a;Game.windows.archive.show()});d.addEventListener("click",function(b){var c=b.target.getAttribute("data-type");var d=b.target.getAttribute("data-id");if(c&&d){if(c=="remove"){Game.Archive.remove(d);a.open()}else if(c=="load"){Game.Archive.load(d);a.hide()}}})})();"use strict";(function(){"use strict";var a=Game.windows.buy=Game.Window.create("buyWindow");a.html='\n  <div class="window-box">\n    <div id="buyWindowItemBar">\n\n      <button id="buyWindowClose" class="brownButton">关闭</button>\n      <button id="buyWindowSell" class="brownButton">卖出</button>\n\n      <button id="buyWindowAll" class="brownButton">全部</button>\n      <button id="buyWindowWeapon" class="brownButton">武器</button>\n      <button id="buyWindowArmor" class="brownButton">护甲</button>\n      <button id="buyWindowPotion" class="brownButton">药水</button>\n      <button id="buyWindowMaterial" class="brownButton">材料</button>\n      <button id="buyWindowBook" class="brownButton">书籍</button>\n      <button id="buyWindowMisc" class="brownButton">其他</button>\n    </div>\n\n    <span id="buyWindowGold"></span>\n\n    <div style="overflow: auto; height: 300px;">\n      <table border="0">\n        <thead>\n          <tr>\n            <td style="width: 40px;"></td>\n            <td style="width: 120px;"></td>\n            <td style="width: 30px;"></td>\n            <td style="width: 30px;"></td>\n            <td></td>\n            <td style="width: 60px;"></td>\n          </tr>\n        </thead>\n        <tbody id="buyWindowTable"></tbody>\n      </table>\n    </div>\n  </div>\n  ';a.css="\n\n    #buyWindowTable tr:nth-child(odd) {\n      background-color: rgba(192, 192, 192, 0.6);\n    }\n\n    #buyWindowItemBar > button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n      margin-left: 5px;\n      margin-right: 5px;\n      margin-top: 0px;\n      margin-bottom: 5px;\n    }\n\n    #buyWindowClose {\n      float: right;\n    }\n\n    #buyWindowStatus {\n      float: right;\n    }\n\n    .buyWindow table {\n      width: 100%;\n    }\n\n    .buyWindow table button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n    }\n\n    #buyWindowGold {\n      position: absolute;\n      right: 100px;\n      bottom: 30px;\n      font-size: 20px;\n      color: black;\n    }\n  ";var b=a.querySelector("button#buyWindowClose");var c=a.querySelector("button#buyWindowSell");var d=a.querySelector("button#buyWindowAll");var e=a.querySelector("button#buyWindowWeapon");var f=a.querySelector("button#buyWindowArmor");var g=a.querySelector("button#buyWindowPotion");var h=a.querySelector("button#buyWindowMaterial");var i=a.querySelector("button#buyWindowBook");var j=a.querySelector("button#buyWindowMisc");var k=a.querySelector("span#buyWindowGold");var l=a.querySelector("#buyWindowTable");var m=null;var n=null;var o=-1;b.addEventListener("click",function(){a.hide()});c.addEventListener("click",function(){a.hide();Game.windows.sell.open(m)});a.whenUp(["tab"],function(){setTimeout(function(){a.hide();Game.windows.sell.open(m)},20)});d.addEventListener("click",function(b){a.open(m,null)});e.addEventListener("click",function(b){a.open(m,"sword|spear|bow")});f.addEventListener("click",function(b){a.open(m,"head|body|feet")});g.addEventListener("click",function(b){a.open(m,"potion")});h.addEventListener("click",function(b){a.open(m,"material")});i.addEventListener("click",function(b){a.open(m,"book|scroll|letter")});j.addEventListener("click",function(b){a.open(m,"misc")});a.assign("open",function(b,c,p){if(typeof p=="undefined"){p=-1}m=b;n=c;o=p;k.textContent=Game.hero.data.gold+"G";var q="white";var r="yellow";d.style.color=q;e.style.color=q;f.style.color=q;g.style.color=q;h.style.color=q;i.style.color=q;j.style.color=q;if(c==null){d.style.color=r}else if(c.match(/sword/)){e.style.color=r}else if(c.match(/head/)){f.style.color=r}else if(c.match(/potion/)){g.style.color=r}else if(c.match(/material/)){h.style.color=r}else if(c.match(/book/)){i.style.color=r}else if(c.match(/misc/)){j.style.color=r}var s=0;var t="";Sprite.each(b,function(a,d){var e=Game.items[d];if(c&&c.indexOf(e.data.type)==-1)return;var f="";if(p==s){f+='<tr style="background-color: green;">\n'}else{f+="<tr>\n"}if(e.icon){f+='  <td style="text-align: center;"><img alt="" src="'+e.icon.src+'"></td>\n'}else{f+="  <td> </td>\n"}f+="  <td>"+e.data.name+"</td>\n";f+='  <td style="text-align: center;">'+Math.ceil(e.data.value*1.2)+"G</td>\n";f+='  <td style="text-align: center;">'+a+"</td>\n";f+="  <td>"+e.data.description+"</td>\n";if(Math.ceil(e.data.value*1.2)>Game.hero.data.gold||b[d]<=0){f+='  <td><button disabled style="Opacity: 0.5;" class="brownButton">买入</button></td>\n'}else{f+='  <td><button data-id="'+d+'" class="brownButton">买入</button></td>\n'}f+="</tr>\n";t+=f;s++});l.innerHTML=t;a.show()});a.whenUp(["enter"],function(){var a=l.querySelectorAll("button");if(o>=0&&o<a.length){a[o].click()}});a.whenUp(["up","down"],function(b){var c=l.querySelectorAll("button").length;if(c<=0)return;if(o==-1){if(b=="down"){a.open(m,n,0)}else if(b=="up"){a.open(m,n,c-1)}}else{if(b=="down"){var d=o+1;if(d>=c){d=0}a.open(m,n,d)}else if(b=="up"){var d=o-1;if(d<0){d=c-1}a.open(m,n,d)}}});a.whenUp(["esc"],function(){setTimeout(function(){a.hide()},20)});a.whenUp(["left","right"],function(b){if(b=="right"){var c=n;if(c==null){c="sword|spear|bow"}else if(c.match(/sword/)){c="head|body|feet"}else if(c.match(/head/)){c="potion"}else if(c.match(/potion/)){c="material"}else if(c.match(/material/)){c="book|scroll|letter"}else if(c.match(/book/)){c="misc"}else if(c.match(/misc/)){c=null}a.open(m,c)}else if(b=="left"){var c=n;if(c==null){c="misc"}else if(c.match(/sword/)){c=null}else if(c.match(/head/)){c="sword|spear|bow"}else if(c.match(/potion/)){c="head|body|feet"}else if(c.match(/material/)){c="potion"}else if(c.match(/book/)){c="material"}else if(c.match(/misc/)){c="book|scroll|letter"}a.open(m,c)}});l.addEventListener("click",function(b){var c=b.target.getAttribute("data-id");if(c&&m.hasOwnProperty(c)){var d=Game.items[c];Game.hero.data.gold-=Math.ceil(d.data.value*1.2);if(Game.hero.data.items[c]){Game.hero.data.items[c]++}else{Game.hero.data.items[c]=1}m[c]--;if(m[c]==0){delete m[c]}a.open(m,n)}})})();"use strict";(function(){"use strict";var a='\n    <div class="window-box">\n      <button id="choiceWindowNo" class="brownButton">取消</button>\n      <div style="width: 100%; height: 100%;">\n        <div style="height: 370px; overflow-y: auto; text-align: center;">\n          <table id="choiceWindowTable" style="width: 100%; height: 370px;">\n            <tbody>\n              <tr>\n                <td id="choiceWindowButtonContainer">\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  ';var b="\n    .choiceWindow {\n      text-align: center;\n    }\n\n    .choiceWindow div {\n      text-align: center;\n    }\n\n    button#choiceWindowNo {\n      position: absolute;\n      right: 100px;\n      top: 50px;\n      width: 100px;\n      height: 60px;\n      font-size: 30px;\n    }\n\n    #choiceWindowTable button {\n      margin: 5px auto;\n      min-width: 300px;\n      min-height: 60px;\n      font-size: 30px;\n      display: block;\n    }\n  ";Game.choice=function(c){return new Promise(function(d,e){var f=Game.Window.create("choiceWindow");f.html=a;f.css=b;f.show();var g=f.querySelector("#choiceWindowButtonContainer");var h=f.querySelector("#choiceWindowNo");var i=[];Sprite.each(c,function(a,b){var c=document.createElement("button");c.textContent=i.length+1+". "+b;c.classList.add("brownButton");g.appendChild(c);i.push(c);c.addEventListener("click",function(){f.hide();f.destroy();d(a)})});h.addEventListener("click",function(){f.hide();f.destroy();d(null)});f.whenUp(["esc"],function(){setTimeout(function(){h.click()},20)});f.whenUp(["1","2","3","4","5","6","7","8","9"],function(a){var b=parseInt(a)-1;var c=i[b];if(c){c.click()}})})}})();"use strict";(function(){"use strict";var a=Sprite.Namespace();var b='\n  <div class="window-box">\n    <div style="width: 100%; height: 100%;">\n      <table>\n        <tr><td><span id="confirmWindowMessage"></span></td></tr>\n        <tr><td>\n          <button id="confirmWindowYes" class="brownButton">确定</button>\n          <button id="confirmWindowNo" class="brownButton">取消</button>\n        </td></tr>\n      </table>\n    </div>\n  </div>\n  ';var c="\n    .confirmWindow {\n      text-align: center;\n    }\n\n    .confirmWindow table {\n      width: 100%;\n      height: 100%;\n    }\n\n    .confirmWindow span {\n      font-size: 16px;\n    }\n\n    .confirmWindow button {\n      width: 100px;\n      height: 60px;\n      font-size: 16px;\n      margin: 20px;\n    }\n\n    #confirmWindowMessage {\n      color: black;\n      font-size: 20px;\n    }\n  ";Game.assign("confirm",function(a){return new Promise(function(d,e){var f=Game.Window.create("confirmWindow");f.html=b;f.css=c;f.show();var g=f.querySelector("#confirmWindowMessage");var h=f.querySelector("#confirmWindowYes");var i=f.querySelector("#confirmWindowNo");if(typeof a=="string"){g.textContent=a}else if(a.message){g.textContent=a.message;if(a.yes){h.textContent=a.yes}if(a.no){i.textContent=a.no}}else{throw new Error("Game.confirm got invalid arguments")}f.whenUp(["esc"],function(){setTimeout(function(){i.click()},20)});f.whenUp(["y","Y"],function(){h.click()});f.whenUp(["n","N"],function(){i.click()});h.addEventListener("click",function(){f.destroy();d()});i.addEventListener("click",function(){f.destroy();e()})})})})();"use strict";(function(){"use strict";var a=Game.windows.dialogue=Game.Window.create("dialogueWindow");a.html='\n    <div class="window-box">\n      <div style="width: 100%; height: 100%;">\n        <span id="dialogueWindowSpeaker"></span>\n        <table><tbody><tr><td>\n          <div id="dialogueWindowContent"></div>\n        </td></tr></tbody></table>\n        <button id="dialogueWindowNext" style="display: block;" class="brownButton">继续</button>\n        <button id="dialogueWindowClose" style="display: none;" class="brownButton">结束</button>\n      </div>\n    </div>\n  ';a.css="\n    .dialogueWindow table, dialogueWindow.tbody, dialogueWindow tr, dialogueWindow td {\n      margin: 0;\n      padding: 0;\n      width: 100%;\n      height: 100%;\n      text-align: center;\n    }\n\n    #dialogueWindowSpeaker {\n      position: absolute;\n      left: 50px;\n      top: 50px;\n      font-size: 30px;\n      font-weight: bold;\n    }\n\n    .dialogueWindow button {\n      width: 120px;\n      height: 60px;\n      font-size: 16px;\n      position: absolute;\n    }\n\n    #dialogueWindowNext {\n      bottom: 50px;\n      right: 100px;\n    }\n\n    #dialogueWindowClose {\n      bottom: 50px;\n      right: 100px;\n    }\n\n    #dialogueWindowContent {\n      margin-left: 50px;\n      margin-right: 50px;\n      max-width: 600px;\n      font-size: 24px;\n      text-align: center;\n    }\n  ";var b=a.querySelector("#dialogueWindowSpeaker");var c=[];var d=0;var e=document.getElementById("dialogueWindowNext");var f=document.getElementById("dialogueWindowClose");var g=document.getElementById("dialogueWindowContent");e.addEventListener("click",function(){h()});f.addEventListener("click",function(){setTimeout(function(){Game.windows.dialogue.hide();c=[];d=0},20)});Game.dialogue=function(a,g){e.style.display="block";f.style.display="none";if(g&&g.length){b.textContent=g+"："}else{b.textContent=""}c=a;d=0;h();Game.windows.dialogue.show()};function h(){g.textContent=c[d];d++;if(d>=c.length){e.style.display="none";f.style.display="block"}}a.whenUp(["enter","space","esc"],function(){if(Game.windows.dialogue.showing){if(e.style.display!="none"){e.click()}else if(f.style.display!="none"){f.click()}}})})();"use strict";(function(){"use strict";var a=Game.windows["interface"]=Game.Window.create("interfaceWindow");a.html='\n    <div id="interfaceWindowBar"></div>\n\n    <div style="position: absolute; bottom: 10px; left: 20px; width: 100px; height: 60px;">\n      <div style="width: 100px; height: 20px; margin: 5px 0; border: 1px solid gray; background-color: white;">\n        <div id="interfaceWindowHP" style="width: 100%; height: 100%; background-color: green;"></div>\n      </div>\n      <div style="width: 100px; height: 20px; margin: 5px 0; border: 1px solid gray; background-color: white;">\n        <div id="interfaceWindowSP" style="width: 100%; height: 100%; background-color: blue;"></div>\n      </div>\n    </div>\n\n    <span id="interfaceWindowDatetime"></span>\n    <span id="interfaceWindowMap"></span>\n\n    <button id="interfaceWindowUse" class="interfaceWindowButton"></button>\n    <button id="interfaceWindowMenu" class="interfaceWindowButton"></button>\n  ';a.css='\n\n    #interfaceWindowBar {\n      text-align: center;\n      position: absolute;\n      bottom: 10px;\n      width: 100%;\n      height: 60px;\n    }\n\n    .interfaceWindow {\n      /** 让interface窗口的主要窗口，不接受事件 */\n      pointer-events: none;\n    }\n\n    button.interfaceWindowButton {\n      margin-left: 3px;\n      margin-right: 3px;\n      width: 60px;\n      height: 60px;\n      border: 4px solid gray;\n      border-radius: 10px;\n      background-color: rgba(100, 100, 100, 0.5);\n      display: inline-block;\n      /** 让interface窗口的按钮，接受事件 */\n      pointer-events: auto;\n      background-repeat: no-repeat;\n      background-size: cover;\n    }\n\n    button.interfaceWindowButton:hover {\n      opacity: 0.5;\n    }\n\n    button.interfaceWindowButton > img {\n      width: 100%;\n      height: 100%;\n    }\n\n    #interfaceWindowMap {\n      position: absolute;\n      top: 35px;\n      left: 5px;\n      background-color: rgba(100, 100, 100, 0.7);\n      padding: 2px;\n    }\n\n    #interfaceWindowDatetime {\n      position: absolute;\n      top: 10px;\n      left: 5px;\n      background-color: rgba(100, 100, 100, 0.7);\n      padding: 2px;\n    }\n\n    button#interfaceWindowUse {\n      position: absolute;\n      top: 5px;\n      right: 85px;\n      visibility: hidden;\n      background-image: url("image/hint.png");\n    }\n\n    button#interfaceWindowMenu {\n      position: absolute;\n      top: 5px;\n      right: 5px;\n      background-image: url("image/setting.png");\n    }\n\n    interfaceWindowButton:disabled {\n      cursor: default;\n      pointer-events: none;\n      background-color: gray;\n      opacity: 0.5;\n    }\n\n    .interfaceWindowButtonText {\n      position: absolute;\n      background-color: white;\n      margin-left: -26px;\n      margin-top: 12px;\n    }\n  ';var b=a.querySelector("button#interfaceWindowUse");var c=a.querySelector("div#interfaceWindowBar");var d=a.querySelector("#interfaceWindowMap");var e=a.querySelector("button#interfaceWindowMenu");var f=a.querySelector("#interfaceWindowHP");var g=a.querySelector("#interfaceWindowSP");a.assign("hideUse",function(){
b.style.visibility="hidden"});a.assign("showUse",function(){b.style.visibility="visible"});a.on("active",function(){Game.start()});a.on("deactive",function(){Game.pause()});a.whenUp(["esc"],function(a){if(Game.windows["interface"].atop){setTimeout(function(){e.click()},20)}});function h(){var a=8;var b="";for(var d=0;d<a;d++){var e="";e+='<button data-index="'+d+'" class="interfaceWindowButton">';e+='<label data-index="'+d+'" class="interfaceWindowButtonText"></label>';e+="</button>\n";b+=e}c.innerHTML=b}setInterval(function(){if(Game.hero&&Game.paused==false){Game.hero.data.time++;Game.windows["interface"].datetime()}},1e3);h();var i=a.querySelectorAll(".interfaceWindowButton");var j=a.querySelectorAll(".interfaceWindowButtonText");c.addEventListener("click",function(a){var b=a.target.getAttribute("data-index");if(b){var c=Game.hero.data.bar[b];if(c){if(c.type=="skill"){var d=Game.hero.fire(c.id);if(d){a.target.disabled=true;setTimeout(function(){a.target.disabled=false},d)}}else if(c.type=="item"){var e=c.id;var f=Game.items[e];f.heroUse();Game.windows["interface"].refresh()}}}});a.whenUp(["1","2","3","4","5","6","7","8"],function(a){var b=parseInt(a);if(Number.isInteger(b)&&b>=0&&b<i.length){i[b-1].click()}});a.whenUp(["e","E","space","enter"],function(a){if(Game.windows["interface"].showing){if(Game.hintObject&&Game.hintObject.heroUse){Game.hintObject.heroUse()}}});b.addEventListener("click",function(a){if(Game.hintObject&&Game.hintObject.heroUse){Game.hintObject.heroUse()}});a.assign("status",function(){if(Game.hero){var a=Game.hero.data.hp/Game.hero.data.$hp;var b=Game.hero.data.sp/Game.hero.data.$sp;f.style.width=a*100+"%";g.style.width=b*100+"%";if(a>=.5){f.style.backgroundColor="green"}else if(a>=.25){f.style.backgroundColor="yellow"}else{f.style.backgroundColor="red"}}});a.assign("datetime",function(){if(Game.hero&&Game.hero.data&&Number.isInteger(Game.hero.data.time)){var b=60*24*30*12;var c=60*24*30;var d=60*24;var e=60;var f=a.querySelector("#interfaceWindowDatetime");var g=Game.hero.data.time;var h=Math.floor(g/b);g=g%b;var i=Math.floor(g/c);g=g%c;var j=Math.floor(g/d);g=g%d;var k=Math.floor(g/e);g=g%e;var l=g;h++;i++;j++;k=k.toString();while(k.length<2)k="0"+k;l=l.toString();while(l.length<2)l="0"+l;f.textContent=i+"月"+j+"日 "+k+":"+l;var m=Game.area.map.data.type;if(m=="indoor"){Game.stage.filter("brightness",0)}else if(m=="outdoor"){if(k>=20||k<4){Game.stage.filter("brightness",-.15)}else if(k>=4&&k<6){Game.stage.filter("brightness",-.1)}else if(k>=6&&k<8){Game.stage.filter("brightness",-.05)}else if(k>=8&&k<10){Game.stage.filter("brightness",0)}else if(k>=10&&k<12){Game.stage.filter("brightness",.05)}else if(k>=12&&k<14){Game.stage.filter("brightness",0)}else if(k>=14&&k<16){Game.stage.filter("brightness",0)}else if(k>=16&&k<18){Game.stage.filter("brightness",-.05)}else if(k>=18&&k<20){Game.stage.filter("brightness",-.1)}}else if(m=="cave"){Game.stage.filter("brightness",-.15)}}});a.assign("refresh",function(){for(var a=0;a<8;a++){var b=Game.hero.data.bar[a];var c=i[a];var e=j[a];c.disabled=false;e.disabled=false;if(b){var f=b.id;var g=b.type;if(g=="skill"){var h=Game.skills[f];c.style.backgroundImage='url("'+h.icon.src+'")';e.textContent=h.data.cost}else if(g=="item"){var k=Game.items[f];c.style.backgroundImage='url("'+k.icon.src+'")';if(Game.hero.data.items[f]){e.textContent=Game.hero.data.items[f]}else{e.textContent="0";c.disabled=true;e.disabled=true}}}else{e.textContent="";c.style.backgroundImage=""}}d.textContent=Game.area.map.data.name});e.addEventListener("click",function(a){Game.windows.sysmenu.show()})})();"use strict";(function(){"use strict";var a=Game.windows.inventory=Game.Window.create("inventoryWindow");a.html='\n    <div class="window-box">\n      <div id="inventoryWindowItemBar">\n\n        <button id="inventoryWindowClose" class="brownButton">关闭</button>\n        <button id="inventoryWindowStatus" class="brownButton">状态</button>\n\n        <button id="inventoryWindowAll" class="brownButton">全部</button>\n        <button id="inventoryWindowWeapon" class="brownButton">武器</button>\n        <button id="inventoryWindowArmor" class="brownButton">护甲</button>\n        <button id="inventoryWindowPotion" class="brownButton">药水</button>\n        <button id="inventoryWindowMaterial" class="brownButton">材料</button>\n        <button id="inventoryWindowBook" class="brownButton">书籍</button>\n        <button id="inventoryWindowMisc" class="brownButton">其他</button>\n      </div>\n\n      <span id="inventoryWindowGold"></span>\n\n      <div style="overflow: auto; height: 310px;">\n        <table border="0">\n          <thead>\n            <tr>\n              <td style="width: 40px; text-align: center;"></td>\n              <td style="width: 120px;"></td>\n              <td style="width: 30px;"></td>\n              <td style="width: 30px;"></td>\n              <td></td>\n              <td style="width: 60px;"></td>\n            </tr>\n          </thead>\n          <tbody id="inventoryWindowTable"></tbody>\n        </table>\n      </div>\n    </div>\n  ';a.css="\n\n    #inventoryWindowItemBar {\n      height: 50px;\n    }\n\n    #inventoryWindowItemBar > button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n      margin-left: 5px;\n      margin-right: 5px;\n      margin-top: 0px;\n      margin-bottom: 5px;\n    }\n\n    #inventoryWindowClose {\n      float: right;\n    }\n\n    #inventoryWindowStatus {\n      float: right;\n    }\n\n    .inventoryWindow table {\n      width: 100%;\n    }\n\n    .inventoryWindow table button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n    }\n\n    #inventoryWindowTable tr:nth-child(odd) {\n      background-color: rgba(192, 192, 192, 0.6);\n    }\n\n    #inventoryWindowGold {\n      position: absolute;\n      right: 100px;\n      bottom: 10px;\n      font-size: 20px;\n      color: black;\n      font-weight: bold;\n    }\n  ";var b=a.querySelector("button#inventoryWindowClose");var c=a.querySelector("button#inventoryWindowStatus");var d=a.querySelector("button#inventoryWindowAll");var e=a.querySelector("button#inventoryWindowWeapon");var f=a.querySelector("button#inventoryWindowArmor");var g=a.querySelector("button#inventoryWindowPotion");var h=a.querySelector("button#inventoryWindowMaterial");var i=a.querySelector("button#inventoryWindowBook");var j=a.querySelector("button#inventoryWindowMisc");var k=a.querySelector("span#inventoryWindowGold");var l=a.querySelector("#inventoryWindowTable");b.addEventListener("click",function(b){a.hide()});c.addEventListener("click",function(b){a.hide();Game.windows.status.open()});a.whenUp(["tab"],function(){setTimeout(function(){a.hide();Game.windows.status.open()},20)});d.addEventListener("click",function(b){a.open()});e.addEventListener("click",function(b){a.open("sword|spear|bow")});f.addEventListener("click",function(b){a.open("head|body|feet")});g.addEventListener("click",function(b){a.open("potion")});h.addEventListener("click",function(b){a.open("material")});i.addEventListener("click",function(b){a.open("book|scroll|letter")});j.addEventListener("click",function(b){a.open("misc")});var m=null;var n=-1;a.assign("open",function(b,c){if(typeof c=="undefined"){c=-1}m=b;n=c;var o="white";var p="yellow";d.style.color=o;e.style.color=o;f.style.color=o;g.style.color=o;h.style.color=o;i.style.color=o;j.style.color=o;if(b==null){d.style.color=p}else if(b.match(/sword/)){e.style.color=p}else if(b.match(/head/)){f.style.color=p}else if(b.match(/potion/)){g.style.color=p}else if(b.match(/material/)){h.style.color=p}else if(b.match(/book/)){i.style.color=p}else if(b.match(/misc/)){j.style.color=p}k.textContent=Game.hero.data.gold+"G";var q="";var r=0;var s=Object.keys(Game.hero.data.items);s.sort();s.forEach(function(a){var d=Game.hero.data.items[a];var e=Game.items[a];var f=null;Sprite.each(Game.hero.data.equipment,function(a,b){if(a==e.id)f=b});if(b&&b.indexOf(e.data.type)==-1)return;var g="";if(c==r){g+='<tr style="background-color: green;">\n'}else{g+="<tr>\n"}if(e.icon){g+='  <td style="text-align: center;"><img alt="" src="'+e.icon.src+'"></td>\n'}else{g+="  <td> </td>\n"}g+="  <td>"+(f?"*":"")+e.data.name+"</td>\n";g+='  <td style="text-align: center;">'+e.data.value+"G</td>\n";g+='  <td style="text-align: center;">'+d+"</td>\n";g+="  <td>"+e.data.description+"</td>\n";g+='  <td><button data-id="'+a+'" class="brownButton">操作</button></td>\n';g+="</tr>\n";q+=g;r++});l.innerHTML=q;a.show()});a.whenUp(["enter"],function(){var a=l.querySelectorAll("button");if(n>=0&&n<a.length){a[n].click()}});a.whenUp(["up","down"],function(b){var c=l.querySelectorAll("button").length;if(n==-1){if(b=="down"){a.open(m,0)}else if(b=="up"){a.open(m,c-1)}}else{if(b=="down"){var d=n+1;if(d>=c){d=0}a.open(m,d)}else if(b=="up"){var d=n-1;if(d<0){d=c-1}a.open(m,d)}}});l.addEventListener("click",function(b){var c=b.target.getAttribute("data-id");if(c&&Game.hero.data.items.hasOwnProperty(c)){(function(){var b=Game.items[c];var d=Game.hero.data.items[c];var e=null;Sprite.each(Game.hero.data.equipment,function(a,c){if(a==b.id)e=c});var f={};if(b.data.type.match(/potion/)){f["使用"]="use";f["快捷键"]="shortcut"}else if(b.data.type.match(/sword|spear|bow|head|body|feet|neck|ring/)){if(e)f["卸下"]="takeoff";else f["装备"]="puton"}else if(b.data.type.match(/book/)){f["阅读"]="read"}f["丢弃"]="drop";Game.choice(f).then(function(f){switch(f){case"puton":var g=b.data.type;if(g.match(/sword|spear|bow/)){g="weapon"}Game.hero.data.equipment[g]=b.id;return a.open(m);break;case"takeoff":if(b.data.type.match(/sword|spear|bow/))Game.hero.data.equipment.weapon=null;else Game.hero.data.equipment[b.data.type]=null;return a.open(m);break;case"use":if(b.heroUse){b.heroUse()}break;case"read":if(b.heroUse){b.heroUse()}break;case"drop":if(e){Game.hero.data.equipment[e]=null}Game.addBag(Game.hero.x,Game.hero.y).then(function(a){if(a.inner.hasOwnProperty(c)){a.inner[c]+=d}else{a.inner[c]=d}});delete Game.hero.data.items[c];Game.hero.data.bar.forEach(function(a,b,d){if(a&&a.id==c){d[b]=null}});Game.windows["interface"].refresh();return a.open(m);break;case"shortcut":Game.choice({1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7},function(a){if(Number.isFinite(a)&&a>=0){Game.hero.data.bar[a]={id:b.id,type:"item"};Game.windows["interface"].refresh()}});break}})})()}});a.whenUp(["esc"],function(){setTimeout(function(){a.hide()},20)});a.whenUp(["left","right"],function(b){if(b=="right"){var c=m;if(c==null){c="sword|spear|bow"}else if(c.match(/sword/)){c="head|body|feet"}else if(c.match(/head/)){c="potion"}else if(c.match(/potion/)){c="material"}else if(c.match(/material/)){c="book|scroll|letter"}else if(c.match(/book/)){c="misc"}else if(c.match(/misc/)){c=null}a.open(c,-1)}else if(b=="left"){var c=m;if(c==null){c="misc"}else if(c.match(/sword/)){c=null}else if(c.match(/head/)){c="sword|spear|bow"}else if(c.match(/potion/)){c="head|body|feet"}else if(c.match(/material/)){c="potion"}else if(c.match(/book/)){c="material"}else if(c.match(/misc/)){c="book|scroll|letter"}a.open(c,-1)}})})();"use strict";(function(){"use strict";var a="data:image/svg+xml;base64,"+window.btoa('\n  <svg id="loadingIcon" width="100" height="100" xmlns="http://www.w3.org/2000/svg">\n    <circle cx="50" cy="50" r="50" fill="#808080" />\n    <path d="M50,50 h-40 a40,40 0 1,0 40,-40 z" fill="white" />\n    <path d="M49,49 h-30 a30,30 0 1,0 30,-30 z" fill="#808080" />\n  </svg>');var b=Game.windows.loading=Game.Window.create("loadingWindow");b.html='\n    <div id="loadingWindowBox">\n      <img id="loadingWindowLoadingIcon" src="'+a+'" alt="loading">\n      <br>\n      <label>请稍等...<small id="loadingWindowProgress"></small></label>\n      <br>\n      <h5 id="loadingWindowText"></h5>\n    </div>\n  ';b.css="\n    .loadingWindow {\n      text-align: center;\n    }\n\n    #loadingWindowLoadingIcon {\n      width: 50px;\n      height: 50px;\n      margin-top: 15px;\n      margin-bottom: 10px;\n      animation: loadingAnimation 1s linear infinite;\n    }\n\n    @keyframes loadingAnimation\n    {\n      0%   { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n\n    #loadingWindowBox {\n      width: 500px;\n      height: 300px;\n      border-radius: 25px;\n      position: fixed;\n      top: 75px;\n      left: 150px;\n      background-color: gray;\n    }\n\n    .loadingWindow label {\n      color: white;\n      font-size: 48px;\n    }\n\n    #loadingWindowText {\n      color: white;\n    }\n  ";var c=b.querySelector("#loadingWindowProgress");var d=b.querySelector("#loadingWindowText");var e=["打开游戏菜单之后，游戏是暂停的，你可以在这时思考下战斗策略","记得出门带着矿工锄和采药铲，或许能从其中赚点小钱","职业、信仰、技能，都可以任意改变，但是必须付出代价","你的信仰决定了神对你的祝福，还有某些人或者组织对你的看法","信仰是可以改变的，不过艾利韦斯的居民并不喜欢总是改变自己信仰的人","艾利韦斯信仰自由，没有信仰也是一种信仰，但是你享受不到任何神的祝福"];b.assign("begin",function(){c.innerHTML="";d.textContent=e[Math.floor(Math.random()*e.length)];b.show()});b.assign("update",function(a){c.innerHTML=a});b.assign("end",function(){b.hide()})})();"use strict";(function(){"use strict";var a=Game.windows.main=Game.Window.create("mainWindow");a.html='\n    <div id="mainWindowBox">\n      <h1>Elliorwis</h1>\n      <h4>艾利韦斯</h4>\n      <br>\n      <button id="mainWindowContinue" class="brownButton">继续旅程</button>\n      <br>\n      <button id="mainWindowNew" class="brownButton">新的旅程</button>\n      <br>\n      <button id="mainWindowLoad" class="brownButton">读取进度</button>\n      <br>\n    </div>\n  ';a.css="\n    #mainWindowBox {\n      text-align: center;\n      height: 412px;\n      background-color: rgba(240, 217, 194, 0.85);\n      border: 20px solid rgba(134, 93, 52, 0.85);\n    }\n\n    .mainWindow h1 {\n      font-size: 60px;\n      margin-bottom: 0;\n      text-shadow: 0 0 15px #111;\n    }\n\n    .mainWindow h4 {\n      margin-bottom: 0;\n      text-shadow: 0 0 15px #111;\n    }\n\n    .mainWindow button {\n      width: 120px;\n      height: 60px;\n      margin-top: 10px;\n    }\n  ";var b=a.querySelector("button#mainWindowContinue");var c=a.querySelector("button#mainWindowNew");var d=a.querySelector("button#mainWindowLoad");a.on("beforeShow",function(){if(!Game.Archive.last()){b.style.visibility="hidden"}else{b.style.visibility="visible"}});b.addEventListener("click",function(b){a.hide();setTimeout(function(){Game.Archive.load()},20)});c.addEventListener("click",function(b){a.hide();Game.register.reg()});d.addEventListener("click",function(b){a.hide();Game.windows.archive.open()})})();"use strict";(function(){"use strict";var a=Game.windows.map=Game.Window.create("mapWindow");a.html='\n    <div class="window-box">\n      <button id="mapWindowClose" class="brownButton">关闭</button>\n      <table><tbody><tr><td>\n        <div id="mapWindowMap"></div>\n      </td></tr></tbody></table>\n    </div>\n  ';a.css="\n    .mapWindow table, .mapWindow tbody, .mapWindow tr, .mapWindow td {\n      width: 100%;\n      height: 100%;\n      magrin: 0;\n      padding: 0;\n    }\n\n    .mapWindow {\n      text-align: center;\n    }\n\n    #mapWindowClose {\n      position: absolute;\n      right: 50px;\n      top: 50px;\n      width: 120px;\n      height: 60px;\n      font-size: 16px;\n    }\n\n    #mapWindowMap img, #mapWindowMap canvas {\n      max-width: 700px;\n      max-height: 320px;\n    }\n  ";var b=a.querySelector("#mapWindowClose");var c=a.querySelector("#mapWindowMap");b.addEventListener("click",function(a){Game.windows.map.hide()});a.whenUp(["esc"],function(a){setTimeout(function(){b.click()},20)});a.on("beforeShow",function(a){if(Game.stage&&Game.area&&Game.area.map){var b={x:Game.stage.x,y:Game.stage.y,centerX:Game.stage.centerX,centerY:Game.stage.centerY};Game.stage.x=0;Game.stage.y=0;Game.stage.centerX=0;Game.stage.centerY=0;var d=document.createElement("canvas");d.width=Game.area.map.width;d.height=Game.area.map.height;var e=d.getContext("2d");Game.stage.draw(e);var f=document.createElement("canvas");f.width=Math.floor(d.width/8);f.height=Math.floor(d.height/8);var g=f.getContext("2d");g.drawImage(d,0,0,d.width,d.height,0,0,f.width,f.height);e=null;d=null;c.innerHTML="";c.appendChild(f);Game.stage.x=b.x;Game.stage.y=b.y;Game.stage.centerX=b.centerX;Game.stage.centerY=b.centerY}})})();"use strict";(function(){"use strict";var a=Game.windows.over=Game.Window.create("overWindow");a.html='\n    <div class="window-box">\n      <button id="overWindowClose" class="brownButton">返回主菜单</button>\n      <table><tbody><tr><td>\n        <div>\n          <h1 id="overWindowMessage"></h1>\n          <h2 id="overWindowReason"></h2>\n        </div>\n      </td></tr></tbody></table>\n    </div>\n  ';a.css="\n    .overWindow table, .overWindow tbody, .overWindow tr, .overWindow td {\n      width: 100%;\n      height: 100%;\n      magrin: 0;\n      padding: 0;\n    }\n\n    .overWindow {\n      text-align: center;\n    }\n\n    #overWindowClose {\n      position: absolute;\n      right: 50px;\n      top: 50px;\n      width: 120px;\n      height: 60px;\n      font-size: 16px;\n    }\n\n    #overWindowMap img, #overWindowMap canvas {\n      max-width: 700px;\n      max-height: 320px;\n    }\n  ";var b=a.querySelector("#overWindowMessage");var c=a.querySelector("#overWindowReason");var d=["不幸的事情终于发生了……即便你的内心曾对神灵祈祷","不幸的事情终于发生了……你就知道自己今天不应该穿白色的袜子","不幸的事情终于发生了……明明还没有体验过天伦之乐","不幸的事情终于发生了……你的墓碑上写着：“下次不能随便踢小动物”","不幸的事情终于发生了……你感觉自己的身体变轻了…轻了…轻了…","不幸的事情终于发生了……你摸了摸自己的脖子，似乎找不到脑袋了，于是你一赌气","不幸的事情终于发生了……你的墓碑上写着：“下次再也不把治疗药水借给别人了”","不幸的事情终于发生了……曾经有一瓶治疗药水摆在你面前，而你没有珍惜","不幸的事情终于发生了……你回想起曾经在广阔的原野上尽情的奔跑","不幸的事情终于发生了……不过好消息是你再也不用减肥了","不幸的事情终于发生了……下次在冒险前一定要吃饱饭"];a.assign("open",function(e){if(e){c.textContent=e}else{c.innerHTML=""}b.textContent=d[Math.floor(Math.random()*d.length)];Game.windows.stage.hide();Game.windows["interface"].hide();a.show()});overWindowClose.addEventListener("click",function(b){Game.clearStage();a.hide();Game.windows.main.show()})})();"use strict";(function(){"use strict";var a=Game.windows.pickup=Game.Window.create("pickupWindow");a.html='\n    <div class="window-box">\n      <button id="pickupWindowClose" class="brownButton">关闭</button>\n      <button id="pickupWindowAll" class="brownButton">A 全部</button>\n      <table border="0">\n        <thead>\n          <tr>\n            <td style="width: 40px;"></td>\n            <td style="width: 120px;"></td>\n            <td style="width: 30px;"></td>\n            <td style="width: 30px;"></td>\n            <td></td>\n            <td style="width: 60px;"></td>\n          </tr>\n        </thead>\n        <tbody id="pickupWindowTable"></tbody>\n      </table>\n    </div>\n  ';a.css="\n\n    #pickupWindowTable tr:nth-child(odd) {\n      background-color: rgba(192, 192, 192, 0.6);\n    }\n\n    .pickupWindow table {\n      width: 100%;\n    }\n\n    .pickupWindow button {\n      width: 60px;\n      height: 40px;\n      font-size: 16;\n    }\n\n    #pickupWindowClose {\n\n    }\n\n    #pickupWindowAll {\n\n    }\n  ";var b=a.querySelector("button#pickupWindowClose");var c=a.querySelector("button#pickupWindowAll");var d=a.querySelector("#pickupWindowTable");var e=null;var f=-1;b.addEventListener("click",function(a){Game.windows.pickup.hide()});c.addEventListener("click",function(a){var b=e;if(b&&b.inner&&Object.keys(b.inner).length>0){Sprite.each(b.inner,function(a,b,c){if(b=="gold"){Game.hero.data.gold+=a}else{if(Game.hero.data.items[b]){Game.hero.data.items[b]+=a}else{Game.hero.data.items[b]=a}}delete c[b]});Game.windows.pickup.open(b)}});a.whenUp(["a","A"],function(a){c.click()});a.whenUp(["esc"],function(b){setTimeout(function(){a.hide()},20)});a.whenUp(["1","2","3","4","5","6","7","8","9"],function(a){var b=d.querySelectorAll("button");for(var c=0,e=b.length;c<e;c++){var f=b[c].getAttribute("data-index");if(f){if(f==a){b[c].click()}}}});a.assign("open",function(a,b){if(typeof b=="undefined"){b=-1}f=b;if(!a.inner||Object.keys(a.inner).length<=0){if(Game.area.bags.has(a)){a.erase();Game.area.bags["delete"](a)}if(Game.area.items.has(a)){a.erase();Game.area.items["delete"](a)}Game.windows.pickup.hide();return}e=a;var c=1;var g="";Sprite.each(a.inner,function(a,d,e){var f=Game.items[d];var h="";if(b==c-1){h+='<tr style="background-color: green;">\n'}else{h+="<tr>\n"}if(f.icon){h+='  <td style="text-align: center;"><img alt="" src="'+f.icon.src+'"></td>\n'}else{h+="  <td> </td>\n"}h+="  <td>"+f.data.name+"</td>\n";h+='  <td style="text-align: center;">'+f.data.value+"G</td>\n";h+='  <td style="text-align: center;">'+a+"</td>\n";h+="  <td>"+f.data.description+"</td>\n";h+='  <td><button data-id="'+d+'" data-index="'+c+'" class="brownButton">'+(c<=9?c:"")+" 拿取</button></td>\n";h+="</tr>\n";g+=h;c++});d.innerHTML=g;Game.windows.pickup.show()});a.whenUp(["enter"],function(){var a=d.querySelectorAll("button");if(f>=0&&f<a.length){a[f].click()}});a.whenUp(["up","down"],function(b){var c=d.querySelectorAll("button").length;if(f==-1){if(b=="down"){a.open(e,0)}else if(b=="up"){a.open(e,c-1)}}else{if(b=="down"){var g=f+1;if(g>=c){g=0}a.open(e,g)}else if(b=="up"){var g=f-1;if(g<0){g=c-1}a.open(e,g)}}});d.addEventListener("click",function(b){var c=b.target.getAttribute("data-id");if(c&&e.inner&&e.inner.hasOwnProperty(c)){var d=e.inner[c];if(c=="gold"){Game.hero.data.gold+=d}else{if(Game.hero.data.items.hasOwnProperty(c)){Game.hero.data.items[c]+=d}else{Game.hero.data.items[c]=d}}delete e.inner[c];a.open(e)}})})();"use strict";(function(){"use strict";var a=Game.windows.quest=Game.Window.create("questWindow");a.html='\n    <div class="window-box">\n      <div id="questWindowItemBar">\n        <button id="questWindowClose" class="brownButton">关闭</button>\n        <button id="questWindowCurrent" class="brownButton">当前任务</button>\n        <button id="questWindowPast" class="brownButton">已完成</button>\n      </div>\n      <div id="questWindowTable"></div>\n    </div>\n  ';a.css="\n    #questWindowTable {\n      width: 100%;\n      overflow-y: auto;\n      height: 320px;\n    }\n\n    .questWindowItem {\n      border: 1px solid gray;\n      border-radius: 10px;\n      margin: 10px 10px;\n    }\n\n    .questWindowItem > button {\n      width: 100px;\n      height: 40px;\n      border-radius: 5px;\n    }\n\n    #questWindowItemBar button {\n      width: 100px;\n      height: 30px;\n      font-size: 16px;\n      margin-bottom: 5px;\n    }\n\n    #questWindowClose {\n      float: right;\n    }\n  ";var b=a.querySelector("#questWindowClose");var c=a.querySelector("#questWindowCurrent");var d=a.querySelector("#questWindowPast");var e=a.querySelector("#questWindowTable");b.addEventListener("click",function(){a.hide()});a.whenUp(["esc"],function(a){setTimeout(function(){b.click()},20)});c.addEventListener("click",function(){a.hide();a.current()});d.addEventListener("click",function(){a.hide();a.past()});a.assign("current",function(){c.disabled=true;d.disabled=false;var b="";var f=Game.hero.data.currentQuest;f.forEach(function(a){var c=Game.Quest.isComplete(a);var d='<div class="questWindowItem">\n';d+='  <label style="font-size: 20px; margin: 10px;">'+a.name+(c?"[已完成]":"[未完成]")+"</label>\n";d+='  <div style="margin: 10px;">简介：'+a.description+"</div>\n";if(a.reward){d+='  <div style="margin: 10px;">任务奖励：';if(a.reward.gold){d+='<label style="margin-right: 20px;">金币：'+a.reward.gold+"</label>"}if(a.reward.exp){d+='<label style="margin-right: 20px;">经验：'+a.reward.exp+"</label>"}d+="  </div>"}if(a.target&&a.target.kill=="kill"){var e=true;var f=false;var g=undefined;try{for(var h=a.target.kill[Symbol.iterator](),i;!(e=(i=h.next()).done);e=true){var j=i.value;d+='<div style="margin: 10px;">'+j.name+"："+j.current+" / "+t.need+"</div>"}}catch(k){f=true;g=k}finally{try{if(!e&&h["return"]){h["return"]()}}finally{if(f){throw g}}}}d+='  <label style="margin: 10px;">给予人：'+a.fromMap+" 的 "+a.fromName+"</label>\n";d+='  <label style="margin: 10px;">交付人：'+a.toMap+" 的 "+a.toName+"</label>\n";d+="</div>\n";b+=d});if(b.length<=0){b="<div><label>没有正在进行的任务</label></div>"}e.innerHTML=b;a.show()});a.assign("past",function(){c.disabled=false;d.disabled=true;var b="";var f=Game.hero.data.completeQuest;f.forEach(function(a){var c='<div class="questWindowItem">\n';c+='  <label style="font-size: 20px; margin: 10px;">'+a.name+"[已完成]</label>\n";c+='  <div style="margin: 10px;">简介：'+a.description+"</div>\n";if(a.reward){c+='  <div style="margin: 10px;">任务奖励：';if(a.reward.gold){c+='<label style="margin-right: 20px;">金币：'+a.reward.gold+"</label>"}if(a.reward.exp){c+='<label style="margin-right: 20px;">经验：'+a.reward.exp+"</label>"}c+="  </div>"}if(a.target&&a.target.type=="kill"){var d=true;var e=false;var f=undefined;try{for(var g=a.target.kill[Symbol.iterator](),h;!(d=(h=g.next()).done);d=true){var i=h.value;c+='<div style="margin: 10px;">'+i.name+"："+i.current+" / "+t.need+"</div>"}}catch(j){e=true;f=j}finally{try{if(!d&&g["return"]){g["return"]()}}finally{if(e){throw f}}}}c+='  <label style="margin: 10px;">给予人：'+a.fromMap+" 的 "+a.fromName+"</label>\n";c+='  <label style="margin: 10px;">交付人：'+a.toMap+" 的 "+a.toName+"</label>\n";c+="</div>\n";b+=c});if(b.length<=0){b="<div><label>没有已完成任务</label></div>"}e.innerHTML=b;a.show()});e.addEventListener("click",function(b){var c=b.target.getAttribute("data-id");if(c){if(type=="remove"){Game.Archive.remove(c);a.open()}else if(type=="load"){Game.Archive.load(c);a.hide()}}})})();"use strict";(function(){"use strict";var a=Game.windows.register=Game.Window.create("registerWindow");a.html='\n    <div id="registerWindowContainer">\n\n      <div id="registerWindowDisplaySelect">\n\n        <div>\n          <label>\n          性别\n          </label>\n          <select data-type="sex">\n            <option value="male">男性</option>\n            <option value="female">女性</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          皮肤\n          </label>\n          <select data-type="body">\n            <option value="light">粉白</option>\n            <option value="dark">深色</option>\n            <option value="dark2">更深</option>\n            <option value="tanned">黄白</option>\n            <option value="tanned2">黄灰</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          眼睛\n          </label>\n          <select data-type="eyes">\n            <option value="blue">蓝色</option>\n            <option value="brown">棕色</option>\n            <option value="gray">灰色</option>\n            <option value="green">绿色</option>\n            <option value="orange">橙色</option>\n            <option value="purple">紫色</option>\n            <option value="red">红色</option>\n            <option value="yellow">黄色</option>\n          </select>\n        </div>\n\n        <div id="customMaleHair">\n          <label>\n          头发\n          </label>\n          <select data-type="malehair">\n            <option value="">无</option>\n            <option value="bedhead">Bedhead</option>\n            <option value="long">Long</option>\n            <option value="longhawk">Longhawk</option>\n            <option value="messy1">messy1</option>\n            <option value="messy2">messy2</option>\n            <option value="mohawk">Mohawk</option>\n            <option value="page">Page</option>\n            <option value="parted">Parted</option>\n            <option value="plain">Plain</option>\n            <option value="shorthawk">Shorthawk</option>\n          </select>\n        </div>\n\n        <div id="customFemaleHair" style="display: none;">\n          <label>\n          头发\n          </label>\n          <select data-type="femalehair">\n            <option value="">无</option>\n            <option value="bangs">bangs</option>\n            <option value="bangslong">bangslong</option>\n            <option value="bangslong2">bangslong2</option>\n            <option value="bunches">bunches</option>\n            <option value="loose">loose</option>\n            <option value="pixie">pixie</option>\n            <option value="ponytail">ponytail</option>\n            <option value="ponytail2">ponytail2</option>\n            <option value="princess">princess</option>\n            <option value="shoulderl">shoulderl</option>\n            <option value="shoulderr">shoulderr</option>\n            <option value="swoop">swoop</option>\n            <option value="unkempt">unkempt</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          发色\n          </label>\n          <select data-type="haircolor">\n            <option value="black">Black</option>\n            <option value="blonde">Blonde</option>\n            <option value="blonde2">blonde2</option>\n            <option value="blue">blue</option>\n            <option value="blue2">blue2</option>\n            <option value="brown">brown</option>\n            <option value="brown2">brown2</option>\n            <option value="brunette">brunette</option>\n            <option value="brunette2">brunette2</option>\n            <option value="dark-blonde">dark-blonde</option>\n            <option value="gold">gold</option>\n            <option value="gray">gray</option>\n            <option value="gray2">gray2</option>\n            <option value="green">green</option>\n            <option value="green2">green2</option>\n            <option value="light-blonde">light-blonde</option>\n            <option value="light-blonde2">light-blonde2</option>\n            <option value="pink">pink</option>\n            <option value="pink2">pink2</option>\n            <option value="purple">purple</option>\n            <option value="raven">raven</option>\n            <option value="raven2">raven2</option>\n            <option value="redhead">redhead</option>\n            <option value="redhead2">redhead2</option>\n            <option value="ruby-red">ruby-red</option>\n            <option value="white">white</option>\n            <option value="white-blonde">white-blonde</option>\n            <option value="white-blonde2">white-blonde2</option>\n            <option value="white.centerYan">white.centerYan</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          帽子\n          </label>\n          <select data-type="head">\n            <option value="">无</option>\n            <option value="chainhat">chainhat</option>\n            <option value="chain_hood">chain_hood</option>\n            <option value="cloth_hood">cloth_hood</option>\n            <option value="leather_cap">leather_cap</option>\n            <option value="red">red</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          上衣\n          </label>\n          <select data-type="shirts">\n            <option value="">无</option>\n            <option value="brown">brown</option>\n            <option value="maroon">maroon</option>\n            <option value="teal">teal</option>\n            <option value="white">white</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          裤子\n          </label>\n          <select data-type="pants">\n            <option value="">无</option>\n            <option value="magenta">magenta</option>\n            <option value="red">red</option>\n            <option value="teal">teal</option>\n            <option value="white">white</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          鞋子\n          </label>\n          <select  data-type="shoes">\n            <option value="">无</option>\n            <option value="black">black</option>\n            <option value="brown">brown</option>\n            <option value="maroon">maroon</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          头盔\n          </label>\n          <select data-type="armorhelms">\n            <option value="">无</option>\n            <option value="golden">黄金</option>\n            <option value="metal">白银</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          胸甲\n          </label>\n          <select data-type="armorchest">\n            <option value="">无</option>\n            <option value="golden">黄金</option>\n            <option value="metal">白银</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          臂甲\n          </label>\n          <select data-type="armorarm">\n            <option value="">无</option>\n            <option value="golden">黄金</option>\n            <option value="metal">白银</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          腿甲\n          </label>\n          <select data-type="armorlegs">\n            <option value="">无</option>\n            <option value="golden">黄金</option>\n            <option value="metal">白银</option>\n          </select>\n        </div>\n\n        <div>\n          <label>\n          足甲\n          </label>\n          <select data-type="armorfeet">\n            <option value="">无</option>\n            <option value="golden">黄金</option>\n            <option value="metal">白银</option>\n          </select>\n        </div>\n\n      </div><!--registerWindowDisplaySelect-->\n\n      <hr>\n\n      <div id="registerWindowPersonal">\n\n        <div>\n          <label>\n          信仰\n          </label>\n          <select id="registerWindowBeliefChoice" data-type="belief">\n            <option value="None">无信仰</option>\n            <option value="Elen">艾琳 - 知识女神</option>\n            <option value="Enlon">恩朗 - 死亡主宰</option>\n            <option value="Minare">密娜 - 丰收女神</option>\n            <option value="Achiel">阿切奥 - 保护之神</option>\n            <option value="Racha">拉克 - 魔法女神</option>\n            <option value="Aestor">阿斯托 - 盗贼之神</option>\n            <option value="Hielach">赫拉克 - 财富之神</option>\n            <option value="Alik">阿丽克 - 治愈女神</option>\n            <option value="Amarien">阿玛恩 - 力量之神</option>\n          </select>\n          <div id="registerWindowBelief"></div>\n        </div>\n\n        <div>\n          <label>\n          职业\n          </label>\n          <select id="registerWindowClassChoice" data-type="class">\n            <option value="warrior">战士</option>\n            <option value="archer">弓箭手</option>\n            <option value="wizard">魔法师</option>\n            <option value="priest">牧师</option>\n            <option value="bard">吟游诗人</option>\n            <option value="thief">盗贼</option>\n            <option value="business">商人</option>\n          </select>\n          <div id="registerWindowClass"></div>\n        </div>\n\n        <div style="padding-top: 20px;">\n          <input id="registerHeroName" placeholder="名字" type="text">\n        </div>\n\n      </div><!--registerWindowPersonal-->\n\n      <div style="padding-bottom: 20px; padding-top: 10px;">\n        <button id="registerWindowSubmit" class="brownButton">完成</button>\n        <button id="registerWindowBack" class="brownButton">返回</button>\n      </div>\n\n    </div>\n\n    <div id="registerWindowDisplay">\n      <label id="loading">正在载入预览</label>\n      <br>\n      <canvas width="64" height="250"></canvas>\n    </div>\n  ';
a.css="\n\n    #registerWindowDisplay {\n      position: fixed;\n      height: 250px;\n      width: 64px;\n      left: 80px;\n      top: 25px;\n      transform: scale(1.4);\n      -webkit-transform: scale(1.4);\n      transform-origin: left top 0;\n      -webkit-transform-origin: left top 0;\n    }\n\n    #registerWindowContainer {\n       overflow-x: hidden;\n       overflow-y: scroll;\n       left: 200px;\n       top: 20px;\n       width: 620px;\n       height: 410px;\n       position: fixed;\n    }\n\n    #registerWindowBelief, #registerWindowClass {\n      text-align: center;\n      width: 100%;\n    }\n\n    #registerWindowSubmit, #registerWindowBack {\n      width: 100px;\n      height: 60px;\n    }\n\n    .registerWindow {\n      text-align: center;\n      height: 412px;\n      background-color: rgba(240, 217, 194, 0.85);\n      border: 20px solid rgba(134, 93, 52, 0.85);\n    }\n\n    .registerWindow hr {\n      width: 90%;\n    }\n\n    .registerWindow input {\n      width: 240px;\n      height: 40px;\n      -webkit-border-radius: 5px;\n      -moz-border-radius: 5px;\n      border-radius: 5px;\n      text-align: center;\n      font-size: 16px;\n      background-color: #d5ab63;\n      margin: 10px;\n    }\n\n    .registerWindow label {\n      font-size: 20px;\n      color: white;\n    }\n\n    .registerWindow select {\n      -webkit-appearance: none;\n      -moz-appearance: none;\n      appearance: none;\n      width: 200px;\n      height: 40px;\n      -webkit-border-radius: 5px;\n      -moz-border-radius: 5px;\n      border-radius: 5px;\n      text-align: center;\n      font-size: 16px;\n      background-color: #d5ab63;\n      margin: 10px;\n    }\n  ";var b=a.querySelector("#registerWindowSubmit");var c=a.querySelector("#registerWindowBack");b.addEventListener("click",function(){Game.register.submit()});c.addEventListener("click",function(){a.hide();Game.windows.main.show()})})();"use strict";(function(){"use strict";var a=Game.windows.sell=Game.Window.create("sellWindow");a.html='\n  <div class="window-box">\n    <div id="sellWindowItemBar">\n\n      <button id="sellWindowClose" class="brownButton">关闭</button>\n      <button id="sellWindowBuy" class="brownButton">买入</button>\n\n      <button id="sellWindowAll" class="brownButton">全部</button>\n      <button id="sellWindowWeapon" class="brownButton">武器</button>\n      <button id="sellWindowArmor" class="brownButton">护甲</button>\n      <button id="sellWindowPotion" class="brownButton">药水</button>\n      <button id="sellWindowMaterial" class="brownButton">材料</button>\n      <button id="sellWindowBook" class="brownButton">书籍</button>\n      <button id="sellWindowMisc" class="brownButton">其他</button>\n    </div>\n\n    <span id="sellWindowGold"></span>\n\n    <div style="overflow: auto; height: 300px;">\n      <table border="0">\n        <thead>\n          <tr>\n            <td style="width: 40px;"></td>\n            <td style="width: 120px;"></td>\n            <td style="width: 30px;"></td>\n            <td style="width: 30px;"></td>\n            <td></td>\n            <td style="width: 60px;"></td>\n          </tr>\n        </thead>\n        <tbody id="sellWindowTable"></tbody>\n      </table>\n    </div>\n  </div>\n  ';a.css="\n\n    #sellWindowTable tr:nth-child(odd) {\n      background-color: rgba(192, 192, 192, 0.6);\n    }\n\n    #sellWindowItemBar > button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n      margin-left: 5px;\n      margin-right: 5px;\n      margin-top: 0px;\n      margin-bottom: 5px;\n    }\n\n    #sellWindowClose {\n      float: right;\n    }\n\n    #sellWindowStatus {\n      float: right;\n    }\n\n    .sellWindow table {\n      width: 100%;\n    }\n\n    .sellWindow table button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n    }\n\n    #sellWindowGold {\n      position: absolute;\n      right: 100px;\n      bottom: 30px;\n      font-size: 20px;\n      color: black;\n    }\n  ";var b=a.querySelector("button#sellWindowClose");var c=a.querySelector("button#sellWindowBuy");var d=a.querySelector("button#sellWindowAll");var e=a.querySelector("button#sellWindowWeapon");var f=a.querySelector("button#sellWindowArmor");var g=a.querySelector("button#sellWindowPotion");var h=a.querySelector("button#sellWindowMaterial");var i=a.querySelector("button#sellWindowBook");var j=a.querySelector("button#sellWindowMisc");var k=a.querySelector("span#sellWindowGold");var l=a.querySelector("#sellWindowTable");var m=null;var n=null;var o=-1;b.addEventListener("click",function(){a.hide()});c.addEventListener("click",function(){a.hide();Game.windows.buy.open(m)});a.whenUp(["tab"],function(){setTimeout(function(){a.hide();Game.windows.buy.open(m)},20)});d.addEventListener("click",function(b){a.open(m,null)});e.addEventListener("click",function(b){a.open(m,"sword|spear|bow")});f.addEventListener("click",function(b){a.open(m,"head|body|feet")});g.addEventListener("click",function(b){a.open(m,"potion")});h.addEventListener("click",function(b){a.open(m,"material")});i.addEventListener("click",function(b){a.open(m,"book|scroll|letter")});j.addEventListener("click",function(b){a.open(m,"misc")});a.assign("open",function(b,c,p){if(typeof p=="undefined"){p=-1}m=b;n=c;o=p;k.textContent=Game.hero.data.gold+"G";var q="white";var r="yellow";d.style.color=q;e.style.color=q;f.style.color=q;g.style.color=q;h.style.color=q;i.style.color=q;j.style.color=q;if(c==null){d.style.color=r}else if(c.match(/sword/)){e.style.color=r}else if(c.match(/head/)){f.style.color=r}else if(c.match(/potion/)){g.style.color=r}else if(c.match(/material/)){h.style.color=r}else if(c.match(/book/)){i.style.color=r}else if(c.match(/misc/)){j.style.color=r}var s=0;var t="";Sprite.each(Game.hero.data.items,function(a,b){var d=Game.items[b];if(c&&c.indexOf(d.data.type)==-1)return;var e="";if(p==s){e+='<tr style="background-color: green;">\n'}else{e+="<tr>\n"}if(d.icon){e+='  <td style="text-align: center;"><img alt="" src="'+d.icon.src+'"></td>\n'}else{e+="  <td> </td>\n"}e+="  <td>"+d.data.name+"</td>\n";e+='  <td style="text-align: center;">'+Math.ceil(d.data.value*.8)+"G</td>\n";e+='  <td style="text-align: center;">'+a+"</td>\n";e+="  <td>"+d.data.description+"</td>\n";e+='  <td><button data-id="'+b+'" class="brownButton">卖出</button></td>\n';e+="</tr>\n";t+=e;s++});l.innerHTML=t;a.show()});a.whenUp(["enter"],function(){var a=l.querySelectorAll("button");if(o>=0&&o<a.length){a[o].click()}});a.whenUp(["up","down"],function(b){var c=l.querySelectorAll("button").length;if(c<=0)return;if(o==-1){if(b=="down"){a.open(m,n,0)}else if(b=="up"){a.open(m,n,c-1)}}else{if(b=="down"){var d=o+1;if(d>=c){d=0}a.open(m,n,d)}else if(b=="up"){var d=o-1;if(d<0){d=c-1}a.open(m,n,d)}}});a.whenUp(["esc"],function(){setTimeout(function(){a.hide()},20)});a.whenUp(["left","right"],function(b){if(b=="right"){var c=n;if(c==null){c="sword"}else if(c.match(/sword/)){c="head"}else if(c.match(/head/)){c="potion"}else if(c.match(/potion/)){c="material"}else if(c.match(/material/)){c="book"}else if(c.match(/book/)){c="misc"}else if(c.match(/misc/)){c=null}a.open(m,c)}else if(b=="left"){var c=n;if(c==null){c="misc"}else if(c.match(/sword/)){c=null}else if(c.match(/head/)){c="sword"}else if(c.match(/potion/)){c="head"}else if(c.match(/material/)){c="potion"}else if(c.match(/book/)){c="material"}else if(c.match(/misc/)){c="book"}a.open(m,c)}});l.addEventListener("click",function(b){var c=b.target.getAttribute("data-id");if(c&&Game.hero.data.items.hasOwnProperty(c)){var d=Game.items[c];var e=Game.hero.data.items[c];if(m.hasOwnProperty(c)){m[c]++}else{m[c]=1}if(e==1){Game.hero.data.bar.forEach(function(a,b,d){if(a&&a.id==c){d[b]=null}});Sprite.each(Game.hero.data.equipment,function(a,b){if(a==c){Game.hero.data.equipment[b]=null}});delete Game.hero.data.items[c]}else{Game.hero.data.items[c]--}Game.hero.data.gold+=Math.ceil(d.data.value*.8);Game.windows["interface"].refresh();a.open(m,n)}})})();"use strict";(function(){"use strict";var a=Game.windows.setting=Game.Window.create("settingWindow");a.html='\n    <div class="window-box">\n      <button id="settingWindowClose" class="brownButton">关闭</button>\n\n      <div id="settingWindowRendererType"></div>\n\n      <div id="settingWindowBox">\n        <button id="settingWindowFullscreen" class="brownButton">全屏</button>\n        <button id="settingWindowScale" class="brownButton">缩放</button>\n        <button id="settingWindowShortcut" class="brownButton">清除快捷栏</button>\n        <button id="settingWindowShortcutAll" class="brownButton">清除全部快捷栏</button>\n      </div>\n    </div>\n  ';a.css="\n    #settingWindowBox {\n      width: 100%;\n      height: 360px;\n    }\n\n    #settingWindowBox button {\n      width: 120px;\n      height: 60px;\n      font-size: 16px;\n      display: block;\n    }\n\n    #settingWindowClose {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n      float: right;\n    }\n  ";var b=a.querySelector("#settingWindowShortcut");var c=a.querySelector("#settingWindowShortcutAll");var d=a.querySelector("#settingWindowClose");var e=a.querySelector("#settingWindowScale");var f=a.querySelector("#settingWindowFullscreen");var g=a.querySelector("#settingWindowRendererType");b.addEventListener("click",function(a){Game.choice({1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7}).then(function(a){if(Number.isFinite(a)){Game.hero.data.bar[a]=null;Game.windows["interface"].refresh()}})});c.addEventListener("click",function(a){Game.confirm("确定要删除所有快捷栏图表吗？").then(function(){for(var a=0;a<8;a++){Game.hero.data.bar[a]=null}Game.windows["interface"].refresh()})["catch"](function(){})});a.on("beforeShow",function(){g.textContent=Game.stage.rendererType});d.addEventListener("click",function(b){a.hide()});e.addEventListener("click",function(b){Game.config.scale=!Game.config.scale;a.show()});a.whenUp(["esc"],function(a){d.click()});function h(){if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen()}else if(document.documentElement.msRequestFullscreen){document.documentElement.msRequestFullscreen()}else if(document.documentElement.mozRequestFullScreen){document.documentElement.mozRequestFullScreen()}else if(document.documentElement.webkitRequestFullscreen){document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}else{if(document.exitFullscreen){document.exitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}f.addEventListener("click",function(a){h()})})();"use strict";(function(){"use strict";var a=Game.windows.skill=Game.Window.create("skillWindow");a.html='\n    <div class="window-box">\n      <div id="skillWindowItemBar">\n        <button id="skillWindowClose" class="brownButton">关闭</button>\n      </div>\n      <table border="0">\n        <thead>\n          <tr>\n            <th style="width: 40px;"></th>\n            <th style="width: 120px;"></th>\n            <th></td>\n            <th style="width: 60px;"></th>\n          </tr>\n        </thead>\n        <tbody id="skillWindowTable"></tbody>\n      </table>\n    </div>\n  ';a.css="\n    .skillWindow table {\n      width: 100%;\n    }\n\n    .skillWindow tr:nth-child(odd) {\n      background-color: rgba(192, 192, 192, 0.6);\n    }\n\n    .skillWindow table img {\n      width: 100%;\n      height: 100%;\n    }\n\n    .skillWindow button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n    }\n\n    #skillWindowItemBar button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n      margin-left: 5px;\n      margin-right: 5px;\n      margin-top: 0px;\n      margin-bottom: 5px;\n    }\n\n    #skillWindowClose {\n      float: right;\n    }\n  ";var b=a.querySelector("button#skillWindowClose");var c=a.querySelector("#skillWindowTable");var d=-1;b.addEventListener("click",function(b){a.hide()});a.whenUp(["esc"],function(b){setTimeout(function(){a.hide()},20)});a.assign("open",function(a){if(typeof a=="undefined"){a=-1}d=a;var b=0;var e="";Game.hero.data.skills.forEach(function(c){var d=Game.skills[c];var f="";if(a==b){f+='<tr style="background-color: green;">\n'}else{f+="<tr>\n"}f+='  <td><img alt="" src="'+d.icon.src+'"></td>\n';f+="  <td>"+d.data.name+"</td>\n";f+="  <td>"+d.data.description+"</td>\n";f+='  <td><button data-id="'+c+'" class="brownButton skillWindowManage">管理</button></td>\n';f+="</tr>\n";e+=f;b++});c.innerHTML=e;Game.windows.skill.show()});a.whenUp(["enter"],function(){var b=a.querySelectorAll(".skillWindowManage");if(d>=0&&d<b.length){b[d].click()}});a.whenUp(["up","down"],function(b){var c=a.querySelectorAll(".skillWindowManage").length;if(d==-1){if(b=="down"){a.open(0)}else if(b=="up"){a.open(c-1)}}else{if(b=="down"){var e=d+1;if(e>=c){e=0}a.open(e)}else if(b=="up"){var e=d-1;if(e<0){e=c-1}a.open(e)}}});c.addEventListener("click",function(b){var c=b.target.getAttribute("data-id");var d=Game.hero.data.skills.indexOf(c);if(c&&Game.skills.hasOwnProperty(c)&&d!=-1){(function(){var b=Game.skills[c];var e={};e["快捷栏"]="shortcut";e["遗忘"]="remove";if(b.data.next){e["升级"]="levelup"}Game.choice(e).then(function(e){switch(e){case"shortcut":Game.choice({1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7}).then(function(a){if(Number.isFinite(a)&&a>=0){Game.hero.data.bar[a]={id:c,type:"skill"};Game.windows["interface"].refresh()}});break;case"levelup":if(b.data.next){var f=[];if(Game.hero.data.gold<b.data.next.gold){f.push("金币不足，需要金币"+b.data.next.gold+"，当前您有金币"+Game.hero.data.gold)}if(Game.hero.data.exp<b.data.next.exp){f.push("经验不足，需要经验"+b.data.next.exp+"，当前您有经验"+Game.hero.data.exp)}if(f.length){Game.dialogue(f);return}Game.confirm("确定要升级这个技能吗？共需要金币"+b.data.next.gold+"，经验"+b.data.next.exp).then(function(){var c=b.data.next.id;Game.hero.data.skills.splice(d,1);Game.hero.data.skills.push(c);Game.hero.data.gold-=b.data.next.gold;Game.hero.data.exp-=b.data.next.exp;Game.windows.loading.begin();Game.Skill.load(c).then(function(b){Game.windows.loading.end();a.open()})})["catch"](function(){})}break;case"remove":Game.confirm("真的要遗忘 "+b.data.name+" 技能吗？").then(function(){Game.hero.data.bar.forEach(function(a,b,d){if(a&&a.id==c){d[b]=null}});Game.hero.data.skills.splice(d,1);Game.windows["interface"].refresh();a.open()})["catch"](function(){});break}})})()}})})();"use strict";(function(){"use strict";var a=Game.windows.status=Game.Window.create("statusWindow");a.html='\n    <div class="window-box">\n      <div id="statusWindowItemBar">\n        <button id="statusWindowClose" class="brownButton">关闭</button>\n        <button id="statusWindowInventory" class="brownButton">物品</button>\n        <label id="heroName"></label>\n      </div>\n      <table border="0">\n        <tr>\n          <td id="statusWindowTable">\n            <label id="heroHP"></label>\n            <label id="heroSP"></label>\n            <label id="heroLevel"></label>\n            <label id="heroEXP"></label>\n            <label id="heroSTR"></label>\n            <label id="heroDEX"></label>\n            <label id="heroCON"></label>\n            <label id="heroINT"></label>\n            <label id="heroCHA"></label>\n            <label id="heroATK"></label>\n            <label id="heroDEF"></label>\n            <label id="heroMATK"></label>\n            <label id="heroMDEF"></label>\n          </td>\n          <td style="width: 50%;">\n            <table id="statusWindowEquipmentTable" border="0">\n              <tbody>\n                <tr>\n                  <td class="statusWindowEquipmentText">头部</td>\n                  <td id="equipment-head"></td>\n                  <td style="width: 60px;"><button id="equipmentButton-head" class="brownButton">卸下</button></td>\n                </tr>\n                <tr>\n                  <td class="statusWindowEquipmentText">身体</td>\n                  <td id="equipment-body"></td>\n                  <td><button id="equipmentButton-body" class="brownButton">卸下</button></td>\n                </tr>\n                <tr>\n                  <td class="statusWindowEquipmentText">足部</td>\n                  <td id="equipment-feet"></td>\n                  <td><button id="equipmentButton-feet" class="brownButton">卸下</button></td>\n                </tr>\n                <tr>\n                  <td class="statusWindowEquipmentText">武器</td>\n                  <td id="equipment-weapon"></td>\n                  <td><button id="equipmentButton-weapon" class="brownButton">卸下</button></td>\n                </tr>\n                <tr>\n                  <td class="statusWindowEquipmentText">项链</td>\n                  <td id="equipment-neck"></td>\n                  <td><button id="equipmentButton-neck" class="brownButton">卸下</button></td>\n                </tr>\n                <tr>\n                  <td class="statusWindowEquipmentText">戒指</td>\n                  <td id="equipment-ring"></td>\n                  <td><button id="equipmentButton-ring" class="brownButton">卸下</button></td>\n                </tr>\n              </tbody>\n            </table>\n          </td>\n        </tr>\n      </table>\n    </div>\n  ';a.css="\n\n    #statusWindowEquipmentTable tr:nth-child(odd) {\n      background-color: rgba(192, 192, 192, 0.6);\n    }\n\n    #heroName {\n      font-size: 24px;\n      margin-left: 240px;\n    }\n\n    #statusWindowTable {\n      width: 50%;\n    }\n\n    #statusWindowTable label {\n      font-size: 18px;\n      margin-left: 80px;\n    }\n\n    #statusWindowEquipmentTable button {\n      width: 60px;\n      height: 40px;\n    }\n\n    .statusWindowEquipmentText {\n      width: 60px;\n      font-size: 20px;\n      text-align: center;\n    }\n\n    .statusWindow label {\n      display: block;\n    }\n\n    #statusWindowItemBar button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n      margin-left: 5px;\n      margin-right: 5px;\n      margin-top: 0px;\n      margin-bottom: 5px;\n      text-align: center;\n    }\n\n    #statusWindowClose {\n      float: right;\n    }\n\n    #statusWindowInventory {\n      float: right;\n    }\n\n    .statusWindow table {\n      width: 100%;\n      height: 320px;\n    }\n  ";var b={head:a.querySelector("#equipment-head"),body:a.querySelector("#equipment-body"),feet:a.querySelector("#equipment-feet"),weapon:a.querySelector("#equipment-weapon"),neck:a.querySelector("#equipment-neck"),ring:a.querySelector("#equipment-ring")};var c={head:a.querySelector("#equipmentButton-head"),body:a.querySelector("#equipmentButton-body"),feet:a.querySelector("#equipmentButton-feet"),weapon:a.querySelector("#equipmentButton-weapon"),neck:a.querySelector("#equipmentButton-neck"),ring:a.querySelector("#equipmentButton-ring")};var d=-1;Sprite.each(c,function(b,c){b.addEventListener("click",function(){if(Game.hero.data.equipment[c]){Game.hero.data.equipment[c]=null}else{if(c=="weapon"){Game.windows.inventory.open("sword|spear|bow")}else{Game.windows.inventory.open("head|body|feet")}}a.update()})});var e=a.querySelector("#heroName");var f=a.querySelector("#heroHP");var g=a.querySelector("#heroSP");var h=a.querySelector("#heroLevel");var i=a.querySelector("#heroEXP");var j=a.querySelector("#heroSTR");var k=a.querySelector("#heroDEX");var l=a.querySelector("#heroCON");var m=a.querySelector("#heroINT");var n=a.querySelector("#heroCHA");var o=a.querySelector("#heroATK");var p=a.querySelector("#heroDEF");var q=a.querySelector("#heroMATK");var r=a.querySelector("#heroMDEF");var s=a.querySelector("button#statusWindowClose");var t=a.querySelector("button#statusWindowInventory");var u=a.querySelector("#statusWindowEquipmentTable");s.addEventListener("click",function(b){a.hide()});t.addEventListener("click",function(b){a.hide();Game.windows.inventory.open()});a.whenUp(["tab"],function(){setTimeout(function(){a.hide();Game.windows.inventory.open()},20)});a.whenUp(["esc"],function(b){setTimeout(function(){a.hide()},20)});a.assign("update",function(a){if(typeof a=="undefined"){a=-1}d=a;e.textContent="名字："+Game.hero.data.name;f.textContent="生命力："+Game.hero.data.hp+"/"+Game.hero.data.$hp;g.textContent="精神力："+Game.hero.data.sp+"/"+Game.hero.data.$sp;h.textContent="等级："+Game.hero.data.level;i.textContent="经验："+Game.hero.data.exp;j.textContent="力量："+Game.hero.data.str;k.textContent="敏捷："+Game.hero.data.dex;l.textContent="耐力："+Game.hero.data.con;m.textContent="智力："+Game.hero.data.int;n.textContent="魅力："+Game.hero.data.cha;o.textContent="攻击："+Game.hero.data.atk;p.textContent="防御："+Game.hero.data.def;q.textContent="魔法攻击："+Game.hero.data.matk;r.textContent="魔法防御："+Game.hero.data.mdef;var s=u.querySelectorAll("tr");for(var t=0,v=s.length;t<v;t++){if(a==t){s[t].style.backgroundColor="green"}else{s[t].style.backgroundColor=""}}Sprite.each(Game.hero.data.equipment,function(a,d){var e=c[d];if(a){var f="";f+='<img alt="" src="'+Game.items[a].icon.src+'">';f+="<span>"+Game.items[a].data.name+"</span>";b[d].innerHTML=f;e.textContent="卸下"}else{b[d].innerHTML="";e.textContent="装备"}})});a.whenUp(["enter"],function(){var a=u.querySelectorAll("button");if(d>=0&&d<a.length){a[d].click()}});a.whenUp(["up","down"],function(b){var c=u.querySelectorAll("button").length;if(d==-1){if(b=="down"){a.open(0)}else if(b=="up"){a.open(c-1)}}else{if(b=="down"){var e=d+1;if(e>=c){e=0}a.open(e)}else if(b=="up"){var e=d-1;if(e<0){e=c-1}a.open(e)}}});a.assign("open",function(b){a.update(b);a.show()})})();"use strict";(function(){"use strict";var a=Game.windows.sysmenu=Game.Window.create("sysmenuWindow");a.html='\n    <div class="window-box">\n      <button id="sysmenuWindowClose" class="brownButton">关闭窗口</button>\n\n      <table><tbody><tr><td>\n        <button id="sysmenuWindowInventory" class="brownButton">1、背包物品</button>\n        <button id="sysmenuWindowStatus" class="brownButton">2、状态装备</button>\n        <br>\n        <button id="sysmenuWindowSkill" class="brownButton">3、查看技能</button>\n        <button id="sysmenuWindowQuest" class="brownButton">4、任务列表</button>\n        <br>\n        <button id="sysmenuWindowMap" class="brownButton">5、迷你地图</button>\n        <button id="sysmenuWindowSetting" class="brownButton">6、游戏设置</button>\n        <br>\n        <button id="sysmenuWindowArchive" class="brownButton">7、存档管理</button>\n        <button id="sysmenuWindowExit" class="brownButton">8、退出游戏</button>\n        <br>\n      </td></tr></tbody></table>\n    </div>\n  ';a.css="\n    .sysmenuWindow {\n      text-align: center;\n    }\n\n    .sysmenuWindow table, .sysmenuWindow tbody, .sysmenuWindow tr, .sysmenuWindow td {\n      width: 100%;\n      height: 100%;\n      margin: 0;\n      padding: 0;\n    }\n\n    .sysmenuWindow button {\n      width: 200px;\n      height: 60px;\n      margin: 2px;\n      font-size: 16px;\n    }\n\n    button#sysmenuWindowClose {\n      position: absolute;\n      right: 50px;\n      top: 50px;\n      width: 120px;\n      height: 60px;\n      font-size: 16px;\n    }\n  ";var b=a.querySelector("button#sysmenuWindowInventory");var c=a.querySelector("button#sysmenuWindowStatus");var d=a.querySelector("button#sysmenuWindowSkill");var e=a.querySelector("button#sysmenuWindowQuest");var f=a.querySelector("button#sysmenuWindowMap");var g=a.querySelector("button#sysmenuWindowSetting");var h=a.querySelector("button#sysmenuWindowArchive");var i=a.querySelector("button#sysmenuWindowExit");var j=a.querySelector("button#sysmenuWindowClose");a.whenUp(["esc"],function(a){j.click()});a.whenUp(["1","2","3","4","5","6","7","8"],function(a){switch(a){case"1":b.click();break;case"2":c.click();break;case"3":d.click();break;case"4":e.click();break;case"5":f.click();break;case"6":g.click();break;case"7":h.click();break;case"8":i.click();break}});b.addEventListener("click",function(b){a.hide();Game.windows.inventory.open()});c.addEventListener("click",function(b){a.hide();Game.windows.status.open()});d.addEventListener("click",function(b){a.hide();Game.windows.skill.open()});e.addEventListener("click",function(b){a.hide();Game.windows.quest.current()});f.addEventListener("click",function(b){a.hide();Game.windows.map.show()});g.addEventListener("click",function(b){a.hide();Game.windows.setting.show()});h.addEventListener("click",function(b){a.hide();Game.windows.archive.open()});i.addEventListener("click",function(b){Game.clearStage();Game.windows["interface"].hide();Game.windows.stage.hide();a.hide();Game.windows.main.show()});j.addEventListener("click",function(b){a.hide()})})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";Game.assign("Astar",function(){function a(){_classCallCheck(this,a)}_createClass(a,null,[{key:"getPath",value:function b(a,c){return new Promise(function(b,e){var f={};var g=true;var h=false;var i=undefined;try{for(var j=Game.area.actors[Symbol.iterator](),k;!(g=(k=j.next()).done);g=true){var l=k.value;if(l.x!=a.x||l.y!=a.y){f[l.x*1e4+l.y]=true}}}catch(m){h=true;i=m}finally{try{if(!g&&j["return"]){j["return"]()}}finally{if(h){throw i}}}var n=d(function(a,b){if(a<0||a>=Game.area.map.col){return true}if(b<0||b>=Game.area.map.row){return true}var c=a*1e4+b;if(Game.area.map.blockedMap[c]){return true}if(f[c]){return true}return false},a,c);b(n)})}}]);return a}());var a=function(){function a(b){_classCallCheck(this,a);this.content=[];this.scoreFunction=b;this.scores=new Map}_createClass(a,[{key:"push",value:function b(a){this.scores.set(a,this.scoreFunction(a));this.content.push(a);this.bubbleUp(this.content.length-1)}},{key:"pop",value:function c(){var a=this.content[0];var b=this.content.pop();if(this.content.length>0){this.content[0]=b;this.sinkDown(0)}return a}},{key:"delete",value:function d(a){for(var b=0,c=this.content.length;b<c;b++){if(this.content[b]==a){this.scores["delete"](this.content[b]);var d=this.content.pop();if(b==c-1){break}this.content[b]=d;this.bubbleUp(b);this.sinkDown(b);break}}}},{key:"bubbleUp",value:function e(a){var b=this.content[a];var c=this.scores.get(b);while(a>0){var d=Math.floor((a+1)/2)-1;var e=this.content[d];if(c>=this.scores.get(e))break;this.content[d]=b;this.content[a]=e;a=d}}},{key:"sinkDown",value:function f(a){var b=this.content.length;var c=this.content[a];var d=this.scores.get(c);while(true){var e=(a+1)*2;var f=e-1;var g=null;var h=undefined,i=undefined;if(f<b){var j=this.content[f];h=this.scores.get(j);if(h<d){g=f}}if(e<b){var k=this.content[e];i=this.scores.get(k);if(i<(g==null?d:h)){g=e}}if(g==null){break}this.content[a]=this.content[g];this.content[g]=c;a=g}}},{key:"size",get:function g(){return this.content.length},set:function h(a){throw new Error("BinaryHeap.size readonly")}}]);return a}();function b(a,b,c,d){return Math.abs(a-c)+Math.abs(b-d)}function c(a,c,d,e,f){var g={key:a*1e4+c,x:a,y:c,g:e.g+f,h:b(a,c,d.x,d.y),front:[]};g.f=g.g+g.h;var h=e.front.length;g.front.length=h;for(var i=0;i<h;i++){g.front[i]=e.front[i]}g.front.push(e.x);g.front.push(e.y);return g}function d(d,e,f){var g=new a(function(a){return a.f});var h=new Set;var i=new Set;var j={key:e.x*1e4+e.y,x:e.x,y:e.y,f:0,g:0,h:b(e.x,e.y,f.x,f.y),front:[]};h.add(j.key);g.push(j);var k=function p(a,b,e,f){if(!d(a,b)){var j=a*1e4+b;if(!h.has(j)&&!i.has(j)){h.add(j);g.push(c(a,b,e,f,10))}}};while(g.size){var l=g.pop();g["delete"](l);h["delete"](l.key);i.add(l.key);if(l.x==f.x&&l.y==f.y){var m=[];for(var n=0,o=l.front.length;n<o;n+=2){m.push({x:l.front[n],y:l.front[n+1]})}m.push({x:f.x,y:f.y});return m}k(l.x,l.y-1,f,l);k(l.x,l.y+1,f,l);k(l.x-1,l.y,f,l);k(l.x+1,l.y,f,l)}return null}})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";Game.assign("AI",function(){function a(){_classCallCheck(this,a)}_createClass(a,null,[{key:"attach",value:function b(a){}}]);return a}())})();"use strict";(function(){"use strict";function a(a,b,c,d){var e={x:a.x-c.centerX,y:a.y-c.centerY,w:c.width,h:c.height,sx:c.x,sy:c.y,sw:c.width,sh:c.height,image:c.image};var f={x:b.x-d.centerX,y:b.y-d.centerY,w:d.width,h:d.height,sx:d.x,sy:d.y,sw:d.width,sh:d.height,image:d.image};var g=Math.max(e.x+e.w,f.x+f.w);var h=Math.min(e.x,f.x);var i=Math.max(e.y+e.h,f.y+f.h);var j=Math.min(e.y,f.y);var k=g-h;var l=i-j;if(k<e.w+f.w&&l<e.h+f.h){return{A:e,B:f}}return false}var b=new Map;function c(a,c){var d=(new Date).getTime();var e=a.w*1e3+a.h;var f=undefined;var g=undefined;if(b.has(e)){f=b.get(e).canvas;g=b.get(e).context}else{f=document.createElement("canvas");f.width=a.w;f.height=a.h;g=f.getContext("2d");b.set(e,{canvas:f,context:g})}g.clearRect(0,0,f.width,f.height);g.globalCompositeOperation="source-over";g.drawImage(a.image,a.sx,a.sy,a.sw,a.sh,0,0,a.w,a.h);g.globalCompositeOperation="source-in";g.drawImage(c.image,c.sx,c.sy,c.sw,c.sh,c.x-a.x,c.y-a.y,c.w,c.h);var h=g.getImageData(0,0,a.w,a.h).data;var i=false;for(var j=3,k=h.length;j<k;j+=3){if(h[j]!=0){i=true}}return i}Game.assign("actorCollision",function(b,d){var e=b.getFrame(0);var f=d.getFrame();var g=a(b,d,e,f);if(g){var h=Math.floor(e.height*.85);g.A.y+=h;g.A.sy+=h;g.A.h-=h;g.A.sh-=h;return c(g.A,g.B)}return false});Game.assign("skillCollision",function(b,d){var e=b.getFrame();var f=d.getFrame();var g=a(b,d,e,f);if(g){return c(g.A,g.B)}return false})})();"use strict";(function(){"use strict";var a=new Map;Game.assign("popup",function(b,c){var d=arguments.length<=2||arguments[2]===undefined?0:arguments[2];var e=arguments.length<=3||arguments[3]===undefined?0:arguments[3];if(a.has(b)){var f=a.get(b);Game.layers.dialogueLayer.removeChild(f.container);clearInterval(f.timer);a["delete"](b)}var g=new Sprite.Text({text:c,maxWidth:200});var h=g.width;var i=g.height;var j=Math.round((h+10)/2);var k=new Sprite.Shape;k.polygon({points:"0,0 "+(h+10)+",0 "+(h+10)+","+(i+10)+" "+(j+5)+","+(i+10)+" "+j+","+(i+15)+" "+(j-5)+","+(i+10)+" 0,"+(i+10)+" 0,0",fill:"white"});var l=new Sprite.Container;l.appendChild(k,g);g.x=5;g.y=5;l.x=b.x+d;l.y=b.y+e;l.centerX=j;l.centerY=i+15;Game.layers.dialogueLayer.appendChild(l);if(b instanceof Sprite.Event){b.on("change",function(){l.x=b.x+d;l.y=b.y+e})}var m=setTimeout(function(){if(a.has(b)){var c=a.get(b);Game.layers.dialogueLayer.removeChild(c.container);a["delete"](b)}},3e3);a.set(b,{container:l,timer:m})})})();"use strict";(function(){"use strict";function a(){return new Promise(function(a,b){var c=new Set;var d={hurt:"sound/effect/hurt.ogg"};for(var e in d){c.add(function(a,b){return new Promise(function(c,d){if(Game.sounds&&Game.sounds[a]){c()}else{Sprite.load(b).then(function(b){Game.sounds[a]=b[0];c()})}})}(e,d[e]))}var f=["bag","gold"];f.forEach(function(a){c.add(new Promise(function(b,c){if(Game.items&&Game.items[a]){b()}else{Game.Item.load(a).then(function(a){b()})}}))});Promise.all(c).then(function(){a()})})}Game.assign("loadArea",function(b){return new Promise(function(c,d){Game.Map.load(b).then(function(b){var d={actors:new Set,bags:new Set,items:new Set,touch:[],onto:[],map:b};var e=new Set;e.add(a());if(b.data.actors){b.data.actors.forEach(function(a){e.add(new Promise(function(b,c){Game.Actor.load(a.id).then(function(c){for(var e in a){c.data[e]=a[e]}d.actors.add(c);c.draw();b()})}))})}if(b.spawnMonster&&b.spawnMonster.list&&b.spawnMonster.count){var f=function(a){e.add(new Promise(function(b,c){Game.Actor.load(a).then(function(){
b()})}))};for(var g in b.spawnMonster.list){f(g)}}if(b.spawnItem&&b.spawnItem.list&&b.spawnItem.count){var h=function(a){e.add(new Promise(function(b,c){Game.Item.load(a).then(function(){b()})}))};for(var i in b.spawnItem.list){h(i)}}if(b.data.onto){b.data.onto.forEach(function(a){d.onto.push(a)})}if(b.data.touch){b.data.touch.forEach(function(a){d.touch.push(a)})}Promise.all(e).then(function(){c(d)})})})})})();"use strict";var _slicedToArray=function(){function a(a,b){var c=[];var d=true;var e=false;var f=undefined;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=true){c.push(h.value);if(b&&c.length===b)break}}catch(i){e=true;f=i}finally{try{if(!d&&g["return"])g["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b)){return b}else if(Symbol.iterator in Object(b)){return a(b,c)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function m(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("Map",function(b){_inherits(c,b);_createClass(c,[{key:"hitTest",value:function d(b,c){if(a(this).blockedMap[b*1e4+c]){return true}return false}},{key:"hitWater",value:function e(b,c){if(a(this).waterMap[b*1e4+c]){return true}return false}},{key:"blockedMap",get:function f(){return a(this).blockedMap},set:function g(a){throw new Error("Game.Map.blockedMap readonly")}}],[{key:"load",value:function h(a){return new Promise(function(b,c){Sprite.load("map/"+a+".json","map/"+a+".js").then(function(c){var d=_slicedToArray(c,2);var e=d[0];var f=d[1];f=f();e.id=a;for(var g in f){if(e.hasOwnProperty(g)){console.log(g,e[g],f[g],f,e);throw new Error("Game.loadArea invalid data")}e[g]=f[g]}var h=new Game.Map(e);h.on("complete",function(){b(h)})})})}}]);function c(b){var d=this;_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var e=a(this);e.data=b;var f=[];var g=true;var h=false;var i=undefined;try{for(var j=e.data.tilesets[Symbol.iterator](),k;!(g=(k=j.next()).done);g=true){var l=k.value;f.push("map/"+l.image)}}catch(m){h=true;i=m}finally{try{if(!g&&j["return"]){j["return"]()}}finally{if(h){throw i}}}Sprite.load(f).then(function(a){e.data.tilesets=null;e.sheet=new Sprite.Sheet({images:a,width:e.data.tilewidth,height:e.data.tileheight});e.waterMap={};e.blockedMap={};e.layers=[];var b=true;var c=false;var f=undefined;try{for(var g=e.data.layers[Symbol.iterator](),h;!(b=(h=g.next()).done);b=true){var i=h.value;var j=null;if(i.name!="block"){j=new Sprite.Container;j.name=i.name;e.layers.push(j)}var k=d.col;var l=d.row;for(var m=0;m<l;m++){for(var n=0;n<k;n++){var o=n+m*k;var p=n*1e4+m;var q=i.data[o]-1;if(q>=0){if(i.name=="block"){e.blockedMap[p]=true}else{var r=e.sheet.getFrame(q);r.x=n*e.data.tilewidth;r.y=m*e.data.tileheight;j.appendChild(r);if(i.name=="water"){e.waterMap[p]=true}}}}}}}catch(s){c=true;f=s}finally{try{if(!b&&g["return"]){g["return"]()}}finally{if(c){throw f}}}d.emit("complete",true)})}_createClass(c,[{key:"tile",value:function i(a,b){if(Number.isFinite(a)&&Number.isFinite(b)){return{x:Math.floor(a/this.data.tilewidth),y:Math.floor(b/this.data.tileheight)}}else{console.error(a,b,this.data);throw new Error("Game.Map.tile got invalid arguments")}}},{key:"draw",value:function j(){var b=this;var c=a(this);Game.layers.mapLayer.clear();Game.layers.mapHideLayer.clear();c.layers.forEach(function(a,b){var d=c.data.layers[b];if(Number.isFinite(d.opacity)){a.alpha=d.opacity}Game.layers.mapLayer.appendChild(a)});c.layers=null;c.data.layers=null;Game.layers.mapLayer.cache();var d=new Sprite.Bitmap(Game.layers.mapLayer.cacheCanvas);Game.layers.mapLayer.clear();Game.layers.mapLayer.appendChild(d);var e=document.createElement("canvas");e.width=this.col*8;e.height=this.row*8;var f=e.getContext("2d");f.drawImage(d.image,0,0,d.width,d.height,0,0,e.width,e.height);c.minimap=e;if(c.data.bgm){}var g={};if(c.data.actors){var h=true;var i=false;var j=undefined;try{for(var k=c.data.actors[Symbol.iterator](),l;!(h=(l=k.next()).done);h=true){var m=l.value;g[m.x*1e4+m.y]=true}}catch(n){i=true;j=n}finally{try{if(!h&&k["return"]){k["return"]()}}finally{if(i){throw j}}}}if(c.data.spawnMonster&&c.data.spawnMonster.list&&c.data.spawnMonster.count){for(var o=0,p=c.data.spawnMonster.count;o<p;o++){var q=null;var r=0;var s=Math.random();for(var t in c.data.spawnMonster.list){r+=c.data.spawnMonster.list[t];if(s<r){q=t;break}}if(!q){q=Object.keys(c.data.spawnMonster.list)[0]}Game.Actor.load(q).then(function(a){var c=undefined,d=undefined;while(true){c=Sprite.rand(0,b.col);d=Sprite.rand(0,b.row);if(!b.hitTest(c,d)&&!g[c*1e4+d]){break}}g[c*1e4+d]=true;a.x=c;a.y=d;Game.area.actors.add(a);a.draw()})}}if(c.data.spawnItem&&c.data.spawnItem.list&&c.data.spawnItem.count){var u=function(a,d){var e=null;var f=0;var h=Math.random();for(var i in c.data.spawnItem.list){f+=c.data.spawnItem.list[i];if(h<f){e=i;break}}if(!e){e=Object.keys(c.data.spawnItem.list)[0]}Game.Item.load(e).then(function(a){var c=undefined,d=undefined;while(true){c=Sprite.rand(0,b.col);d=Sprite.rand(0,b.row);if(!b.hitTest(c,d)&&!g[c*1e4+d]){break}}g[c*1e4+d]=true;a.x=c;a.y=d;a.inner={};a.inner[e]=1;Game.area.items.add(a);a.draw()})};for(var o=0,p=c.data.spawnItem.count;o<p;o++){u(o,p)}}}},{key:"data",get:function k(){return a(this).data},set:function l(a){throw new Error("Game.Map.data readonly")}},{key:"id",get:function m(){return a(this).id},set:function n(a){throw new Error("Game.Map.id readonly")}},{key:"width",get:function o(){return this.data.width*this.data.tilewidth},set:function p(a){throw new Error("Game.Map.width readonly")}},{key:"height",get:function q(){return this.data.height*this.data.tileheight},set:function r(a){throw new Error("Game.Map.height readonly")}},{key:"col",get:function s(){return this.data.width},set:function t(a){throw new Error("Game.Map.col readonly")}},{key:"row",get:function u(){return this.data.height},set:function v(a){throw new Error("Game.Map.row readonly")}},{key:"minimap",get:function w(){return a(this).minimap},set:function x(a){throw new Error("Game.Map.minimap readonly")}}]);return c}(Sprite.Event))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";Game.assign("Quest",function(){function a(){_classCallCheck(this,a)}_createClass(a,null,[{key:"load",value:function b(a){return new Promise(function(b,c){Sprite.load("quest/"+a+".js").then(function(c){var d=c[0]();d.id=a;b(d)})})}},{key:"isComplete",value:function c(a){if(a.target){if(a.target.kill){var b=true;var c=false;var d=undefined;try{for(var e=a.target.kill[Symbol.iterator](),f;!(b=(f=e.next()).done);b=true){var g=f.value;if(g.current<g.need){return false}}}catch(h){c=true;d=h}finally{try{if(!b&&e["return"]){e["return"]()}}finally{if(c){throw d}}}}}return true}}]);return a}())})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function n(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("Item",function(b){_inherits(c,b);_createClass(c,null,[{key:"load",value:function d(a){return new Promise(function(b,c){Sprite.load("item/"+a+".js").then(function(c){var d=c[0]();d.id=a;var e=new Game.Item(d);Game.items[a]=e;e.on("complete",function(){b(e)})})})}}]);function c(b){var d=this;_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var e=a(this);e.data=b;e.inner=null;if(!this.data.x||!this.data.y){this.data.x=0;this.data.y=0}if(this.data.image){Sprite.load("item/"+this.data.image).then(function(a){var b=a[0];e.icon=b;e.bitmap=new Sprite.Bitmap(b);e.bitmap.x=d.data.x*32+16;e.bitmap.y=d.data.y*32+16;e.bitmap.name=d.id;if(Number.isInteger(d.data.centerX)&&Number.isInteger(d.data.centerY)){e.bitmap.centerX=d.data.centerX;e.bitmap.centerY=d.data.centerY}else{console.log(d.data);throw new Error("Game.Item invalid centerX/centerY")}d.emit("complete",true)})}else{this.emit("complete",true)}}_createClass(c,[{key:"hitTest",value:function e(a,b){if(this.data.hitArea&&this.data.hitArea instanceof Array){var c=true;var d=false;var e=undefined;try{for(var f=this.data.hitArea[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;if(a==this.x+h[0]&&b==this.y+h[1]){return true}}}catch(i){d=true;e=i}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}return false}else{console.error(this.data);throw new Error("Game.Actor.hitTest invalid data")}}},{key:"heroUse",value:function f(){if(this.inner){if(this.data.pickupCondition){if(this.data.pickupCondition()){Game.windows.pickup.open(this)}else{}}else{Game.windows.pickup.open(this)}}if(typeof this.data.use=="function"){this.data.use()}if(this.data.type=="potion"){for(var a in this.data.potion){var b=this.data.potion[a];if(a=="hp"){(function(){Game.hero.data.hp=Math.min(Game.hero.data.hp+b,Game.hero.data.$hp);var a=new Sprite.Text({text:"hp+"+b,color:"black",fontSize:20});a.centerX=Math.floor(a.width/2);a.centerY=Math.floor(a.height);a.x=Game.hero.sprite.x;a.y=Game.hero.sprite.y;Game.layers.actorLayer.appendChild(a);Sprite.Ticker.whiles(100,function(b){a.y-=3;if(b){Game.layers.actorLayer.removeChild(a)}})})()}}Game.hero.data.items[this.id]--;if(Game.hero.data.items[this.id]<=0){delete Game.hero.data.items[this.id]}}}},{key:"erase",value:function g(b){Game.layers.itemLayer.removeChild(a(this).bitmap)}},{key:"draw",value:function h(){Game.layers.itemLayer.appendChild(a(this).bitmap)}},{key:"id",get:function i(){return a(this).data.id},set:function j(a){throw new Error("Game.Item.id readonly")}},{key:"icon",get:function k(){if(a(this).bitmap){return a(this).bitmap.image}return null},set:function l(a){throw new Error("Game.Item.icon readonly")}},{key:"data",get:function m(){return a(this).data},set:function n(a){console.error(this);throw new Error("Game.Item.data readonly")}},{key:"inner",get:function o(){return a(this).inner},set:function p(b){a(this).inner=b}},{key:"x",get:function q(){return a(this).data.x},set:function r(b){var c=a(this);c.data.x=b;c.bitmap.x=b*32+16}},{key:"y",get:function s(){return a(this).data.y},set:function t(b){var c=a(this);c.data.y=b;c.bitmap.y=b*32+16}},{key:"visible",get:function u(){return a(this).bitmap.visible},set:function v(b){a(this).bitmap.visible=b}},{key:"alpha",get:function w(){return a(this).bitmap.alpha},set:function x(b){if(Number.isFinite(b)&&b>=0&&b<=1){a(this).bitmap.alpha=b}else{console.error(b,this);throw new Error("Game.Item.alpha got invalid value")}}},{key:"position",get:function y(){return{x:this.x,y:this.y}},set:function z(a){console.error(this.data);throw new Error("Game.Item.position readonly")}}]);return c}(Sprite.Event))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function o(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("Skill",function(b){_inherits(c,b);_createClass(c,null,[{key:"load",value:function d(a){return new Promise(function(b,c){Sprite.load("skill/"+a+".js").then(function(c){var d=c[0]();var e=new Game.Skill(d);Game.skills[a]=e;e.on("complete",function(){b(e)})})})}}]);function c(b){var d=this;_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var e=a(this);e.data=b;Sprite.load("skill/"+this.data.image,"skill/"+this.data.icon,"skill/"+this.data.sound).then(function(a){var b=a[0];e.icon=a[1];e.sound=a[2];var c=new Sprite.Sheet({images:[b],width:d.data.tilewidth,height:d.data.tileheight,animations:d.data.animations});c.centerX=Math.floor(d.data.tilewidth/2);c.centerY=Math.floor(d.data.tileheight/2);if(d.data.alpha){c.alpha=d.data.alpha}e.sprite=c;d.emit("complete",true)})}_createClass(c,[{key:"fire",value:function e(b,c,d){var e=this;var f=a(this);if(f.sound){f.sound.load();f.sound.play()}var g="attack"+c;var h=this.data.animations[g];var i=f.sprite.clone();i.x=b.facePosition.x*32+16;i.y=b.facePosition.y*32+16;if(Number.isFinite(h.centerX)&&Number.isFinite(h.centerY)){i.centerX=h.centerX;i.centerY=h.centerY}else{console.error(h,this.data);throw new Error("Game.Skill.fire invalid centerX/centerY")}var j=0;var k=[];var l=function o(){var a=Game.area.map.tile(i.x,i.y);var c=true;var d=false;var e=undefined;try{for(var f=Game.area.actors[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;if(h!=b&&k.length<=0){if(h.hitTest(a.x,a.y)){k.push(h)}}}}catch(j){d=true;e=j}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}};var m=Sprite.Ticker.on("tick",function(){if(e.data.distance>0){j+=4}switch(g){case"attackdown":i.y+=j;break;case"attackleft":i.x-=j;break;case"attackright":i.x+=j;break;case"attackup":i.y-=j;break}l();var a=Game.area.map.tile(i.x,i.y);if(Game.area.map.hitTest(a.x,a.y)){n()}if(k.length>0){n()}if(e.data.distance>0&&j>=e.data.distance){n()}});var n=function p(){Sprite.Ticker.off("tick",m);if(k.length>0&&e.data.animations["hitted"]){var a=k[0];i.x=a.sprite.x;i.y=a.sprite.y;i.play("hitted");if(i.paused==true){Game.layers.skillLayer.removeChild(i)}else{i.on("animationend",function(){Game.layers.skillLayer.removeChild(i)})}}else{if(i.paused==true){Game.layers.skillLayer.removeChild(i)}else{i.on("animationend",function(){Game.layers.skillLayer.removeChild(i)})}}if(d){d(k)}};Game.layers.skillLayer.appendChild(i);i.play(g);if(this.data.animations[g].actor&&b.data.animations[this.data.animations[g].actor]){b.play(this.data.animations[g].actor,3)}else{b.play("face"+c,0);b.play("attack"+c,3)}}},{key:"id",get:function f(){return a(this).data.id},set:function g(a){throw new Error("Game.Skill.id readonly")}},{key:"icon",get:function h(){return a(this).icon},set:function i(a){throw new Error("Game.Skill.icon readonly")}},{key:"data",get:function j(){return a(this).data},set:function k(a){console.error(this);throw new Error("Game.Skill.data readonly")}},{key:"power",get:function l(){if(Number.isFinite(this.data.power)){return this.data.power}else if(typeof this.data.power=="string"){var a=this.data.power.match(/(\d+)d(\d+)/);if(!a){console.error(this.data.power,this.data);throw new Error("Sprite.Skill got invalid power data")}var b=parseInt(a[1]);var c=parseInt(a[2]);var d=0;for(var e=0;e<b;e++){d+=Sprite.rand(0,c)+1}return d}else{console.error(this.data.power,this.data);throw new Error("Game.Skill.power invalid power")}},set:function m(a){throw new Error("Game.Skill.power readonly")}},{key:"type",get:function n(){return this.data.type},set:function o(a){throw new Error("Game.Skill.type readonly")}}]);return c}(Sprite.Event))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function p(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("Actor",function(b){_inherits(c,b);_createClass(c,null,[{key:"load",value:function d(a){return new Promise(function(b,c){Sprite.load("actor/"+a+".js").then(function(c){var d=c[0]();d.id=a;var e=null;if(d.type=="npc"){e=new Game.ActorNPC(d)}else if(d.type=="monster"){e=new Game.ActorMonster(d)}else if(d.type=="ally"){e=new Game.ActorAlly(d)}else if(d.type=="pet"){e=new Game.ActorPet(d)}else{console.error(d.type,d);throw new Error("Game.Actor.load invalid actor type")}e.on("complete",function(){b(e)})})})}}]);function c(b){var d=this;_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var e=a(this);e.data=b;this.makeInfoBox();if(this.data.image instanceof Array){this.init(this.data.image)}else if(typeof this.data.image=="string"){Sprite.load("actor/"+this.data.image).then(function(a){d.init(a)})}else{console.error(this.id,this.data,this.data.image,this);throw new Error("Invalid Actor Image")}}_createClass(c,[{key:"init",value:function e(b){var c=this;var d=a(this);var e=d.data;var f=true;var g=false;var h=undefined;try{for(var i=b[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;if(!(k instanceof Image)&&!(k.getContext&&k.getContext("2d"))){console.error(k,b,this);throw new Error("Game.Actor got invalid image, not Image or Canvas")}}}catch(l){g=true;h=l}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}var m=new Sprite.Sheet({images:b,width:e.tilewidth,height:e.tileheight,animations:e.animations});if(Number.isInteger(e.centerX)&&Number.isInteger(e.centerY)){m.centerX=e.centerX;m.centerY=e.centerY}else{console.log(e);throw new Error("Game.Actor invalid centerX/centerY")}m.play("facedown");d.sprite=m;m.on("change",function(){d.infoBox.x=m.x;d.infoBox.y=m.y-m.centerY-20});var n=-1;var o=function r(){n++;if(n>=0){c.calculate();c.refreshBar();c.emit("complete",true)}};if(e.quest){d.quest=[];d.quest.length=e.quest.length;e.quest.forEach(function(a,b){n--;Game.Quest.load(a).then(function(a){d.quest.push(a);o()})})}if(e.skills){e.skills.forEach(function(a){n--;Game.Skill.load(a).then(function(){o()})})}if(e.equipment){for(var p in e.equipment){var q=e.equipment[p];if(q){n--;Game.Item.load(q).then(function(){o()})}}}if(e.items){for(var q in e.items){n--;Game.Item.load(q).then(function(){o()})}}o()}},{key:"popup",value:function f(a){Game.popup(this.sprite,a,0,-50)}},{key:"makeInfoBox",value:function g(){var b=a(this);var c=new Sprite.Text({text:b.data.name,maxWidth:200,color:"white",fontSize:12});c.centerY=Math.floor(c.height/2);c.centerX=Math.floor(c.width/2);c.x=0;c.y=0;b.infoBox=new Sprite.Container;if(b.data.type!="hero"){var d=new Sprite.Shape;d.centerX=15;d.centerY=2;d.x=0;d.y=9;var e=new Sprite.Shape;e.centerX=15;e.centerY=2;e.x=0;e.y=12;d.rect({x:0,y:0,width:30,height:3,"fill-opacity":0});e.rect({x:0,y:0,width:30,height:3,"fill-opacity":0});b.hpbar=new Sprite.Shape;b.hpbar.centerX=15;b.hpbar.centerY=2;b.hpbar.x=0;b.hpbar.y=9;b.mpbar=new Sprite.Shape;b.mpbar.centerX=15;b.mpbar.centerY=2;b.mpbar.x=0;b.mpbar.y=12;b.infoBox.appendChild(c,d,e,b.hpbar,b.mpbar)}}},{key:"calculate",value:function h(){var b=a(this).data;if(b.$str&&b.$dex&&b.$con&&b.$int&&b.$cha){b.str=b.$str;b.dex=b.$dex;b.con=b.$con;b.int=b.$int;b.cha=b.$cha;b.$hp=b.con*5;b.$sp=b.int*5;b.atk=Math.floor(b.str*.25);b.matk=Math.floor(b.int*.25);b.def=0;b.mdef=0;b.critical=b.dex*.005;b.dodge=b.dex*.005;b.hp=b.$hp;b.sp=b.$sp;if(b.buff&&b.nerf){b.buff.forEach(function(a){});b.nerf.forEach(function(a){})}}}},{key:"refreshBar",value:function i(){var b=a(this);if(b.hpbar&&b.mpbar){var c="green";if(this.data.hp/this.data.$hp<.25)c="red";else if(this.data.hp/this.data.$hp<.5)c="yellow";b.hpbar.clear().rect({x:1,y:1,width:Math.floor(this.data.hp/this.data.$hp*28),height:2,fill:c,"stroke-width":0});b.mpbar.clear().rect({x:1,y:1,width:Math.floor(this.data.sp/this.data.$sp*28),height:2,fill:"blue","stroke-width":0})}}},{key:"distance",value:function j(){var a=null,b=null;if(arguments.length==2&&Number.isFinite(arguments[0])&&Number.isFinite(arguments[1])){a=arguments[0];b=arguments[1]}else if(arguments.length==1&&Number.isFinite(arguments[0].x)&&Number.isFinite(arguments[0].y)){a=arguments[0].x;b=arguments[0].y}else{console.error(arguments);throw new Error("Game.Actor.distance Invalid arguments")}var c=0;c+=Math.pow(this.x-a,2);c+=Math.pow(this.y-b,2);c=Math.sqrt(c);return c}},{key:"decreaseHP",value:function k(a){this.data.hp-=a;this.refreshBar()}},{key:"decreaseSP",value:function l(a){this.data.sp-=a;this.refreshBar()}},{key:"dead",value:function m(a){var b=this;if(this.data.hp<=0){if(this.data.type=="hero"){Game.windows.over.open("你被"+a.data.name+"打死了")}else{(function(){b.erase();Game.area.actors["delete"](b);var c=b.data.items||{gold:1};Game.addBag(b.x,b.y).then(function(a){for(var b in c){if(a.inner.hasOwnProperty(b)){a.inner[b]+=c[b]}else{a.inner[b]=c[b]}}});a.emit("kill",false,b)})()}}}},{key:"flash",value:function n(){var a=this;this.sprite.alpha=.5;Sprite.Ticker.after(10,function(){a.sprite.alpha=1})}},{key:"damage",value:function o(a,b){this.emit("damaged");var c=b.power;var d=b.type;var e="white";if(this.data.type=="hero"){e="red"}if(d=="normal"){c+=a.data.atk;c-=this.data.def;c=Math.max(0,c)}else{c+=a.data.matk;c-this.data.mdef;c=Math.max(0,c)}var f=null;var g=null;if(Math.random()<this.data.dodge){g="dodge";f=new Sprite.Text({text:"miss",color:e,fontSize:16})}else if(Math.random()<a.data.critical){g="critical";c*=2;f=new Sprite.Text({text:"-"+c,color:e,fontSize:32});this.flash();this.decreaseHP(c)}else{g="hit";f=new Sprite.Text({text:"-"+c,color:e,fontSize:16});this.flash();this.decreaseHP(c)}f.centerX=Math.floor(f.width/2);f.centerY=Math.floor(f.height);f.x=this.sprite.x;f.y=this.sprite.y;f.x+=Sprite.rand(-10,10);Game.layers.actorLayer.appendChild(f);var h=Sprite.rand(1,3);Sprite.Ticker.whiles(100,function(a){f.y-=h;if(a){Game.layers.actorLayer.removeChild(f)}});this.dead(a)}},{key:"play",value:function p(a,b){if(!Number.isFinite(b)){b=0}if(typeof this.animationPriority=="undefined"||this.sprite.paused==true){this.animationPriority=-1}if(this.data.animations.hasOwnProperty(a)&&b>=this.animationPriority&&a!=this.sprite.currentAnimation){this.animationPriority=b;this.sprite.play(a)}}},{key:"stop",value:function q(){if(!this.sprite.currentAnimation)return;if(this.sprite.paused&&!this.sprite.currentAnimation.match(/face/)||this.sprite.currentAnimation.match(/walk|run/)){switch(this.direction){case"up":this.sprite.play("faceup");break;case"down":this.sprite.play("facedown");break;case"left":this.sprite.play("faceleft");break;case"right":this.sprite.play("faceright");break}}}},{key:"fire",value:function r(a,b){var c=this;if(this.attacking)return 0;var d=Game.skills[a];if(!d)return 0;var e=(new Date).getTime();if(Number.isFinite(this.lastAttack)&&Number.isFinite(this.lastAttackCooldown)&&e-this.lastAttack<this.lastAttackCooldown){return 0}if(d.data.cost>this.data.sp){return 0}if(!b){b=this.direction}if(this.type=="hero"&&d.data.condition&&d.data.condition()==false){return 0}this.lastAttack=e;this.lastAttackCooldown=d.data.cooldown;this.attacking=true;this.data.sp-=d.data.cost;this.refreshBar();d.fire(this,b,function(a){c.attacking=false;if(a.length>0){a[0].damage(c,d)}c.emit("change")});return d.data.cooldown}},{key:"goto",value:function s(a,b,c){var d=this;return new Promise(function(e,f){if(d.going){d.goingNext=function(){d.goto(a,b,c).then(e)};return false}var g=d.checkCollision(a,b);if(g){if(d.x==a){if(d.y-b==-1){d.stop();d.face("down");e();return false}else if(d.y-b==1){d.stop();d.face("up");e();return false}}else if(d.y==b){if(d.x-a==-1){d.stop();d.face("right");e();return false}else if(d.x-a==1){d.stop();d.face("left");e();return false}}}var h=[];if(d.checkCollision(a,b-1)==false){h.push({x:a,y:b-1,after:"down"})}if(d.checkCollision(a,b+1)==false){h.push({x:a,y:b+1,after:"up"})}if(d.checkCollision(a-1,b)==false){h.push({x:a-1,y:b,after:"right"})}if(d.checkCollision(a+1,b)==false){h.push({x:a+1,y:b,after:"left"})}var i=true;var j=false;var k=undefined;try{for(var l=h[Symbol.iterator](),m;!(i=(m=l.next()).done);i=true){var n=m.value;n.distance=d.distance(n.x,n.y)}}catch(o){j=true;k=o}finally{try{if(!i&&l["return"]){l["return"]()}}finally{if(j){throw k}}}h.sort(function(a,b){return a.distance-b.distance});if(d.checkCollision(a,b)==false){h.splice(0,0,{x:a,y:b})}var p=0;var q=false;var r=function s(){if(p<h.length){(function(){var a=h[p];p++;Game.Astar.getPath({x:d.x,y:d.y},a).then(function(b){d.gettingPath=false;if(d.goingNext){var f=d.goingNext;d.goingNext=null;d.going=false;if(d==Game.hero){Game.Input.clearDest()}f();return false}if(d.going){return false}if(b){if(d==Game.hero){Game.Input.setDest(a.x,a.y)}else{if(b.length>30){return false}}d.gotoPath(b,c,a.after).then(e);return true}else{return s()}})})()}else{if(q==false){q=true;var f=[];if(d.checkCollision(a-1,b-1)==false){f.push({x:a-1,y:b-1,after:"right"})}if(d.checkCollision(a+1,b-1)==false){f.push({x:a+1,y:b-1,after:"left"})}if(d.checkCollision(a-1,b+1)==false){f.push({x:a-1,y:b+1,after:"right"})}if(d.checkCollision(a+1,b+1)==false){f.push({x:a+1,y:b+1,after:"left"})}if(d.checkCollision(a,b-2)==false){f.push({x:a,y:b-2,after:"down"})}if(d.checkCollision(a,b+2)==false){f.push({x:a,y:b+2,after:"up"})}if(d.checkCollision(a-2,b)==false){f.push({x:a-2,y:b,after:"right"})}if(d.checkCollision(a+2,b)==false){f.push({x:a+2,y:b,after:"left"})}var g=true;var i=false;var j=undefined;try{for(var k=f[Symbol.iterator](),l;!(g=(l=k.next()).done);g=true){var m=l.value;m.distance=d.distance(m.x,m.y)}}catch(n){i=true;j=n}finally{try{if(!g&&k["return"]){k["return"]()}}finally{if(i){throw j}}}f.sort(function(a,b){return a.distance-b.distance});if(f.length){p=0;h=f;s()}}}};return r()})}},{key:"gotoPath",value:function t(a,b,c){var d=this;return new Promise(function(e,f){d.going=true;var g=1;var h=function i(){if(Game.paused){d.stop();d.going=false;if(d==Game.hero){Game.Input.clearDest()}return}if(d.goingNext){var f=d.goingNext;d.goingNext=null;d.going=false;if(d==Game.hero){Game.Input.clearDest()}f();return}if(g<a.length){var h={x:d.x,y:d.y};var j=a[g];var k=null;if(j.x==h.x){if(j.y>h.y){k="down"}else if(j.y<h.y){k="up"}}else if(j.y==h.y){if(j.x>h.x){k="right"}else if(j.x<h.x){k="left"}}if(k){var l=d.direction;if(k!=l){d.stop();d.face(k)}d.go(b,k).then(function(){i()});g++}}else{if(c){d.stop();d.face(c)}if(d==Game.hero){Game.Input.clearDest()}d.going=false;e()}};h()})}},{key:"face",value:function u(a){var b="face"+a;if(this.animation!=b){this.sprite.play(b);this.emit("change")}}},{key:"checkCollision",value:function v(a,b){if(a<0||b<0||a>=Game.area.map.data.width||b>=Game.area.map.data.height){return true}if(Game.area.map.hitTest(a,b)){return true}if(Game.area.actors){var c=true;var d=false;var e=undefined;try{for(var f=Game.area.actors[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;if(h!=this&&h.hitTest(a,b)){return true}}}catch(i){d=true;e=i}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}}if(Game.area.items){var j=true;var k=false;var l=undefined;try{for(var m=Game.area.items[Symbol.iterator](),n;!(j=(n=m.next()).done);j=true){var o=n.value;if(o.hitTest(a,b)){return true}}}catch(i){k=true;l=i}finally{try{if(!j&&m["return"]){m["return"]()}}finally{if(k){throw l}}}}return false}},{key:"hitTest",value:function w(a,b){if(this.data.hitArea&&this.data.hitArea instanceof Array){var c=true;var d=false;var e=undefined;try{for(var f=this.data.hitArea[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;if(a==this.x+h[0]&&b==this.y+h[1]){return true}}}catch(i){d=true;e=i}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}return false}else{console.error(this.data);throw new Error("Game.Actor.hitTest invalid data")}}},{key:"go",value:function x(a,b){var c=this;return new Promise(function(d,e){if(Game.paused){return}if(c.sprite.paused==false&&c.sprite.currentAnimation.match(/skillcast|thrust|slash|shoot/)){return}if(c.walking){return}if(c.attacking){return}if(c.direction!=b){c.walking=true;c.stop();c.face(b);Sprite.Ticker.after(4,function(){c.walking=false});return}var f=c.facePosition;if(c.checkCollision(f.x,f.y)==false){(function(){c.walking=true;var e=c.data.x;var g=c.data.y;c.data.x=f.x;c.data.y=f.y;var h=[3,3,2,3,3,2,3,3,2,3,3,2];if(a=="run"){h=[4,4,4,4,4,4,4,4]}var i=Sprite.Ticker.whiles(h.length,function(a){if(Game.paused){c.data.x=e;c.data.y=g;c.walking=false;c.emit("change");Sprite.Ticker.clearWhiles(i);d();return}if(a){c.x=f.x;c.y=f.y;c.walking=false;c.emit("change");d()}else{switch(b){case"up":c.sprite.y-=h.pop();break;case"down":c.sprite.y+=h.pop();break;case"left":c.sprite.x-=h.pop();break;case"right":c.sprite.x+=h.pop();break}}});c.play(a+b,1)})()}})}},{key:"erase",value:function y(){var b=a(this);Game.layers.actorLayer.removeChild(this.sprite);Game.layers.infoLayer.removeChild(b.infoBox)}},{key:"draw",value:function z(){var b=a(this);if(Number.isInteger(this.x)&&Number.isInteger(this.y)){
this.x=this.data.x;this.y=this.data.y;a(this).infoBox.x=this.sprite.x;a(this).infoBox.y=this.sprite.y-this.sprite.centerY-20;Game.layers.actorLayer.appendChild(this.sprite);Game.layers.infoLayer.appendChild(b.infoBox)}else{console.error(this.data.x,this.data.y,this.data);throw new Error("Game.Actor.draw invalid data.x/data.y")}}},{key:"focus",value:function A(){var b=a(this);b.infoBox.x=this.sprite.x;b.infoBox.y=this.sprite.y-this.sprite.centerY-20;Game.stage.centerX=Math.round(this.sprite.x-Game.config.width/2);Game.stage.centerY=Math.round(this.sprite.y-Game.config.height/2)}},{key:"data",get:function B(){var b=a(this);return b.data},set:function C(a){throw new Error("Game.Actor.data readonly")}},{key:"id",get:function D(){return a(this).data.id},set:function E(a){throw new Error("Game.Actor.id readonly")}},{key:"type",get:function F(){return a(this).data.type},set:function G(a){throw new Error("Game.Actor.type readonly")}},{key:"sprite",get:function H(){var b=a(this);return b.sprite},set:function I(a){throw new Error("Game.Actor.sprite readonly")}},{key:"quest",get:function J(){var b=a(this);if(b.quest){return b.quest}else{return null}},set:function K(a){throw new Error("Game.Actor.quests readonly")}},{key:"x",get:function L(){return this.data.x},set:function M(b){if(Number.isFinite(b)&&Number.isInteger(b)){this.data.x=b;this.sprite.x=b*32+16}else{console.error(b,a(this),this);throw new Error("Game.Actor got invalid x, x has to be a number and integer")}}},{key:"y",get:function N(){return this.data.y},set:function O(b){if(Number.isFinite(b)&&Number.isInteger(b)){this.data.y=b;this.sprite.y=b*32+16}else{console.error(b,a(this),this);throw new Error("Game.Actor got invalid y, y has to be a number and integer")}}},{key:"visible",get:function P(){return this.sprite.visible},set:function Q(b){this.sprite.visible=b;a(this).infoBox.visible=b}},{key:"alpha",get:function R(){return this.sprite.alpha},set:function S(b){if(Number.isFinite(b)&&b>=0&&b<=1){this.sprite.alpha=b;a(this).infoBox.alpha=b}else{console.error(b,this);throw new Error("Game.Actor.alpha got invalid value")}}},{key:"position",get:function T(){return{x:this.x,y:this.y}},set:function U(a){throw new Error("Game.Actor.position readonly")}},{key:"direction",get:function V(){return this.sprite.currentAnimation.match(/up|left|down|right/)[0]},set:function W(a){throw new Error("Game.Actor.direction readonly")}},{key:"facePosition",get:function X(){var a=this.position;switch(this.direction){case"up":a.y-=1;break;case"down":a.y+=1;break;case"left":a.x-=1;break;case"right":a.x+=1;break}return a},set:function Y(a){throw new Error("Game.Actor.facePosition readonly")}}]);return c}(Sprite.Event))})();"use strict";var _get=function q(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("ActorAlly",function(a){_inherits(b,a);function b(a){_classCallCheck(this,b);_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a)}return b}(Game.Actor))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function r(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("ActorHero",function(b){_inherits(c,b);function c(b){var d=this;_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,b);var e=a(this);e.ai=null;e.beAttacking=new Set;this.on("kill",function(a){var b=a.data;if(d.beAttacking.has(b)){d.beAttacking["delete"](b)}if(b.data.exp){d.data.exp+=b.data.exp}else{d.data.exp+=1}var c=true;var e=false;var f=undefined;try{for(var g=d.data.currentQuest[Symbol.iterator](),h;!(c=(h=g.next()).done);c=true){var i=h.value;if(i.target&&i.target.kill){var j=true;var k=false;var l=undefined;try{for(var m=i.target.kill[Symbol.iterator](),n;!(j=(n=m.next()).done);j=true){var o=n.value;if(b.id==o.id&&o.current<o.need){o.current++}}}catch(p){k=true;l=p}finally{try{if(!j&&m["return"]){m["return"]()}}finally{if(k){throw l}}}}}}catch(p){e=true;f=p}finally{try{if(!c&&g["return"]){g["return"]()}}finally{if(e){throw f}}}});this.on("change",function(){d.onto();d.touch()});setInterval(function(){if(!Game.paused){d.onto();d.touch()}},500)}_createClass(c,[{key:"hasItem",value:function d(a,b){if(Number.isFinite(b)==false||b<=0){b=1}for(var c in this.data.items){if(c==a){if(this.data.items[c]>=b){return true}else{return false}}}return false}},{key:"hasQuest",value:function e(a){var b=true;var c=false;var d=undefined;try{for(var e=this.data.currentQuest[Symbol.iterator](),f;!(b=(f=e.next()).done);b=true){var g=f.value;if(a==g.id){return true}}}catch(h){c=true;d=h}finally{try{if(!b&&e["return"]){e["return"]()}}finally{if(c){throw d}}}var i=true;var j=false;var k=undefined;try{for(var l=this.data.completeQuest[Symbol.iterator](),m;!(i=(m=l.next()).done);i=true){var g=m.value;if(a==g.id){return true}}}catch(h){j=true;k=h}finally{try{if(!i&&l["return"]){l["return"]()}}finally{if(j){throw k}}}return false}},{key:"damage",value:function f(a,b){var d=this;_get(Object.getPrototypeOf(c.prototype),"damage",this).call(this,a,b);var e=[];var f=true;var g=false;var h=undefined;try{for(var i=Game.area.actors[Symbol.iterator](),j;!(f=(j=i.next()).done);f=true){var k=j.value;if(k!=this&&k.data.type=="monster"&&k.distance(this)==1){e.push(k)}}}catch(l){g=true;h=l}finally{try{if(!f&&i["return"]){i["return"]()}}finally{if(g){throw h}}}if(e.length){(function(){var a=false;var b=d.facePosition;e.forEach(function(c){if(c.hitTest(b.x,b.y)){a=true}});if(a==false){d.goto(e[0].x,e[0].y)}})()}}},{key:"erase",value:function g(){var b=a(this);_get(Object.getPrototypeOf(c.prototype),"erase",this).call(this);if(b.ai){Sprite.Ticker.off("tick",b.ai);b.ai=null}}},{key:"refreshBar",value:function h(){_get(Object.getPrototypeOf(c.prototype),"refreshBar",this).call(this);Game.windows["interface"].status(this.data.hp/this.data.$hp,this.data.sp/this.data.$sp)}},{key:"draw",value:function i(){var b=this;var d=a(this);_get(Object.getPrototypeOf(c.prototype),"draw",this).call(this);d.ai=Sprite.Ticker.on("tick",function(a){var c=a.data;if(c%16==0){var d=false;if(b.data.hp<b.data.$hp&&b.beAttacking.size<=0){b.data.hp++;d=true}if(b.data.sp<b.data.$sp){b.data.sp++;d=true}if(d){b.refreshBar();if(Game.windows.status.atop){Game.windows.status.update()}}}})}},{key:"gotoArea",value:function j(b,c,d){var e=a(this);e.beAttacking=new Set;Game.pause();Game.windows["interface"].hide();Game.windows.stage.hide();Game.windows.loading.begin();Game.windows.loading.update("20%");setTimeout(function(){Game.clearStage();Game.windows.loading.update("50%");setTimeout(function(){Game.loadArea(b).then(function(a){Game.area=a;Game.windows.loading.update("80%");setTimeout(function(){Game.hero.data.area=b;Game.hero.draw();Game.hero.x=c;Game.hero.y=d;a.actors.add(Game.hero);a.map.draw();Game.windows.loading.update("100%");setTimeout(function(){Game.hero.x=c;Game.hero.y=d;Game.hero.data.time+=60;Game.windows.loading.end();Game.windows["interface"].datetime();Game.windows["interface"].refresh();Game.start();setTimeout(function(){Game.stage.update();Game.windows.stage.show();Game.windows["interface"].show()},5)},5)},5)})},5)},5)}},{key:"onto",value:function k(){if(!Game.area)return;if(!Game.area.onto)return;var a=Game.hero.position;var k=null;var b=function c(b){if(k!=null||b==Game.hero){return}if(b.hitTest&&b.hitTest(a.x,a.y)){k=b;return}else if(b.points){var c=true;var d=false;var e=undefined;try{for(var f=b.points[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;if(h.x==a.x&&h.y==a.y){k=b;return}}}catch(i){d=true;e=i}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}}else if(Number.isFinite(b.x)&&Number.isFinite(b.y)&&b.x==a.x&&b.y==a.y){k=b;return}};Sprite.each(Game.area.onto,b);if(k){if(k.execute){k.execute()}}}},{key:"touch",value:function l(){if(!Game.area)return;if(!Game.area.touch)return;var a=Game.hero.position;var b=Game.hero.facePosition;var l=null;var c=function e(b){if(l!=null||b==Game.hero){return}if(b.heroUse){if(b.hitTest&&b.hitTest(a.x,a.y)){l=b;return}else if(b.points){var c=true;var d=false;var e=undefined;try{for(var f=b.points[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;if(h.x==a.x&&h.y==a.y){l=b;return}}}catch(i){d=true;e=i}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}}else if(Number.isFinite(b.x)&&Number.isFinite(b.y)&&b.x==a.x&&b.y==a.y){l=b;return}}};var d=function f(a){if(l!=null||a==Game.hero){return}if(a.heroUse){if(a.hitTest&&a.hitTest(b.x,b.y)){l=a}else if(a.points){var c=true;var d=false;var e=undefined;try{for(var f=a.points[Symbol.iterator](),g;!(c=(g=f.next()).done);c=true){var h=g.value;if(h.x==b.x&&h.y==b.y){l=a;return}}}catch(i){d=true;e=i}finally{try{if(!c&&f["return"]){f["return"]()}}finally{if(d){throw e}}}}else if(Number.isFinite(a.x)&&Number.isFinite(a.y)&&a.x==b.x&&a.y==b.y){l=a;return}}};Sprite.each(Game.area.actors,c);Sprite.each(Game.area.bags,c);Sprite.each(Game.area.items,c);Game.area.touch.forEach(c);Sprite.each(Game.area.actors,d);Sprite.each(Game.area.bags,d);Sprite.each(Game.area.items,d);Game.area.touch.forEach(d);if(!l&&Game.area.map.hitWater(b.x,b.y)){l={type:"water",heroUse:function g(){Game.choice({"喝水":"drink","钓鱼":"fish"}).then(function(a){switch(a){case"drink":Game.hero.popup("drink");break;case"fish":Game.hero.popup("fish");break}})}}}if(!l){Game.hintObject=null;Game.windows["interface"].hideUse()}else{Game.hintObject=l;Game.windows["interface"].showUse()}}},{key:"beAttacking",get:function m(){return a(this).beAttacking},set:function n(a){throw new Error("Game.hero.beAttacking readonly")}}]);return c}(Game.Actor))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function s(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("ActorMonster",function(b){_inherits(c,b);function c(b){_classCallCheck(this,c);_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,b);var d=a(this);d.ai=null;d.attacking=false}_createClass(c,[{key:"damage",value:function d(b,e){_get(Object.getPrototypeOf(c.prototype),"damage",this).call(this,b,e);var f=a(this);if(f.attacking==false){this.goto(b.x,b.y,"walk")}}},{key:"erase",value:function e(){var b=a(this);_get(Object.getPrototypeOf(c.prototype),"erase",this).call(this);if(b.ai){Sprite.Ticker.off("tick",b.ai);b.ai=null}}},{key:"draw",value:function f(){var b=this;var d=a(this);_get(Object.getPrototypeOf(c.prototype),"draw",this).call(this);var e=Sprite.rand(30,60);d.ai=Sprite.Ticker.on("tick",function(a){if(Game.paused)return;var c=a.data;if(c%20==0){var f=false;if(b.data.hp<b.data.$hp&&d.attacking==false){b.data.hp++;f=true}if(b.data.sp<b.data.$sp){b.data.sp++;f=true}if(f){b.refreshBar()}}if(d.attacking){if(c%e==0){if(Game.hero&&b.facePosition.x==Game.hero.x&&b.facePosition.y==Game.hero.y){if(b.y==Game.hero.y){if(b.x<Game.hero.x){b.fire(b.data.skills[0],"right")}else{b.fire(b.data.skills[0],"left")}}else{if(b.y<Game.hero.y){b.fire(b.data.skills[0],"down")}else{b.fire(b.data.skills[0],"up")}}}}else if(Game.hero&&Game.hero.distance(b)<12){b.goto(Game.hero.x,Game.hero.y,"walk")}else{d.attacking=false;if(Game.hero.beAttacking.has(b)){Game.hero.beAttacking["delete"](b)}}}else{if(c%e==0){if(Game.hero&&Game.hero.distance(b)<8){b.goto(Game.hero.x,Game.hero.y,"walk");d.attacking=true;Game.hero.beAttacking.add(b)}else if(b.data.mode=="patrol"){if(Math.random()>.3){b.stop();return}var g=["down","left","right","up"];b.go("walk",g[Math.floor(Math.random()*g.length)]).then(function(){b.stop()})}}}})}}]);return c}(Game.Actor))})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var _get=function u(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("ActorNPC",function(a){_inherits(b,a);function b(a){_classCallCheck(this,b);_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a)}_createClass(b,[{key:"heroUse",value:function c(){var a=this;var b=this.data;var c={};var d={};if(b.contact){var e=true;var f=false;var g=undefined;try{for(var h=b.contact[Symbol.iterator](),i;!(e=(i=h.next()).done);e=true){var j=i.value;var k=true;if(typeof j.condition=="function"){try{k=j.condition()}catch(l){console.error(this.id,this.data);console.error(j.condition);console.error(j.condition.toString());throw l}}if(k){c[j.name]=j.name;d[j.name]=j}}}catch(m){f=true;g=m}finally{try{if(!e&&h["return"]){h["return"]()}}finally{if(f){throw g}}}}var n=null;if(this.quest){n=this.quest.filter(function(a){if(Game.hero.hasQuest(a.id)){return false}return true});if(n&&n.length){c["任务"]="quest"}}var o=null;if(Game.hero.data.currentQuest.length){o=[];var p=true;var q=false;var r=undefined;try{for(var s=Game.hero.data.currentQuest[Symbol.iterator](),t;!(p=(t=s.next()).done);p=true){var u=t.value;if(u.to==this.id&&Game.Quest.isComplete(u)){o.push(u)}}}catch(m){q=true;r=m}finally{try{if(!p&&s["return"]){s["return"]()}}finally{if(q){throw r}}}if(o.length>0){c["完成任务"]="completeQuest"}}if(b.trade&&b.items){c["交易"]="trade"}if(Object.keys(c).length<=0){return}Game.choice(c).then(function(c){switch(c){case"trade":a.heroUse();Game.windows.buy.open(b.items);break;case"quest":var e={};n.forEach(function(a,b){e[a.name]=b});Game.choice(e).then(function(b){if(Number.isInteger(b)){(function(){var c=n[b];Game.confirm({message:c.before,yes:"接受任务",no:"拒绝"}).then(function(){Game.hero.data.currentQuest.push(c);a.heroUse()})["catch"](function(){a.heroUse()})})()}else{a.heroUse()}});break;case"completeQuest":var f={};o.forEach(function(a,b){f[a.name]=b});Game.choice(f).then(function(c){if(Number.isInteger(c)){var d=o[c];Game.hero.data.currentQuest.splice(Game.hero.data.currentQuest.indexOf(d),1);Game.hero.data.completeQuest.push(d);a.heroUse();Game.dialogue([d.finish],b.name);if(d.reward){if(d.reward.gold){Game.hero.data.gold+=d.reward.gold}if(d.reward.exp){Game.hero.data.exp+=d.reward.exp}}}});break;default:if(d[c]){a.heroUse();Game.dialogue(d[c].content,b.name)}}})}}]);return b}(Game.Actor))})();"use strict";var _get=function v(a,b,c){var d=true;a:while(d){var e=a,f=b,g=c;h=i=j=undefined;d=false;if(e===null)e=Function.prototype;var h=Object.getOwnPropertyDescriptor(e,f);if(h===undefined){var i=Object.getPrototypeOf(e);if(i===null){return undefined}else{a=i;b=f;c=g;d=true;continue a}}else if("value"in h){return h.value}else{var j=h.get;if(j===undefined){return undefined}return j.call(g)}}};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _inherits(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof b)}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:false,writable:true,configurable:true}});if(b)Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b}(function(){"use strict";var a=Sprite.Namespace();Game.assign("ActorPet",function(a){_inherits(b,a);function b(a){_classCallCheck(this,b);_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a)}return b}(Game.Actor))})();"use strict";(function(){"use strict";function a(a,b,c){return new Promise(function(d,e){var f=document.createElement("canvas");f.height=c;f.width=b;var g=f.getContext("2d");g.clearRect(0,0,b,c);var h=a.length-1;for(var i=0;i<h;i++){var j=a[i];g.drawImage(j,0,0,j.width,j.height,0,0,b,c)}var k=null;var l=null;var m=new Set;k=new Image;k.src=f.toDataURL("image/png");m.add(new Promise(function(a,b){if(k.complete){a()}else{k.onload=function(){a()}}}));g.drawImage(a[h],0,0,a[h].width,a[h].height,0,0,b,c);l=new Image;l.src=f.toDataURL("image/png");m.add(new Promise(function(a,b){if(l.complete){a()}else{l.onload=function(){a()}}}));Promise.all(m).then(function(){d([k,l])})})}function b(a){if(typeof a=="string"&&a.length>0)return true;return false}Game.assign("drawHero",function(c){return new Promise(function(d,e){var f="hero";var g=[];if(b(c.sex)&&b(c.body)){g.push(f+"/body/"+c.sex+"/"+c.body+".png");if(b(c.eyes))g.push(f+"/body/"+c.sex+"/eyes/"+c.eyes+".png");if(b(c.shirts))g.push(f+"/shirts/"+c.sex+"/"+c.shirts+".png");if(b(c.pants))g.push(f+"/pants/"+c.sex+"/"+c.pants+".png");if(b(c.shoes))g.push(f+"/shoes/"+c.sex+"/"+c.shoes+".png");if(b(c.armorchest))g.push(f+"/armor/chest/"+c.sex+"/"+c.armorchest+".png");if(b(c.armorarm))g.push(f+"/armor/arm/"+c.sex+"/"+c.armorarm+".png");if(b(c.armorlegs))g.push(f+"/armor/legs/"+c.sex+"/"+c.armorlegs+".png");if(b(c.armorfeet))g.push(f+"/armor/feet/"+c.sex+"/"+c.armorfeet+".png");if(b(c.hair)&&b(c.haircolor))g.push(f+"/hair/"+c.sex+"/"+c.hair+"/"+c.haircolor+".png");if(b(c.head))g.push(f+"/head/"+c.sex+"/"+c.head+".png");if(b(c.armorhelms))g.push(f+"/armor/helms/"+c.sex+"/"+c.armorhelms+".png");g.push(f+"/weapons/"+c.sex+"/weapons.png")}Sprite.load(g).then(function(b){a(b,c.width,c.height).then(function(a){d(a)})})})})})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";function a(){if(Game.paused)return;var b="run";if(Sprite.Input.isPressed("shift")){b="walk"}if(Sprite.Input.isPressed("left")){Game.hero.go(b,"left").then(a)}else if(Sprite.Input.isPressed("up")){Game.hero.go(b,"up").then(a)}else if(Sprite.Input.isPressed("right")){Game.hero.go(b,"right").then(a)}else if(Sprite.Input.isPressed("down")){Game.hero.go(b,"down").then(a)}}var b=null;Game.assign("Input",function(){function c(){_classCallCheck(this,c)}_createClass(c,null,[{key:"clearDest",value:function d(){b.visible=false}},{key:"setDest",value:function e(a,c){b.x=a*32+16;b.y=c*32+16;b.visible=true}},{key:"init",value:function f(){b=new Sprite.Shape;b.circle({cx:5,cy:5,r:5,stroke:"red",fill:"green"});b.visible=false;b.centerX=5;b.centerY=5;Game.windows.stage.on("mousedown",function(a){var c=a.data;c.x+=Game.stage.centerX;c.y+=Game.stage.centerY;c.x=Math.floor(c.x/32);c.y=Math.floor(c.y/32);if(!Game.layers.infoLayer.hasChild(b)){Game.layers.infoLayer.appendChild(b)}if(Game.hero.x!=c.x||Game.hero.y!=c.y){Game.hero.goto(c.x,c.y,"run").then(function(){b.visible=false;if(Game.hintObject&&Game.hintObject.heroUse){Game.hintObject.heroUse()}})}});Sprite.Ticker.on("tick",function(){if(Game.paused)return;if(!Game.hero)return;if(!Game.area)return;if(!Game.area.map)return;a();if(!Game.hero.walking){Game.hero.stop()}Game.hero.focus()})}}]);return c}());Game.assign("initInput",function(){})})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";var a={sex:"male",body:"light",eyes:"blue",hair:"",haircolor:"black",head:"",shirts:"",pants:"",shoes:"",armorchest:"",armorarm:"",armorlegs:"",armorhelms:"",armorfeet:""};a.width=64*13;a.height=64*21;a.width*=.8125;a.height*=.9375;a.tilewidth=a.width/13;a.tileheight=a.height/21;var b=null;Array.from(document.querySelectorAll(".registerWindow #registerWindowDisplaySelect select")).forEach(function(a){a.addEventListener("change",function(){c()})});Array.from(document.querySelectorAll(".registerWindow #registerWindowPersonal select")).forEach(function(a){a.addEventListener("change",function(){h()})});function c(){Array.from(document.querySelectorAll(".registerWindow #registerWindowDisplaySelect select")).forEach(function(b){var c=b.getAttribute("data-type");var d=b.value;if(c=="malehair"||c=="femalehair"){if(a.sex=="male"&&c=="malehair"){a.hair=d}else if(a.sex=="female"&&c=="femalehair"){a.hair=d}}else if(a.hasOwnProperty(c)){a[c]=d}});if(a.sex=="male"){document.getElementById("customMaleHair").style.display="block";document.getElementById("customFemaleHair").style.display="none"}else{document.getElementById("customMaleHair").style.display="none";document.getElementById("customFemaleHair").style.display="block"}i()}var d={None:"信仰决定了神对你的祝福，当然没有信仰也是一种信仰，但你将无法享受神的祝福",Elen:"艾琳 - 知识女神",Enlon:"恩朗 - 死亡主宰",Minare:"密娜 - 丰收女神",Achiel:"阿切奥 - 保护之神",Racha:"拉克 - 魔法女神",Aestor:"阿斯托 - 盗贼之神",Hielach:"赫拉克 - 财富之神",Alik:"阿丽克 - 治愈女神",Amarien:"阿玛恩 - 力量之神"};var e={warrior:"战士是艾利韦斯最常见的冒险职业，擅长使用剑和枪",archer:"弓箭手擅长远程攻击，一般使用弓箭作为武器",wizard:"魔法师擅长使用魔法进行远程攻击",priest:"牧师擅长治疗，也会使用神术",bard:"吟游诗人的表演可以鼓舞士气或者削弱敌人的士气",thief:"盗贼总是躲藏在阴影中",business:"商人擅长交易和说服，帮助你更快的获得资金"};var f=document.querySelector("#registerWindowBelief");var g=document.querySelector("#registerWindowClass");function h(){Array.from(document.querySelectorAll(".registerWindow #registerWindowPersonal select")).forEach(function(a){var c=a.value;var d=a.getAttribute("data-type");b[d]=c});f.textContent=d[b.belief];g.textContent=e[b["class"]]}function i(){var b=document.querySelector(".registerWindow canvas");var c=b.getContext("2d");c.clearRect(0,0,b.width,b.height);document.getElementById("loading").innerHTML="Loading";Game.drawHero(a).then(function(a){var b=a[0];c.drawImage(b,0,0,b.width,b.height);document.getElementById("loading").innerHTML=""})}Game.assign("register",function(){function d(){_classCallCheck(this,d)}_createClass(d,null,[{key:"reg",value:function e(){Array.from(document.querySelectorAll(".registerWindow select")).forEach(function(a){a.selectedIndex=0});c();h();document.getElementById("registerHeroName").value="";Game.windows.register.show()}},{key:"submit",value:function f(){var c=document.getElementById("registerHeroName").value;if(c.trim().length<=0){alert("Invalid Name");return}b.id="hero_"+c;b.name=c;b.custom=a;b.tilewidth=a.tilewidth;b.tileheight=a.tileheight;Game.Archive.save({hero:b});Game.windows.register.hide();Game.Archive.load()}}]);return d}());b={level:1,exp:0,type:"hero",belief:"None","class":"warrior",time:233*(60*24*30*12)+1*(60*24*30)+26*(60*24)+9*60+30,$str:10,$dex:10,$con:10,$int:10,$cha:10,str:0,dex:0,"int":0,con:0,cha:0,$hp:0,$sp:0,critical:0,dodge:0,hp:0,sp:0,$atk:0,$def:0,$matk:0,$mdef:0,atk:0,def:0,matk:0,mdef:0,buff:[],nerf:[],currentQuest:[],completeQuest:[],area:"fystone",x:18,y:15,centerX:26,centerY:55,hitArea:[[0,0]],skills:["fist.l1","sword.l1","spear.l1","bow.l1","fire.l1"],bar:[{id:"sword.l1",type:"skill"},{id:"bow.l1",type:"skill"},null,null,null,null,null,{id:"potion.healWeak",type:"item"}],equipment:{head:null,body:"cloth.normal",feet:"shoes.normal",weapon:"sword.iron",neck:null,ring:null},items:{"sword.iron":1,"spear.iron":1,"bow.wood":1,"cloth.normal":1,"shoes.normal":1,"potion.healWeak":5,"book.gameAdventure":1,"book.elliorwisHistory":1},gold:0,animations:{spellcastup:[0,6,"",40],spellcastleft:[13,19,"",40],spellcastdown:[26,32,"",40],spellcastright:[39,45,"",40],walkup:[104,112,"walkup",70],walkleft:[117,125,"walkleft",70],walkdown:[130,138,"walkdown",70],walkright:[143,151,"walkright",70],meleeup:[156,161,"",40],meleeleft:[169,174,"",40],meleedown:[182,187,"",40],meleeright:[195,200,"",40],thrustup:[273+52,273+59,"",40],thrustleft:[273+65,273+72,"",40],thrustdown:[273+78,273+85,"",40],thrustright:[273+91,273+98,"",40],runup:[273+105,273+112,"runup",30],runleft:[273+118,273+125,"runleft",30],rundown:[273+131,273+138,"rundown",30],runright:[273+144,273+151,"runright",30],slashup:[273+156,273+161,"",40],slashleft:[273+169,273+174,"",40],slashdown:[273+182,273+187,"",40],slashright:[273+195,273+200,"",40],shootup:[273+208,273+220,"",40],shootleft:[273+221,273+233,"",40],shootdown:[273+234,273+246,"",40],shootright:[273+247,273+259,"",40],hurt:[260,265,"",60],dead:265,faceup:104,faceleft:117,facedown:130,faceright:143}}})();"use strict";var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(){"use strict";Game.assign("Archive",function(){function a(){_classCallCheck(this,a)}_createClass(a,null,[{key:"remove",value:function b(a){if(window.localStorage.getItem(a)){window.localStorage.removeItem(a)}}},{key:"list",value:function c(){var a=[];for(var b in window.localStorage){if(b.match(/^SAVE_(\d+)$/)){a.push(parseInt(b.match(/^SAVE_(\d+)$/)[1]))}}a.sort();a.reverse();return a}},{key:"last",value:function d(){var a=Game.Archive.list();if(a.length>0){var d=a[0];return JSON.parse(window.localStorage.getItem("SAVE_"+d))}else{return null}}},{key:"clear",value:function e(){for(var a in window.localStorage){if(a.match(/^SAVE_(\d+)$/)){window.localStorage.removeItem(a)}}}},{key:"save",value:function f(a){var b=new Date;var c=b.getTime();a.id=c;a.name=a.hero.name;a.date=b.toLocaleString();window.localStorage.setItem("SAVE_"+c,JSON.stringify(a))}},{key:"get",value:function g(a){if(a&&window.localStorage.getItem(a)){return JSON.parse(window.localStorage.getItem(a))}return null}},{key:"load",value:function h(a){var b=Game.Archive.get(a);if(!b){b=Game.Archive.last()}if(b){if(Game.windows["interface"].showing){Game.windows["interface"].hide()}Game.windows.main.hide();Game.windows.loading.begin();setTimeout(function(){var a=b.hero;Game.drawHero(a.custom).then(function(b){a.image=b;Game.hero=new Game.ActorHero(a);Game.hero.on("complete",function(){Game.hero.gotoArea(a.area,a.x,a.y)})})},20)}else{console.error("id:",a);throw new Error("Invalid id, Game.Archive.load")}}}]);return a}())})();