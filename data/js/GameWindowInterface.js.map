{"version":3,"sources":["src/GameWindowInterface.js"],"names":[],"mappings":"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","file":"src/GameWindowInterface.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n  var win = Game.windows.interface = new Game.Window(\"interfaceWindow\");\n\n  win.html(`\n    <div style=\"text-align: center; position: absolute; bottom: 10px; width: 100%; height: 70px;\">\n      <button id=\"interfaceWindowButton-0\" class=\"interfaceWindowButton\"></button>\n      <button id=\"interfaceWindowButton-1\" class=\"interfaceWindowButton\"></button>\n      <button id=\"interfaceWindowButton-2\" class=\"interfaceWindowButton\"></button>\n      <button id=\"interfaceWindowButton-3\" class=\"interfaceWindowButton\"></button>\n      <button id=\"interfaceWindowButton-4\" class=\"interfaceWindowButton\"></button>\n      <button id=\"interfaceWindowButton-5\" class=\"interfaceWindowButton\"></button>\n      <button id=\"interfaceWindowButton-6\" class=\"interfaceWindowButton\"></button>\n      <button id=\"interfaceWindowButton-7\" class=\"interfaceWindowButton\"></button>\n    </div>\n\n    <span id=\"interfaceWindowMap\"></span>\n\n    <button id=\"interfaceWindowUse\" class=\"interfaceWindowButton\"></button>\n    <button id=\"interfaceWindowMenu\" class=\"interfaceWindowButton\"></button>\n  `);\n\n  win.css(`\n    #interfaceWindow {\n      pointer-events: none;\n    }\n\n    button.interfaceWindowButton {\n      width: 60px;\n      height: 60px;\n      border: 4px solid gray;\n      border-radius: 10px;\n      background-color: rgba(100, 100, 100, 0.5);\n      display: inline-block;\n      pointer-events: auto;\n      background-repeat: no-repeat;\n      background-size: cover;\n    }\n\n    button.interfaceWindowButton:hover {\n      opacity: 0.5;\n    }\n\n    button.interfaceWindowButton > img {\n      width: 100%;\n      height: 100%;\n    }\n\n    span#interfaceWindowMap {\n      position: absolute:\n      top: 0px;\n      background-color: rgba(100, 100, 100, 0.7);\n    }\n\n    button#interfaceWindowUse {\n      position: absolute;\n      top: 5px;\n      right: 85px;\n      visibility: hidden;\n      background-image: url(\"image/hint.png\");\n    }\n\n    button#interfaceWindowMenu {\n      position: absolute;\n      top: 5px;\n      right: 5px;\n      background-image: url(\"image/setting.png\");\n    }\n  `);\n\n  win.use = document.querySelector(\"button#interfaceWindowUse\");\n\n  (function SettingBar () {\n    // 设置技能栏\n    for (var i = 0; i < 8; i++) {\n      (function (button, index) {\n        button.addEventListener(\"click\", function (event) {\n          var element = Game.hero.data.bar[index];\n          if (element) {\n            if (element.type == \"skill\")\n              Game.hero.fire(element.id);\n            else if (element.type == \"item\") {\n\n            }\n          }\n        });\n      })(document.querySelector(`button#interfaceWindowButton-${i}`), i);\n    }\n\n    function SkillFire (num) {\n      var element = Game.hero.data.bar[num];\n      if (element) {\n        if (element.type == \"skill\") {\n          Game.hero.fire(element.id);\n        } else if (element.type == \"item\") {\n\n        }\n      }\n    }\n\n    Sprite.Input.whenUp([\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\"], function (key) {\n      var num = parseInt(key);\n      if (Number.isInteger(num) && Game.windows.interface.showing()) {\n        SkillFire(num - 1);\n      }\n    });\n\n    Sprite.Input.whenUp([\"e\", \"E\"], function (key) {\n      if (Game.windows.interface.showing()) {\n        if (Game.hintObject) {\n          win.use.click();\n        }\n      }\n    });\n\n    win.use.addEventListener(\"click\", function (event) {\n      if (Game.hintObject) {\n        if (Game.hintObject.type && Game.hintObject.type == \"door\") {\n          var destx = Game.hintObject.destx;\n          var desty = Game.hintObject.desty;\n          Game.clearStage();\n          Game.loadArea(Game.hintObject.dest, function (area) {\n            Game.area = area;\n            area.map.draw(Game.layers.mapLayer);\n            Game.hero.draw(Game.layers.heroLayer);\n            Game.hero.x = destx;\n            Game.hero.y = desty;\n            Game.windows.interface.show();\n            Game.stage.update();\n          });\n\n        } else if (Game.hintObject.type && Game.hintObject.type == \"chest\") {\n        } else if (Game.hintObject.type && Game.hintObject.type == \"hint\") {\n          Game.hero.popup(Game.hintObject.message);\n        } else if (Game.hintObject instanceof Game.Actor) {\n          Game.hintObject.contact();\n        }\n        else if (Game.hintObject instanceof Game.Item) {\n          Game.hintObject.pickup();\n        }\n      }\n    });\n\n  })();\n\n  win.register(\"refresh\", function () {\n    for (var i = 0; i < 8; i++) {\n      var element = Game.hero.data.bar[i];\n      var container = document.querySelector(`button#interfaceWindowButton-${i}`);\n      while (container.hasChildNodes())\n        container.removeChild(container.lastChild);\n      if (element) {\n        var id = element.id;\n        var type = element.type;\n        if (type == \"skill\") {\n          var skill = Game.skills[id];\n          //container.appendChild(skill.icon.cloneNode());\n          container.style.backgroundImage = `url(\"${skill.icon.src}\")`;\n        } else if (type == \"item\") {\n          var item = Game.items[id];\n          container.style.backgroundImage = `url(\"${item.icon.src}\")`;\n          //container.appendChild(item.icon.cloneNode());\n        }\n      } else {\n        // empty bar element\n        container.style.backgroundImage = \"\";\n        //container.appendChild(document.createElement(\"img\"));\n      }\n    }\n\n    document.querySelector(\"span#interfaceWindowMap\").textContent = Game.area.map.data.name;\n  });\n\n  win.on(\"beforeShow\", function () {\n    Game.windows.interface.execute(\"refresh\");\n  });\n\n  document.querySelector(\"button#interfaceWindowMenu\").addEventListener(\"click\", function (event) {\n    Game.windows.sysmenu.show();\n  });\n\n}());\n"]}