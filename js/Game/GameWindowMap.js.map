{"version":3,"sources":["../../../src/Game/GameWindowMap.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAoBA,CAAC,YAAY;AACX,cAAY,CAAC;;AAEb,MAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;;AAE7D,KAAG,CAAC,IAAI,qOAOP,CAAC;;AAEF,KAAG,CAAC,GAAG,0eAyBN,CAAC;;AAEF,MAAI,cAAc,GAAG,GAAG,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;AAC1D,MAAI,YAAY,GAAG,GAAG,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;;AAEtD,gBAAc,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAU,KAAK,EAAE;AACxD,QAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;GACzB,CAAC,CAAC;;AAEH,KAAG,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,UAAU,GAAG,EAAE;AACjC,cAAU,CAAC,YAAY;AACrB,oBAAc,CAAC,KAAK,EAAE,CAAC;KACxB,EAAE,EAAE,CAAC,CAAC;GACR,CAAC,CAAC;;AAEH,KAAG,CAAC,EAAE,CAAC,YAAY,EAAE,UAAU,KAAK,EAAE;AACpC,QAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;AAC5C,UAAI,KAAK,GAAG;AACV,SAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;AACf,SAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;AACf,eAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO;AAC3B,eAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO;OAC5B,CAAC;AACF,UAAI,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC;AACjB,UAAI,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC;AACjB,UAAI,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC;AACvB,UAAI,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC;AACvB,UAAI,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC9C,YAAM,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC;AACnC,YAAM,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC;AACrC,UAAI,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AACtC,UAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AACzB,UAAI,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC/C,aAAO,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;AAC7C,aAAO,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;AAC/C,UAAI,cAAc,GAAG,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AAC9C,oBAAc,CAAC,SAAS,CAAC,MAAM,EAC7B,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,EACjC,CAAC,EAAE,CAAC,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;AACvC,aAAO,GAAG,IAAI,CAAC;AACf,YAAM,GAAG,IAAI,CAAC;AACd,kBAAY,CAAC,SAAS,GAAG,EAAE,CAAC;AAC5B,kBAAY,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;AAClC,UAAI,CAAC,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;AACvB,UAAI,CAAC,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;AACvB,UAAI,CAAC,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;AACnC,UAAI,CAAC,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;KACpC;GACF,CAAC,CAAC;CAGJ,CAAA,EAAG,CAAC","file":"GameWindowMap.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n  let win = Game.windows.map = Game.Window.create(\"mapWindow\");\n\n  win.html = `\n    <div class=\"window-box\">\n      <button id=\"mapWindowClose\" class=\"brownButton\">关闭</button>\n      <table><tbody><tr><td>\n        <div id=\"mapWindowMap\"></div>\n      </td></tr></tbody></table>\n    </div>\n  `;\n\n  win.css = `\n    .mapWindow table, .mapWindow tbody, .mapWindow tr, .mapWindow td {\n      width: 100%;\n      height: 100%;\n      magrin: 0;\n      padding: 0;\n    }\n\n    .mapWindow {\n      text-align: center;\n    }\n\n    #mapWindowClose {\n      position: absolute;\n      right: 50px;\n      top: 50px;\n      width: 120px;\n      height: 60px;\n      font-size: 16px;\n    }\n\n    #mapWindowMap img, #mapWindowMap canvas {\n      max-width: 700px;\n      max-height: 320px;\n    }\n  `;\n\n  let mapWindowClose = win.querySelector(\"#mapWindowClose\");\n  let mapWindowMap = win.querySelector(\"#mapWindowMap\");\n\n  mapWindowClose.addEventListener(\"click\", function (event) {\n    Game.windows.map.hide();\n  });\n\n  win.whenUp([\"esc\"], function (key) {\n    setTimeout(function () {\n      mapWindowClose.click();\n    }, 20);\n  });\n\n  win.on(\"beforeShow\", function (event) {\n    if (Game.stage && Game.area && Game.area.map) {\n      let stage = {\n        x: Game.stage.x,\n        y: Game.stage.y,\n        centerX: Game.stage.centerX,\n        centerY: Game.stage.centerY\n      };\n      Game.stage.x = 0;\n      Game.stage.y = 0;\n      Game.stage.centerX = 0;\n      Game.stage.centerY = 0;\n      let canvas = document.createElement(\"canvas\");\n      canvas.width = Game.area.map.width;\n      canvas.height = Game.area.map.height;\n      let context = canvas.getContext(\"2d\");\n      Game.stage.draw(context);\n      let minimap = document.createElement(\"canvas\");\n      minimap.width = Math.floor(canvas.width / 8);\n      minimap.height = Math.floor(canvas.height / 8);\n      let minimapContext = minimap.getContext(\"2d\");\n      minimapContext.drawImage(canvas,\n        0, 0, canvas.width, canvas.height,\n        0, 0, minimap.width, minimap.height);\n      context = null;\n      canvas = null;\n      mapWindowMap.innerHTML = \"\";\n      mapWindowMap.appendChild(minimap);\n      Game.stage.x = stage.x;\n      Game.stage.y = stage.y;\n      Game.stage.centerX = stage.centerX;\n      Game.stage.centerY = stage.centerY;\n    }\n  });\n\n\n})();\n"]}