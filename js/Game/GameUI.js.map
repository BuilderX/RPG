{"version":3,"sources":["src/Game/GameUI.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAoBA,CAAC,YAAY;AACX,cAAY,CAAC;;AAEb,MAAI,UAAU,GAAG,IAAI,GAAG,EAAE,CAAC;;AAE3B,MAAI,CAAC,MAAM,CAAC,OAAO,EAAE,UAAU,GAAG,EAAE,IAAI,EAA4B;QAA1B,OAAO,yDAAG,CAAC;QAAE,OAAO,yDAAG,CAAC;;AAEhE,QAAI,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;AACvB,UAAI,KAAK,GAAG,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAChC,UAAI,CAAC,MAAM,CAAC,aAAa,CAAC,WAAW,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;AACvD,mBAAa,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;AAC3B,gBAAU,UAAO,CAAC,GAAG,CAAC,CAAC;KACxB;;AAED,QAAI,YAAY,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC;AACjC,UAAI,EAAE,IAAI;AACV,cAAQ,EAAE,GAAG;KACd,CAAC,CAAC;;AAEH,QAAI,CAAC,GAAG,YAAY,CAAC,KAAK,CAAC;AAC3B,QAAI,CAAC,GAAG,YAAY,CAAC,MAAM,CAAC;AAC5B,QAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,EAAE,CAAA,GAAI,CAAC,CAAC,CAAC;;AAEtC,QAAI,WAAW,GAAG,IAAI,MAAM,CAAC,KAAK,EAAE,CAAC;;AAErC,eAAW,CAAC,OAAO,CAAC;AAClB,YAAM,YAAS,CAAC,GAAC,EAAE,CAAA,YAAM,CAAC,GAAC,EAAE,CAAA,UAAI,CAAC,GAAC,EAAE,CAAA,UAAI,MAAM,GAAC,CAAC,CAAA,UAAI,CAAC,GAAC,EAAE,CAAA,SAAI,MAAM,UAAI,CAAC,GAAC,EAAE,CAAA,UAAI,MAAM,GAAC,CAAC,CAAA,UAAI,CAAC,GAAC,EAAE,CAAA,YAAM,CAAC,GAAC,EAAE,CAAA,SAAM;AAC/G,UAAI,EAAE,OAAO;KACd,CAAC,CAAC;;AAEH,QAAI,iBAAiB,GAAG,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC;AAC/C,qBAAiB,CAAC,WAAW,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;AACzD,gBAAY,CAAC,CAAC,GAAG,CAAC,CAAC;AACnB,gBAAY,CAAC,CAAC,GAAG,CAAC,CAAC;AACnB,qBAAiB,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,OAAO,CAAC;AACtC,qBAAiB,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,OAAO,CAAC;AACtC,qBAAiB,CAAC,OAAO,GAAG,MAAM,CAAC;AACnC,qBAAiB,CAAC,OAAO,GAAG,CAAC,GAAG,EAAE,CAAC;;AAEnC,QAAI,CAAC,MAAM,CAAC,aAAa,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;;AAEzD,QAAI,GAAG,YAAY,MAAM,CAAC,KAAK,EAAE;AAC/B,SAAG,CAAC,EAAE,CAAC,QAAQ,EAAE,YAAY;AAC3B,yBAAiB,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,OAAO,CAAC;AACtC,yBAAiB,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,OAAO,CAAC;OACvC,CAAC,CAAC;KACJ;;AAED,QAAI,KAAK,GAAG,UAAU,CAAC,YAAM;AAC3B,UAAI,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;AACvB,YAAI,KAAK,GAAG,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAChC,YAAI,CAAC,MAAM,CAAC,aAAa,CAAC,WAAW,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;AACvD,kBAAU,UAAO,CAAC,GAAG,CAAC,CAAC;OACxB;KACF,EAAE,IAAI,CAAC,CAAC;;AAET,cAAU,CAAC,GAAG,CAAC,GAAG,EAAE;AAClB,eAAS,EAAE,iBAAiB;AAC5B,WAAK,EAAE,KAAK;KACb,CAAC,CAAC;GACJ,CAAC,CAAC;CAGJ,CAAA,EAAG,CAAC","file":"src/Game/GameUI.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n  let popupCache = new Map();\n\n  Game.assign(\"popup\", function (obj, text, adjustX = 0, adjustY = 0) {\n\n    if (popupCache.has(obj)) {\n      let popup = popupCache.get(obj);\n      Game.layers.dialogueLayer.removeChild(popup.container);\n      clearInterval(popup.timer);\n      popupCache.delete(obj);\n    }\n\n    let dialogueText = new Sprite.Text({\n      text: text,\n      maxWidth: 200,\n    });\n\n    let w = dialogueText.width;\n    let h = dialogueText.height;\n    let middle = Math.round((w + 10) / 2);\n\n    let dialogueBox = new Sprite.Shape();\n\n    dialogueBox.polygon({\n      points: `0,0 ${w+10},0 ${w+10},${h+10} ${middle+5},${h+10} ${middle},${h+15} ${middle-5},${h+10} 0,${h+10} 0,0`,\n      fill: \"white\"\n    });\n\n    let dialogueContainer = new Sprite.Container();\n    dialogueContainer.appendChild(dialogueBox, dialogueText);\n    dialogueText.x = 5;\n    dialogueText.y = 5;\n    dialogueContainer.x = obj.x + adjustX;\n    dialogueContainer.y = obj.y + adjustY;\n    dialogueContainer.centerX = middle;\n    dialogueContainer.centerY = h + 15;\n\n    Game.layers.dialogueLayer.appendChild(dialogueContainer);\n\n    if (obj instanceof Sprite.Event) {\n      obj.on(\"change\", function () {\n        dialogueContainer.x = obj.x + adjustX;\n        dialogueContainer.y = obj.y + adjustY;\n      });\n    }\n\n    let timer = setTimeout(() => {\n      if (popupCache.has(obj)) {\n        let popup = popupCache.get(obj);\n        Game.layers.dialogueLayer.removeChild(popup.container);\n        popupCache.delete(obj);\n      }\n    }, 3000);\n\n    popupCache.set(obj, {\n      container: dialogueContainer,\n      timer: timer\n    });\n  });\n\n\n})();\n"]}