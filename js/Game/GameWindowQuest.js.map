{"version":3,"sources":["src/Game/GameWindowQuest.js"],"names":[],"mappings":"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","file":"src/Game/GameWindowQuest.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n\n  let win = Game.windows.quest = Game.Window.create(\"questWindow\");\n\n  win.html = `\n    <div class=\"window-box\">\n      <div id=\"questWindowItemBar\">\n        <button id=\"questWindowClose\" class=\"brownButton\">关闭</button>\n        <button id=\"questWindowCurrent\" class=\"brownButton\">当前任务</button>\n        <button id=\"questWindowPast\" class=\"brownButton\">已完成</button>\n      </div>\n      <div id=\"questWindowTable\"></div>\n    </div>\n  `;\n\n  win.css = `\n    #questWindowTable {\n      width: 100%;\n      overflow-y: auto;\n      height: 320px;\n    }\n\n    .questWindowItem {\n      border: 1px solid gray;\n      border-radius: 10px;\n      margin: 10px 10px;\n    }\n\n    .questWindowItem > button {\n      width: 100px;\n      height: 40px;\n      border-radius: 5px;\n    }\n\n    #questWindowItemBar button {\n      width: 100px;\n      height: 30px;\n      font-size: 16px;\n      margin-bottom: 5px;\n    }\n\n    #questWindowClose {\n      float: right;\n    }\n  `;\n\n  let questWindowClose = win.querySelector(\"#questWindowClose\");\n  let questWindowCurrent = win.querySelector(\"#questWindowCurrent\");\n  let questWindowPast = win.querySelector(\"#questWindowPast\");\n  let questWindowTable = win.querySelector(\"#questWindowTable\");\n\n\n  questWindowClose.addEventListener(\"click\", function () {\n    win.hide();\n  });\n\n  win.whenUp([\"esc\"], function (key) {\n    setTimeout(function () {\n      questWindowClose.click();\n    }, 20);\n  });\n\n  questWindowCurrent.addEventListener(\"click\", function () {\n    win.hide();\n    win.current();\n  });\n\n  questWindowPast.addEventListener(\"click\", function () {\n    win.hide();\n    win.past();\n  });\n\n  win.assign(\"current\", function () {\n\n    questWindowCurrent.disabled = true;\n    questWindowPast.disabled = false;\n\n    let table = \"\";\n    let list = Game.hero.data.quest.current;\n    list.forEach(function (quest) {\n\n      let complete = true;\n      if (quest.target.type == \"kill\") {\n        for (let key in quest.target.kill) {\n          let t = quest.target.kill[key];\n          if (t.current < t.need) {\n            complete = false;\n          }\n        }\n      }\n\n      let line = `<div class=\"questWindowItem\">\\n`;\n      line += `  <label style=\"font-size: 20px; margin: 10px;\">${quest.name}${complete?\"[已完成]\":\"[未完成]\"}</label>\\n`;\n      line += `  <div style=\"margin: 10px;\">简介：${quest.description}</div>\\n`;\n\n      if (quest.reward) {\n        line += `  <div style=\"margin: 10px;\">任务奖励：`;\n        if (quest.reward.gold) {\n          line += `<label style=\"margin-right: 20px;\">金币：${quest.reward.gold}</label>`;\n        }\n        if (quest.reward.exp) {\n          line += `<label style=\"margin-right: 20px;\">经验：${quest.reward.exp}</label>`;\n        }\n        line += `  </div>`;\n      }\n\n      if (quest.target.type == \"kill\") {\n        for (let key in quest.target.kill) {\n          let t = quest.target.kill[key];\n          line += `<div style=\"margin: 10px;\">${t.name}：${t.current} / ${t.need}</div>`;\n        }\n      }\n\n      line += `  <label style=\"margin: 10px;\">给予人：${quest.fromMap} 的 ${quest.fromName}</label>\\n`;\n      line += `  <label style=\"margin: 10px;\">交付人：${quest.toMap} 的 ${quest.toName}</label>\\n`;\n      line += \"</div>\\n\"\n      table += line;\n    });\n\n    if (table.length <= 0) {\n      table = \"<div><label>没有正在进行的任务</label></div>\";\n    }\n\n    questWindowTable.innerHTML = table;\n    win.show();\n  });\n\n  win.assign(\"past\", function () {\n\n    questWindowCurrent.disabled = false;\n    questWindowPast.disabled = true;\n\n    let table = \"\";\n    let list = Game.hero.data.quest.past;\n    list.forEach(function (quest) {\n\n      let line = `<div class=\"questWindowItem\">\\n`;\n      line += `  <label style=\"font-size: 20px; margin: 10px;\">${quest.name}[已完成]</label>\\n`;\n      line += `  <div style=\"margin: 10px;\">简介：${quest.description}</div>\\n`;\n\n      if (quest.reward) {\n        line += `  <div style=\"margin: 10px;\">任务奖励：`;\n        if (quest.reward.gold) {\n          line += `<label style=\"margin-right: 20px;\">金币：${quest.reward.gold}</label>`;\n        }\n        if (quest.reward.exp) {\n          line += `<label style=\"margin-right: 20px;\">经验：${quest.reward.exp}</label>`;\n        }\n        line += `  </div>`;\n      }\n\n      if (quest.target.type == \"kill\") {\n        for (let key in quest.target.kill) {\n          let t = quest.target.kill[key];\n          line += `<div style=\"margin: 10px;\">${t.name}：${t.current} / ${t.need}</div>`;\n        }\n      }\n\n      line += `  <label style=\"margin: 10px;\">给予人：${quest.fromMap} 的 ${quest.fromName}</label>\\n`;\n      line += `  <label style=\"margin: 10px;\">交付人：${quest.toMap} 的 ${quest.toName}</label>\\n`;\n      line += \"</div>\\n\"\n      table += line;\n    });\n\n    if (table.length <= 0) {\n      table = \"<div><label>没有已完成任务</label></div>\";\n    }\n\n    questWindowTable.innerHTML = table;\n    win.show();\n  });\n\n  questWindowTable.addEventListener(\"click\", function (event) {\n    let id = event.target.getAttribute(\"data-id\");\n    if (id) {\n      if (type == \"remove\") {\n        Game.Archive.remove(id);\n        win.open();\n      } else if (type == \"load\") {\n        Game.Archive.load(id);\n        win.hide();\n      }\n    }\n  });\n\n\n})();\n"]}