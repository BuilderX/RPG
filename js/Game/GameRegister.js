/*

A-RPG Game, Built using JavaScript ES6
Copyright (C) 2015 qhduan(http://qhduan.com)

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

*/

"use strict";

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

(function () {
  "use strict";

  // 英雄组件数据
  var heroCustom = {
    sex: "male",
    body: "light",
    eyes: "blue",
    hair: "",
    haircolor: "black",

    head: "",
    shirts: "",
    pants: "",
    shoes: "",

    armorchest: "",
    armorarm: "",
    armorlegs: "",
    armorhelms: "",
    armorfeet: ""
  };

  // 13x21
  heroCustom.width = 64 * 13; // 832;
  heroCustom.height = 64 * 21; // 1344;
  heroCustom.width *= 0.8125;
  heroCustom.height *= 0.9375;
  heroCustom.tilewidth = heroCustom.width / 13; // 52
  heroCustom.tileheight = heroCustom.height / 21; // 60

  // defined at bottom
  var HeroDefault = null;

  Array.from(document.querySelectorAll(".registerWindow #registerWindowDisplaySelect select")).forEach(function (element) {
    element.addEventListener("change", function () {
      ApplyHeroDisplay();
    });
  });

  Array.from(document.querySelectorAll(".registerWindow #registerWindowPersonal select")).forEach(function (element) {
    element.addEventListener("change", function () {
      ApplyHeroPersonal();
    });
  });

  function ApplyHeroDisplay() {
    Array.from(document.querySelectorAll(".registerWindow #registerWindowDisplaySelect select")).forEach(function (element) {
      var type = element.getAttribute("data-type");
      var value = element.value;
      if (type == "malehair" || type == "femalehair") {
        if (heroCustom.sex == "male" && type == "malehair") {
          heroCustom.hair = value;
        } else if (heroCustom.sex == "female" && type == "femalehair") {
          heroCustom.hair = value;
        }
      } else if (heroCustom.hasOwnProperty(type)) {
        heroCustom[type] = value;
      }
    });
    if (heroCustom.sex == "male") {
      document.getElementById("customMaleHair").style.display = "block";
      document.getElementById("customFemaleHair").style.display = "none";
    } else {
      document.getElementById("customMaleHair").style.display = "none";
      document.getElementById("customFemaleHair").style.display = "block";
    }
    DisplayHero();
  };

  var beliefText = {
    None: "信仰决定了神对你的祝福，当然没有信仰也是一种信仰，但你将无法享受神的祝福",
    Elen: "艾琳 - 知识女神",
    Enlon: "恩朗 - 死亡主宰",
    Minare: "密娜 - 丰收女神",
    Achiel: "阿切奥 - 保护之神",
    Racha: "拉克 - 魔法女神",
    Aestor: "阿斯托 - 盗贼之神",
    Hielach: "赫拉克 - 财富之神",
    Alik: "阿丽克 - 治愈女神",
    Amarien: "阿玛恩 - 力量之神"
  };

  var classText = {
    warrior: "战士是艾利韦斯最常见的冒险职业，擅长使用剑和枪",
    archer: "弓箭手擅长远程攻击，一般使用弓箭作为武器",
    wizard: "魔法师擅长使用魔法进行远程攻击",
    priest: "牧师擅长治疗，也会使用神术",
    bard: "吟游诗人的表演可以鼓舞士气或者削弱敌人的士气",
    thief: "盗贼总是躲藏在阴影中",
    business: "商人擅长交易和说服，帮助你更快的获得资金"
  };

  var registerWindowBelief = document.querySelector("#registerWindowBelief");
  var registerWindowClass = document.querySelector("#registerWindowClass");

  function ApplyHeroPersonal() {

    Array.from(document.querySelectorAll(".registerWindow #registerWindowPersonal select")).forEach(function (element) {
      var value = element.value;
      var type = element.getAttribute("data-type");
      HeroDefault[type] = value;
    });

    registerWindowBelief.textContent = beliefText[HeroDefault.belief];
    registerWindowClass.textContent = classText[HeroDefault["class"]];
  };

  function DisplayHero() {

    var canvas = document.querySelector(".registerWindow canvas");
    var context = canvas.getContext("2d");
    context.clearRect(0, 0, canvas.width, canvas.height);

    document.getElementById("loading").innerHTML = "Loading";
    Game.drawHero(heroCustom).then(function (images) {
      var img = images[0];
      context.drawImage(img, 0, 0, img.width, img.height);
      document.getElementById("loading").innerHTML = "";
    });
  }

  Game.assign("register", (function () {
    function GameRegister() {
      _classCallCheck(this, GameRegister);
    }

    _createClass(GameRegister, null, [{
      key: "reg",

      // 注册模块
      value: function reg() {
        Array.from(document.querySelectorAll(".registerWindow select")).forEach(function (element) {
          element.selectedIndex = 0;
        });
        ApplyHeroDisplay();
        ApplyHeroPersonal();
        document.getElementById("registerHeroName").value = "";
        Game.windows.register.show();
      }
    }, {
      key: "submit",
      value: function submit() {
        var name = document.getElementById("registerHeroName").value;

        if (name.trim().length <= 0) {
          alert("Invalid Name");
          return;
        }

        HeroDefault.id = "hero_" + name;
        HeroDefault.name = name;
        HeroDefault.custom = heroCustom;
        HeroDefault.tilewidth = heroCustom.tilewidth;
        HeroDefault.tileheight = heroCustom.tileheight;

        // 保存一个存档
        Game.Archive.save({
          hero: HeroDefault
        });

        Game.windows.register.hide();

        // 空调用，代表读取最新一个存档（last），即刚刚新建的存档
        Game.Archive.load();
      }
    }]);

    return GameRegister;
  })());

  // 含有$开头的代表是基础值
  // 不含$的同名属性是计算后值，即经过各种加成，buff，nerf之后的值
  HeroDefault = {
    "level": 1, // 等级
    "exp": 0, // 经验值
    "type": "hero", // 标识这个actor的类别是hero，其他类别如npc，monster

    "belief": "None",
    "class": "warrior", // 职业，不同职业有不同加成

    // 233年2月27日 09时30分
    "time": 233 * (60 * 24 * 30 * 12) + 1 * (60 * 24 * 30) + 26 * (60 * 24) + 9 * 60 + 30,

    // 最基本的属性，其他属性都由此延伸
    "$str": 10, // strength 力量： 物理攻击力
    "$dex": 10, // dexterity 敏捷： 闪避，暴击
    "$con": 10, // constitution 耐力： 生命值
    "$int": 10, // intelligence 智力： 精神力，魔法攻击
    "$cha": 10, // charisma 魅力： 队友能力

    // 下面为0的值将由上面的基本属性计算出来

    "str": 0,
    "dex": 0,
    "int": 0,
    "con": 0,
    "cha": 0,

    "$hp": 0, // 生命力
    "$sp": 0, // 精神力

    "critical": 0, // 暴击率
    "dodge": 0, // 闪避

    "hp": 0,
    "sp": 0,

    "$atk": 0, // 攻击
    "$def": 0, // 防御
    "$matk": 0, // 魔法攻击
    "$mdef": 0, // 魔法防御

    "atk": 0,
    "def": 0,
    "matk": 0,
    "mdef": 0,

    "buff": [], // 有益状态
    "nerf": [], // 有害状态

    "currentQuest": [/* 当前任务 */],
    "completeQuest": [/* 完成了的任务 */],

    // 初始位置
    "area": "fystone", // 地图id
    "x": 18,
    "y": 15,

    "centerX": 26,
    "centerY": 55,
    "hitArea": [[0, 0]],

    // 能力
    "skills": ["fist.l1", "sword.l1", // 剑攻击Level1
    "spear.l1", // 枪攻击Level1
    "bow.l1", // 弓攻击Level1
    "fire.l1"],

    // 火球术Level1
    // 技能快捷方式列表
    "bar": [{
      "id": "sword.l1",
      "type": "skill"
    }, {
      "id": "bow.l1",
      "type": "skill"
    }, null, null, null, null, null, {
      "id": "potion.healWeak",
      "type": "item"
    }],

    // 技能，例如生活技能，说服技能，交易技能
    //skills: {
    //  _trade: 0, // 交易，交易时的价格
    //  _negotiate: 0, // 交涉，具体剧情，招揽同伴时的费用
    //  _lock: 0, // 开锁
    //  _knowledge: 0, // 知识，具体剧情，鉴定物品
    //  _treatment: 0, // 医疗，在使用医疗物品时的效果
    //  _animal: 0, // 动物战斗加成，动物驯养
    //},

    "equipment": {
      "head": null,
      "body": "cloth.normal",
      "feet": "shoes.normal",
      "weapon": "sword.iron",
      "neck": null,
      "ring": null
    },

    "items": {
      "sword.iron": 1,
      "spear.iron": 1,
      "bow.wood": 1,
      "cloth.normal": 1,
      "shoes.normal": 1,
      "potion.healWeak": 5,
      "book.gameAdventure": 1,
      "book.elliorwisHistory": 1
    },

    "gold": 0,

    "animations": {

      "spellcastup": [0, 6, "", 40],
      "spellcastleft": [13, 19, "", 40],
      "spellcastdown": [26, 32, "", 40],
      "spellcastright": [39, 45, "", 40],

      "walkup": [104, 112, "walkup", 70],
      "walkleft": [117, 125, "walkleft", 70],
      "walkdown": [130, 138, "walkdown", 70],
      "walkright": [143, 151, "walkright", 70],

      "meleeup": [156, 161, "", 40],
      "meleeleft": [169, 174, "", 40],
      "meleedown": [182, 187, "", 40],
      "meleeright": [195, 200, "", 40],

      // 273+是一张图的总数，hero一共两张图，第一张图没武器，第二张图有武器，所以以下动作在第二张图

      "thrustup": [273 + 52, 273 + 59, "", 40],
      "thrustleft": [273 + 65, 273 + 72, "", 40],
      "thrustdown": [273 + 78, 273 + 85, "", 40],
      "thrustright": [273 + 91, 273 + 98, "", 40],

      "runup": [273 + 105, 273 + 112, "runup", 30],
      "runleft": [273 + 118, 273 + 125, "runleft", 30],
      "rundown": [273 + 131, 273 + 138, "rundown", 30],
      "runright": [273 + 144, 273 + 151, "runright", 30],

      "slashup": [273 + 156, 273 + 161, "", 40],
      "slashleft": [273 + 169, 273 + 174, "", 40],
      "slashdown": [273 + 182, 273 + 187, "", 40],
      "slashright": [273 + 195, 273 + 200, "", 40],

      "shootup": [273 + 208, 273 + 220, "", 40],
      "shootleft": [273 + 221, 273 + 233, "", 40],
      "shootdown": [273 + 234, 273 + 246, "", 40],
      "shootright": [273 + 247, 273 + 259, "", 40],

      "hurt": [260, 265, "", 60],

      "dead": 265,

      "faceup": 104,
      "faceleft": 117,
      "facedown": 130,
      "faceright": 143
    }
  };
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9HYW1lL0dhbWVSZWdpc3Rlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW9CQSxDQUFDLFlBQVk7QUFDWCxjQUFZLENBQUM7OztBQUdiLE1BQUksVUFBVSxHQUFHO0FBQ2YsT0FBRyxFQUFFLE1BQU07QUFDWCxRQUFJLEVBQUUsT0FBTztBQUNiLFFBQUksRUFBRSxNQUFNO0FBQ1osUUFBSSxFQUFFLEVBQUU7QUFDUixhQUFTLEVBQUUsT0FBTzs7QUFFbEIsUUFBSSxFQUFFLEVBQUU7QUFDUixVQUFNLEVBQUUsRUFBRTtBQUNWLFNBQUssRUFBRSxFQUFFO0FBQ1QsU0FBSyxFQUFFLEVBQUU7O0FBRVQsY0FBVSxFQUFFLEVBQUU7QUFDZCxZQUFRLEVBQUUsRUFBRTtBQUNaLGFBQVMsRUFBRSxFQUFFO0FBQ2IsY0FBVSxFQUFFLEVBQUU7QUFDZCxhQUFTLEVBQUUsRUFBRTtHQUNkLENBQUM7OztBQUdGLFlBQVUsQ0FBQyxLQUFLLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQztBQUMzQixZQUFVLENBQUMsTUFBTSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUM7QUFDNUIsWUFBVSxDQUFDLEtBQUssSUFBSSxNQUFNLENBQUM7QUFDM0IsWUFBVSxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUM7QUFDNUIsWUFBVSxDQUFDLFNBQVMsR0FBRyxVQUFVLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztBQUM3QyxZQUFVLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDOzs7QUFHL0MsTUFBSSxXQUFXLEdBQUcsSUFBSSxDQUFDOztBQUV2QixPQUFLLENBQUMsSUFBSSxDQUNSLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxxREFBcUQsQ0FBQyxDQUNqRixDQUFDLE9BQU8sQ0FBQyxVQUFVLE9BQU8sRUFBRTtBQUMzQixXQUFPLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLFlBQVk7QUFD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RSxFQUFFLEVBQUUsQ0FBQzs7QUFFeEMsZUFBUyxFQUFFLENBQUMsR0FBRyxHQUFDLEdBQUcsRUFBRSxHQUFHLEdBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7QUFDckMsaUJBQVcsRUFBRSxDQUFDLEdBQUcsR0FBQyxHQUFHLEVBQUUsR0FBRyxHQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDO0FBQ3ZDLGlCQUFXLEVBQUUsQ0FBQyxHQUFHLEdBQUMsR0FBRyxFQUFFLEdBQUcsR0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQztBQUN2QyxrQkFBWSxFQUFFLENBQUMsR0FBRyxHQUFDLEdBQUcsRUFBRSxHQUFHLEdBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7O0FBRXhDLFlBQU0sRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQzs7QUFFMUIsWUFBTSxFQUFFLEdBQUc7O0FBRVgsY0FBUSxFQUFFLEdBQUc7QUFDYixnQkFBVSxFQUFFLEdBQUc7QUFDZixnQkFBVSxFQUFFLEdBQUc7QUFDZixpQkFBVyxFQUFFLEdBQUc7S0FDakI7R0FDRixDQUFDO0NBR0gsQ0FBQSxFQUFHLENBQUMiLCJmaWxlIjoic3JjL0dhbWUvR2FtZVJlZ2lzdGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcblxuQS1SUEcgR2FtZSwgQnVpbHQgdXNpbmcgSmF2YVNjcmlwdCBFUzZcbkNvcHlyaWdodCAoQykgMjAxNSBxaGR1YW4oaHR0cDovL3FoZHVhbi5jb20pXG5cblRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG5pdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxudGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3JcbihhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG5cblRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2Zcbk1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGVcbkdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG5cbllvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlXG5hbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cblxuKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgLy8g6Iux6ZuE57uE5Lu25pWw5o2uXG4gIGxldCBoZXJvQ3VzdG9tID0ge1xuICAgIHNleDogXCJtYWxlXCIsXG4gICAgYm9keTogXCJsaWdodFwiLFxuICAgIGV5ZXM6IFwiYmx1ZVwiLFxuICAgIGhhaXI6IFwiXCIsXG4gICAgaGFpcmNvbG9yOiBcImJsYWNrXCIsXG5cbiAgICBoZWFkOiBcIlwiLFxuICAgIHNoaXJ0czogXCJcIixcbiAgICBwYW50czogXCJcIixcbiAgICBzaG9lczogXCJcIixcblxuICAgIGFybW9yY2hlc3Q6IFwiXCIsXG4gICAgYXJtb3Jhcm06IFwiXCIsXG4gICAgYXJtb3JsZWdzOiBcIlwiLFxuICAgIGFybW9yaGVsbXM6IFwiXCIsXG4gICAgYXJtb3JmZWV0OiBcIlwiXG4gIH07XG5cbiAgLy8gMTN4MjFcbiAgaGVyb0N1c3RvbS53aWR0aCA9IDY0ICogMTM7IC8vIDgzMjtcbiAgaGVyb0N1c3RvbS5oZWlnaHQgPSA2NCAqIDIxOyAvLyAxMzQ0O1xuICBoZXJvQ3VzdG9tLndpZHRoICo9IDAuODEyNTtcbiAgaGVyb0N1c3RvbS5oZWlnaHQgKj0gMC45Mzc1O1xuICBoZXJvQ3VzdG9tLnRpbGV3aWR0aCA9IGhlcm9DdXN0b20ud2lkdGggLyAxMzsgLy8gNTJcbiAgaGVyb0N1c3RvbS50aWxlaGVpZ2h0ID0gaGVyb0N1c3RvbS5oZWlnaHQgLyAyMTsgLy8gNjBcblxuICAvLyBkZWZpbmVkIGF0IGJvdHRvbVxuICBsZXQgSGVyb0RlZmF1bHQgPSBudWxsO1xuXG4gIEFycmF5LmZyb20oXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZWdpc3RlcldpbmRvdyAjcmVnaXN0ZXJXaW5kb3dEaXNwbGF5U2VsZWN0IHNlbGVjdFwiKVxuICApLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgQXBwbHlIZXJvRGlzcGxheSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBBcnJheS5mcm9tKFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVnaXN0ZXJXaW5kb3cgI3JlZ2lzdGVyV2luZG93UGVyc29uYWwgc2VsZWN0XCIpXG4gICkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBBcHBseUhlcm9QZXJzb25hbCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBmdW5jdGlvbiBBcHBseUhlcm9EaXNwbGF5ICgpIHtcbiAgICBBcnJheS5mcm9tKFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZWdpc3RlcldpbmRvdyAjcmVnaXN0ZXJXaW5kb3dEaXNwbGF5U2VsZWN0IHNlbGVjdFwiKVxuICAgICkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgbGV0IHR5cGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtdHlwZVwiKTtcbiAgICAgIGxldCB2YWx1ZSA9IGVsZW1lbnQudmFsdWU7XG4gICAgICBpZiAodHlwZSA9PSBcIm1hbGVoYWlyXCIgfHwgdHlwZSA9PSBcImZlbWFsZWhhaXJcIikge1xuICAgICAgICBpZiAoaGVyb0N1c3RvbS5zZXggPT0gXCJtYWxlXCIgJiYgdHlwZSA9PSBcIm1hbGVoYWlyXCIpIHtcbiAgICAgICAgICBoZXJvQ3VzdG9tLmhhaXIgPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChoZXJvQ3VzdG9tLnNleCA9PSBcImZlbWFsZVwiICYmIHR5cGUgPT0gXCJmZW1hbGVoYWlyXCIpIHtcbiAgICAgICAgICBoZXJvQ3VzdG9tLmhhaXIgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChoZXJvQ3VzdG9tLmhhc093blByb3BlcnR5KHR5cGUpKSB7XG4gICAgICAgIGhlcm9DdXN0b21bdHlwZV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoaGVyb0N1c3RvbS5zZXggPT0gXCJtYWxlXCIpIHtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3VzdG9tTWFsZUhhaXJcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3VzdG9tRmVtYWxlSGFpclwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3VzdG9tTWFsZUhhaXJcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjdXN0b21GZW1hbGVIYWlyXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgfVxuICAgIERpc3BsYXlIZXJvKCk7XG4gIH07XG5cbiAgbGV0IGJlbGllZlRleHQgPSB7XG4gICAgTm9uZTogXCLkv6Hku7DlhrPlrprkuobnpZ7lr7nkvaDnmoTnpZ3npo/vvIzlvZPnhLbmsqHmnInkv6Hku7DkuZ/mmK/kuIDnp43kv6Hku7DvvIzkvYbkvaDlsIbml6Dms5Xkuqvlj5fnpZ7nmoTnpZ3npo9cIixcbiAgICBFbGVuOiBcIuiJvueQsyAtIOefpeivhuWls+elnlwiLFxuICAgIEVubG9uOiBcIuaBqeaclyAtIOatu+S6oeS4u+WusFwiLFxuICAgIE1pbmFyZTogXCLlr4blqJwgLSDkuLDmlLblpbPnpZ5cIixcbiAgICBBY2hpZWw6IFwi6Zi/5YiH5aWlIC0g5L+d5oqk5LmL56WeXCIsXG4gICAgUmFjaGE6IFwi5ouJ5YWLIC0g6a2U5rOV5aWz56WeXCIsXG4gICAgQWVzdG9yOiBcIumYv+aWr+aJmCAtIOebl+i0vOS5i+elnlwiLFxuICAgIEhpZWxhY2g6IFwi6LWr5ouJ5YWLIC0g6LSi5a+M5LmL56WeXCIsXG4gICAgQWxpazogXCLpmL/kuL3lhYsgLSDmsrvmhIjlpbPnpZ5cIixcbiAgICBBbWFyaWVuOiBcIumYv+eOm+aBqSAtIOWKm+mHj+S5i+elnlwiXG4gIH07XG5cbiAgbGV0IGNsYXNzVGV4dCA9IHtcbiAgICB3YXJyaW9yOiBcIuaImOWjq+aYr+iJvuWIqemfpuaWr+acgOW4uOingeeahOWGkumZqeiBjOS4mu+8jOaThemVv+S9v+eUqOWJkeWSjOaeqlwiLFxuICAgIGFyY2hlcjogXCLlvJPnrq3miYvmk4Xplb/ov5znqIvmlLvlh7vvvIzkuIDoiKzkvb/nlKjlvJPnrq3kvZzkuLrmrablmahcIixcbiAgICB3aXphcmQ6IFwi6a2U5rOV5biI5pOF6ZW/5L2/55So6a2U5rOV6L+b6KGM6L+c56iL5pS75Ye7XCIsXG4gICAgcHJpZXN0OiBcIueJp+W4iOaThemVv+ayu+eWl++8jOS5n+S8muS9v+eUqOelnuacr1wiLFxuICAgIGJhcmQ6IFwi5ZCf5ri46K+X5Lq655qE6KGo5ryU5Y+v5Lul6byT6Iie5aOr5rCU5oiW6ICF5YmK5byx5pWM5Lq655qE5aOr5rCUXCIsXG4gICAgdGhpZWY6IFwi55uX6LS85oC75piv6Lqy6JeP5Zyo6Zi05b2x5LitXCIsXG4gICAgYnVzaW5lc3M6IFwi5ZWG5Lq65pOF6ZW/5Lqk5piT5ZKM6K+05pyN77yM5biu5Yqp5L2g5pu05b+r55qE6I635b6X6LWE6YeRXCJcbiAgfTtcblxuICBsZXQgcmVnaXN0ZXJXaW5kb3dCZWxpZWYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JlZ2lzdGVyV2luZG93QmVsaWVmXCIpO1xuICBsZXQgcmVnaXN0ZXJXaW5kb3dDbGFzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcmVnaXN0ZXJXaW5kb3dDbGFzc1wiKTtcblxuICBmdW5jdGlvbiBBcHBseUhlcm9QZXJzb25hbCAoKSB7XG5cbiAgICBBcnJheS5mcm9tKFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZWdpc3RlcldpbmRvdyAjcmVnaXN0ZXJXaW5kb3dQZXJzb25hbCBzZWxlY3RcIilcbiAgICApLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgIGxldCB2YWx1ZSA9IGVsZW1lbnQudmFsdWU7XG4gICAgICBsZXQgdHlwZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10eXBlXCIpO1xuICAgICAgSGVyb0RlZmF1bHRbdHlwZV0gPSB2YWx1ZTtcbiAgICB9KTtcblxuICAgIHJlZ2lzdGVyV2luZG93QmVsaWVmLnRleHRDb250ZW50ID0gYmVsaWVmVGV4dFtIZXJvRGVmYXVsdC5iZWxpZWZdO1xuICAgIHJlZ2lzdGVyV2luZG93Q2xhc3MudGV4dENvbnRlbnQgPSBjbGFzc1RleHRbSGVyb0RlZmF1bHQuY2xhc3NdO1xuICB9O1xuXG4gIGZ1bmN0aW9uIERpc3BsYXlIZXJvICgpIHtcblxuICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJlZ2lzdGVyV2luZG93IGNhbnZhc1wiKTtcbiAgICBsZXQgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGluZ1wiKS5pbm5lckhUTUwgPSBcIkxvYWRpbmdcIjtcbiAgICBHYW1lLmRyYXdIZXJvKGhlcm9DdXN0b20pLnRoZW4oZnVuY3Rpb24gKGltYWdlcykge1xuICAgICAgbGV0IGltZyA9IGltYWdlc1swXTtcbiAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltZywgMCwgMCwgaW1nLndpZHRoLCBpbWcuaGVpZ2h0KTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGluZ1wiKS5pbm5lckhUTUwgPSBcIlwiO1xuICAgIH0pO1xuICB9XG5cbiAgR2FtZS5hc3NpZ24oXCJyZWdpc3RlclwiLCBjbGFzcyBHYW1lUmVnaXN0ZXIge1xuXG4gICAgLy8g5rOo5YaM5qih5Z2XXG4gICAgc3RhdGljIHJlZyAoKSB7XG4gICAgICBBcnJheS5mcm9tKFxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlZ2lzdGVyV2luZG93IHNlbGVjdFwiKVxuICAgICAgKS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnQuc2VsZWN0ZWRJbmRleCA9IDA7XG4gICAgICB9KTtcbiAgICAgIEFwcGx5SGVyb0Rpc3BsYXkoKTtcbiAgICAgIEFwcGx5SGVyb1BlcnNvbmFsKCk7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlZ2lzdGVySGVyb05hbWVcIikudmFsdWUgPSBcIlwiO1xuICAgICAgR2FtZS53aW5kb3dzLnJlZ2lzdGVyLnNob3coKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgc3VibWl0ICgpIHtcbiAgICAgIGxldCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZWdpc3Rlckhlcm9OYW1lXCIpLnZhbHVlO1xuXG4gICAgICBpZiAobmFtZS50cmltKCkubGVuZ3RoIDw9IDApIHtcbiAgICAgICAgYWxlcnQoXCJJbnZhbGlkIE5hbWVcIik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgSGVyb0RlZmF1bHQuaWQgPSBcImhlcm9fXCIgKyBuYW1lO1xuICAgICAgSGVyb0RlZmF1bHQubmFtZSA9IG5hbWU7XG4gICAgICBIZXJvRGVmYXVsdC5jdXN0b20gPSBoZXJvQ3VzdG9tO1xuICAgICAgSGVyb0RlZmF1bHQudGlsZXdpZHRoID0gaGVyb0N1c3RvbS50aWxld2lkdGg7XG4gICAgICBIZXJvRGVmYXVsdC50aWxlaGVpZ2h0ID0gaGVyb0N1c3RvbS50aWxlaGVpZ2h0O1xuXG4gICAgICAvLyDkv53lrZjkuIDkuKrlrZjmoaNcbiAgICAgIEdhbWUuQXJjaGl2ZS5zYXZlKHtcbiAgICAgICAgaGVybzogSGVyb0RlZmF1bHRcbiAgICAgIH0pO1xuXG4gICAgICBHYW1lLndpbmRvd3MucmVnaXN0ZXIuaGlkZSgpO1xuXG4gICAgICAvLyDnqbrosIPnlKjvvIzku6Pooajor7vlj5bmnIDmlrDkuIDkuKrlrZjmoaPvvIhsYXN077yJ77yM5Y2z5Yia5Yia5paw5bu655qE5a2Y5qGjXG4gICAgICBHYW1lLkFyY2hpdmUubG9hZCgpO1xuICAgIH1cblxuICB9KTtcblxuXG4gIC8vIOWQq+aciSTlvIDlpLTnmoTku6PooajmmK/ln7rnoYDlgLxcbiAgLy8g5LiN5ZCrJOeahOWQjOWQjeWxnuaAp+aYr+iuoeeul+WQjuWAvO+8jOWNs+e7j+i/h+WQhOenjeWKoOaIkO+8jGJ1ZmbvvIxuZXJm5LmL5ZCO55qE5YC8XG4gIEhlcm9EZWZhdWx0ID0ge1xuICAgIFwibGV2ZWxcIjogMSwgLy8g562J57qnXG4gICAgXCJleHBcIjogMCwgLy8g57uP6aqM5YC8XG4gICAgXCJ0eXBlXCI6IFwiaGVyb1wiLCAvLyDmoIfor4bov5nkuKphY3RvcueahOexu+WIq+aYr2hlcm/vvIzlhbbku5bnsbvliKvlpoJucGPvvIxtb25zdGVyXG5cbiAgICBcImJlbGllZlwiOiBcIk5vbmVcIixcbiAgICBcImNsYXNzXCI6IFwid2FycmlvclwiLCAvLyDogYzkuJrvvIzkuI3lkIzogYzkuJrmnInkuI3lkIzliqDmiJBcblxuICAgIC8vIDIzM+W5tDLmnIgyN+aXpSAwOeaXtjMw5YiGXG4gICAgXCJ0aW1lXCI6IDIzMyooNjAqMjQqMzAqMTIpICsgMSooNjAqMjQqMzApICsgMjYqKDYwKjI0KSArIDkqKDYwKSArIDMwLFxuXG4gICAgLy8g5pyA5Z+65pys55qE5bGe5oCn77yM5YW25LuW5bGe5oCn6YO955Sx5q2k5bu25Ly4XG4gICAgXCIkc3RyXCI6IDEwLCAvLyBzdHJlbmd0aCDlipvph4/vvJog54mp55CG5pS75Ye75YqbXG4gICAgXCIkZGV4XCI6IDEwLCAvLyBkZXh0ZXJpdHkg5pWP5o2377yaIOmXqumBv++8jOaatOWHu1xuICAgIFwiJGNvblwiOiAxMCwgLy8gY29uc3RpdHV0aW9uIOiAkOWKm++8miDnlJ/lkb3lgLxcbiAgICBcIiRpbnRcIjogMTAsIC8vIGludGVsbGlnZW5jZSDmmbrlipvvvJog57K+56We5Yqb77yM6a2U5rOV5pS75Ye7XG4gICAgXCIkY2hhXCI6IDEwLCAvLyBjaGFyaXNtYSDprYXlipvvvJog6Zif5Y+L6IO95YqbXG5cbiAgICAvLyDkuIvpnaLkuLow55qE5YC85bCG55Sx5LiK6Z2i55qE5Z+65pys5bGe5oCn6K6h566X5Ye65p2lXG5cbiAgICBcInN0clwiOiAwLFxuICAgIFwiZGV4XCI6IDAsXG4gICAgXCJpbnRcIjogMCxcbiAgICBcImNvblwiOiAwLFxuICAgIFwiY2hhXCI6IDAsXG5cbiAgICBcIiRocFwiOiAwLCAvLyDnlJ/lkb3liptcbiAgICBcIiRzcFwiOiAwLCAvLyDnsr7npZ7liptcblxuICAgIFwiY3JpdGljYWxcIjogMCwgLy8g5pq05Ye7546HXG4gICAgXCJkb2RnZVwiOiAwLCAvLyDpl6rpgb9cblxuICAgIFwiaHBcIjogMCxcbiAgICBcInNwXCI6IDAsXG5cbiAgICBcIiRhdGtcIjogMCwgLy8g5pS75Ye7XG4gICAgXCIkZGVmXCI6IDAsIC8vIOmYsuW+oVxuICAgIFwiJG1hdGtcIjogMCwgLy8g6a2U5rOV5pS75Ye7XG4gICAgXCIkbWRlZlwiOiAwLCAvLyDprZTms5XpmLLlvqFcblxuICAgIFwiYXRrXCI6IDAsXG4gICAgXCJkZWZcIjogMCxcbiAgICBcIm1hdGtcIjogMCxcbiAgICBcIm1kZWZcIjogMCxcblxuICAgIFwiYnVmZlwiOiBbXSwgLy8g5pyJ55uK54q25oCBXG4gICAgXCJuZXJmXCI6IFtdLCAvLyDmnInlrrPnirbmgIFcblxuICAgIFwiY3VycmVudFF1ZXN0XCI6IFsgLyog5b2T5YmN5Lu75YqhICovIF0sXG4gICAgXCJjb21wbGV0ZVF1ZXN0XCI6IFsgLyog5a6M5oiQ5LqG55qE5Lu75YqhICovIF0sXG5cbiAgICAvLyDliJ3lp4vkvY3nva5cbiAgICBcImFyZWFcIjogXCJmeXN0b25lXCIsIC8vIOWcsOWbvmlkXG4gICAgXCJ4XCI6IDE4LFxuICAgIFwieVwiOiAxNSxcblxuXG4gICAgXCJjZW50ZXJYXCI6IDI2LFxuICAgIFwiY2VudGVyWVwiOiA1NSxcbiAgICBcImhpdEFyZWFcIjogW1swLCAwXV0sXG5cbiAgICAvLyDog73liptcbiAgICBcInNraWxsc1wiOiBbXG4gICAgICBcImZpc3QubDFcIixcbiAgICAgIFwic3dvcmQubDFcIiwgLy8g5YmR5pS75Ye7TGV2ZWwxXG4gICAgICBcInNwZWFyLmwxXCIsIC8vIOaequaUu+WHu0xldmVsMVxuICAgICAgXCJib3cubDFcIiwgLy8g5byT5pS75Ye7TGV2ZWwxXG4gICAgICBcImZpcmUubDFcIiwgLy8g54Gr55CD5pyvTGV2ZWwxXG4gICAgXSxcblxuICAgIC8vIOaKgOiDveW/q+aNt+aWueW8j+WIl+ihqFxuICAgIFwiYmFyXCI6IFtcbiAgICAgIHtcbiAgICAgICAgXCJpZFwiOiBcInN3b3JkLmwxXCIsXG4gICAgICAgIFwidHlwZVwiOiBcInNraWxsXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIFwiaWRcIjogXCJib3cubDFcIixcbiAgICAgICAgXCJ0eXBlXCI6IFwic2tpbGxcIlxuICAgICAgfSxcbiAgICAgIG51bGwsXG4gICAgICBudWxsLFxuICAgICAgbnVsbCxcbiAgICAgIG51bGwsXG4gICAgICBudWxsLFxuICAgICAge1xuICAgICAgICBcImlkXCI6IFwicG90aW9uLmhlYWxXZWFrXCIsXG4gICAgICAgIFwidHlwZVwiOiBcIml0ZW1cIlxuICAgICAgfVxuICAgIF0sXG5cbiAgICAvLyDmioDog73vvIzkvovlpoLnlJ/mtLvmioDog73vvIzor7TmnI3mioDog73vvIzkuqTmmJPmioDog71cbiAgICAvL3NraWxsczoge1xuICAgIC8vICBfdHJhZGU6IDAsIC8vIOS6pOaYk++8jOS6pOaYk+aXtueahOS7t+agvFxuICAgIC8vICBfbmVnb3RpYXRlOiAwLCAvLyDkuqTmtonvvIzlhbfkvZPliafmg4XvvIzmi5vmj73lkIzkvLTml7bnmoTotLnnlKhcbiAgICAvLyAgX2xvY2s6IDAsIC8vIOW8gOmUgVxuICAgIC8vICBfa25vd2xlZGdlOiAwLCAvLyDnn6Xor4bvvIzlhbfkvZPliafmg4XvvIzpibTlrprnianlk4FcbiAgICAvLyAgX3RyZWF0bWVudDogMCwgLy8g5Yy755aX77yM5Zyo5L2/55So5Yy755aX54mp5ZOB5pe255qE5pWI5p6cXG4gICAgLy8gIF9hbmltYWw6IDAsIC8vIOWKqOeJqeaImOaWl+WKoOaIkO+8jOWKqOeJqempr+WFu1xuICAgIC8vfSxcblxuICAgIFwiZXF1aXBtZW50XCI6IHtcbiAgICAgIFwiaGVhZFwiOiBudWxsLFxuICAgICAgXCJib2R5XCI6IFwiY2xvdGgubm9ybWFsXCIsXG4gICAgICBcImZlZXRcIjogXCJzaG9lcy5ub3JtYWxcIixcbiAgICAgIFwid2VhcG9uXCI6IFwic3dvcmQuaXJvblwiLFxuICAgICAgXCJuZWNrXCI6IG51bGwsXG4gICAgICBcInJpbmdcIjogbnVsbFxuICAgIH0sXG5cbiAgICBcIml0ZW1zXCI6IHtcbiAgICAgIFwic3dvcmQuaXJvblwiOiAxLFxuICAgICAgXCJzcGVhci5pcm9uXCI6IDEsXG4gICAgICBcImJvdy53b29kXCI6IDEgLFxuICAgICAgXCJjbG90aC5ub3JtYWxcIjogMSxcbiAgICAgIFwic2hvZXMubm9ybWFsXCI6IDEsXG4gICAgICBcInBvdGlvbi5oZWFsV2Vha1wiOiA1LFxuICAgICAgXCJib29rLmdhbWVBZHZlbnR1cmVcIjogMSxcbiAgICAgIFwiYm9vay5lbGxpb3J3aXNIaXN0b3J5XCI6IDFcbiAgICB9LFxuXG4gICAgXCJnb2xkXCI6IDAsXG5cbiAgICBcImFuaW1hdGlvbnNcIjoge1xuXG4gICAgICBcInNwZWxsY2FzdHVwXCI6IFswLCA2LCBcIlwiLCA0MF0sXG4gICAgICBcInNwZWxsY2FzdGxlZnRcIjogWzEzLCAxOSwgXCJcIiwgNDBdLFxuICAgICAgXCJzcGVsbGNhc3Rkb3duXCI6IFsyNiwgMzIsIFwiXCIsIDQwXSxcbiAgICAgIFwic3BlbGxjYXN0cmlnaHRcIjogWzM5LCA0NSwgXCJcIiwgNDBdLFxuXG4gICAgICBcIndhbGt1cFwiOiBbMTA0LCAxMTIsIFwid2Fsa3VwXCIsIDcwXSxcbiAgICAgIFwid2Fsa2xlZnRcIjogWzExNywgMTI1LCBcIndhbGtsZWZ0XCIsIDcwXSxcbiAgICAgIFwid2Fsa2Rvd25cIjogWzEzMCwgMTM4LCBcIndhbGtkb3duXCIsIDcwXSxcbiAgICAgIFwid2Fsa3JpZ2h0XCI6IFsxNDMsIDE1MSwgXCJ3YWxrcmlnaHRcIiwgNzBdLFxuXG4gICAgICBcIm1lbGVldXBcIjogWzE1NiwgMTYxLCBcIlwiLCA0MF0sXG4gICAgICBcIm1lbGVlbGVmdFwiOiBbMTY5LCAxNzQsIFwiXCIsIDQwXSxcbiAgICAgIFwibWVsZWVkb3duXCI6IFsxODIsIDE4NywgXCJcIiwgNDBdLFxuICAgICAgXCJtZWxlZXJpZ2h0XCI6IFsxOTUsIDIwMCwgXCJcIiwgNDBdLFxuXG4gICAgICAvLyAyNzMr5piv5LiA5byg5Zu+55qE5oC75pWw77yMaGVyb+S4gOWFseS4pOW8oOWbvu+8jOesrOS4gOW8oOWbvuayoeatpuWZqO+8jOesrOS6jOW8oOWbvuacieatpuWZqO+8jOaJgOS7peS7peS4i+WKqOS9nOWcqOesrOS6jOW8oOWbvlxuXG4gICAgICBcInRocnVzdHVwXCI6IFsyNzMrNTIsIDI3Mys1OSwgXCJcIiwgNDBdLFxuICAgICAgXCJ0aHJ1c3RsZWZ0XCI6IFsyNzMrNjUsIDI3Mys3MiwgXCJcIiwgNDBdLFxuICAgICAgXCJ0aHJ1c3Rkb3duXCI6IFsyNzMrNzgsIDI3Mys4NSwgXCJcIiwgNDBdLFxuICAgICAgXCJ0aHJ1c3RyaWdodFwiOiBbMjczKzkxLCAyNzMrOTgsIFwiXCIsIDQwXSxcblxuICAgICAgXCJydW51cFwiOiBbMjczKzEwNSwgMjczKzExMiwgXCJydW51cFwiLCAzMF0sXG4gICAgICBcInJ1bmxlZnRcIjogWzI3MysxMTgsIDI3MysxMjUsIFwicnVubGVmdFwiLCAzMF0sXG4gICAgICBcInJ1bmRvd25cIjogWzI3MysxMzEsIDI3MysxMzgsIFwicnVuZG93blwiLCAzMF0sXG4gICAgICBcInJ1bnJpZ2h0XCI6IFsyNzMrMTQ0LCAyNzMrMTUxLCBcInJ1bnJpZ2h0XCIsIDMwXSxcblxuICAgICAgXCJzbGFzaHVwXCI6IFsyNzMrMTU2LCAyNzMrMTYxLCBcIlwiLCA0MF0sXG4gICAgICBcInNsYXNobGVmdFwiOiBbMjczKzE2OSwgMjczKzE3NCwgXCJcIiwgNDBdLFxuICAgICAgXCJzbGFzaGRvd25cIjogWzI3MysxODIsIDI3MysxODcsIFwiXCIsIDQwXSxcbiAgICAgIFwic2xhc2hyaWdodFwiOiBbMjczKzE5NSwgMjczKzIwMCwgXCJcIiwgNDBdLFxuXG4gICAgICBcInNob290dXBcIjogWzI3MysyMDgsIDI3MysyMjAsIFwiXCIsIDQwXSxcbiAgICAgIFwic2hvb3RsZWZ0XCI6IFsyNzMrMjIxLCAyNzMrMjMzLCBcIlwiLCA0MF0sXG4gICAgICBcInNob290ZG93blwiOiBbMjczKzIzNCwgMjczKzI0NiwgXCJcIiwgNDBdLFxuICAgICAgXCJzaG9vdHJpZ2h0XCI6IFsyNzMrMjQ3LCAyNzMrMjU5LCBcIlwiLCA0MF0sXG5cbiAgICAgIFwiaHVydFwiOiBbMjYwLCAyNjUsIFwiXCIsIDYwXSxcblxuICAgICAgXCJkZWFkXCI6IDI2NSxcblxuICAgICAgXCJmYWNldXBcIjogMTA0LFxuICAgICAgXCJmYWNlbGVmdFwiOiAxMTcsXG4gICAgICBcImZhY2Vkb3duXCI6IDEzMCxcbiAgICAgIFwiZmFjZXJpZ2h0XCI6IDE0M1xuICAgIH1cbiAgfTtcblxuXG59KSgpO1xuIl19