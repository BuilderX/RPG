{"version":3,"sources":["public/src/input.js"],"names":[],"mappings":"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","file":"public/src/input.js","sourcesContent":["/*\n\nA-RPG Game, Built using Node.js + JavaScript + ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n(function () {\n  \"use strict\";\n\n  var keyTable = {\n    \"left\": 37,\n    \"up\": 38,\n    \"right\": 39,\n    \"down\": 40,\n    \"shift\": 16,\n    \"a\": 65,\n    \"b\": 66,\n    \"c\": 67,\n    \"d\": 68,\n    \"e\": 69,\n    \"f\": 70,\n    \"g\": 71,\n    \"h\": 72,\n    \"i\": 73,\n    \"j\": 74,\n    \"k\": 75,\n    \"l\": 76,\n    \"m\": 77,\n    \"n\": 78,\n    \"o\": 79,\n    \"p\": 80,\n    \"q\": 81,\n    \"r\": 82,\n    \"s\": 83,\n    \"t\": 84,\n    \"u\": 85,\n    \"v\": 86,\n    \"w\": 87,\n    \"x\": 88,\n    \"y\": 89,\n    \"z\": 90,\n    \"0\": 48,\n    \"1\": 49,\n    \"2\": 50,\n    \"3\": 51,\n    \"4\": 52,\n    \"5\": 53,\n    \"6\": 54,\n    \"7\": 55,\n    \"8\": 56,\n    \"9\": 57\n  };\n\n  var pressed = {};\n\n  // 封装Game.key.isPressed方法，用来检测某个案件是否按下\n  // usage: if (Game.key.isPressed(\"left\")) { /* true */ } else { /* false */ }\n  Game.key = {\n    isPressed: function (keyStr) {\n      if (pressed.hasOwnProperty(keyStr))\n        return pressed[keyStr];\n      return pressed[keyTable[keyStr]];\n    }\n  };\n\n  function HotKey (keyCode) {\n\n    if (Game.dialogue.talkBox && Game.dialogue.talkBox.visible)\n      return;\n\n    if (keyCode == keyTable[\"m\"]) { // map\n      Game.ui.openMap();\n    }\n    if (keyCode == keyTable[\"i\"]) { // map\n      Game.ui.openInformation();\n    }\n    if (keyCode == keyTable[\"b\"]) { // map\n      Game.ui.openItem();\n    }\n    if (keyCode == keyTable[\"e\"]) { // map\n      if (Game.hintObject && Game.hintObject.use) {\n        Game.hintObject.use();\n      }\n    }\n  };\n\n\n  Game.initInput = function () {\n\n    Game.stage.on(\"stagemousedown\", function (event) {\n      pressed[\"mouse\"] = true;\n      //Game.hero.gotoXY(x, y);\n      //console.log();\n    });\n\n    Game.stage.on(\"stagemouseup\", function (event) {\n      if (pressed[\"mouse\"]) delete pressed[\"mouse\"];\n    });\n\n    Game.stage.on(\"mouseleave\", function (event) { // mouse leave canvas\n      if (pressed[\"mouse\"]) delete pressed[\"mouse\"];\n    });\n\n    window.addEventListener(\"keydown\", function (event) {\n      event = event || window.event;\n      var keyCode = event.keyCode;\n\n      pressed[keyCode] = true;\n      HotKey(keyCode);\n    });\n\n    window.addEventListener(\"keyup\", function (event) {\n      event = event || window.event;\n      var keyCode = event.keyCode;\n\n      if (pressed.hasOwnProperty(keyCode)) {\n        delete pressed[keyCode];\n      }\n    });\n\n    Sprite.Ticker.on(\"tick\", function () {\n\n      if (!Game.hero) return;\n      if (!Game.area) return;\n      if (!Game.area.map) return;\n\n      var speed = Game.config.walk;\n      var skew = Game.config.walk / 1.4;\n\n      if (Game.key.isPressed(\"shift\")) { // run key\n        speed = Game.config.run;\n        skew = Game.config.run / 1.4;\n      }\n\n      var state;\n      if (Game.key.isPressed(\"shift\"))\n        state = \"run\";\n      else\n        state = \"walk\";\n\n      /*\n      if (Game.key.isPressed(\"left\")) {\n        Game.stage.center.x += 10;\n        Game.stage.update();\n      } else if (Game.key.isPressed(\"up\")) {\n        Game.stage.center.y += 10;\n        Game.stage.update();\n      } else if (Game.key.isPressed(\"right\")) {\n        Game.stage.center.x -= 10;\n        Game.stage.update();\n      } else if (Game.key.isPressed(\"down\")) {\n        Game.stage.center.y -= 10;\n        Game.stage.update();\n      }\n      */\n\n      // 计算八个方向角色的动画和面向\n      if (Game.key.isPressed(\"up\") && Game.key.isPressed(\"right\")) {\n        Game.hero.go(state, \"upright\", skew);\n      } else if (Game.key.isPressed(\"down\") && Game.key.isPressed(\"right\")) {\n        Game.hero.go(state, \"downright\", skew);\n      } else if (Game.key.isPressed(\"down\") && Game.key.isPressed(\"left\")) {\n        Game.hero.go(state, \"downleft\", skew);\n      } else if (Game.key.isPressed(\"up\") && Game.key.isPressed(\"left\")) {\n        Game.hero.go(state, \"upleft\", skew);\n      } else if (Game.key.isPressed(\"left\")) {\n        Game.hero.go(state, \"left\", speed);\n      } else if (Game.key.isPressed(\"up\")) {\n        Game.hero.go(state, \"up\", speed);\n      } else if (Game.key.isPressed(\"right\")) {\n        Game.hero.go(state, \"right\", speed);\n      } else if (Game.key.isPressed(\"down\")) {\n        Game.hero.go(state, \"down\", speed);\n      } else if (Game.key.isPressed(\"mouse\")) {\n        if (Game.uiLayer.numChildren > 1) {\n          return;\n        }\n        var x = Game.stage.center.x + Game.stage.mouseX / Game.stage.scaleX;\n        var y = Game.stage.center.y + Game.stage.mouseY / Game.stage.scaleY;\n        if (Game.uiLayer.hitTest(x, y)) {\n          return;\n        }\n        x -= Game.hero.x;\n        y -= Game.hero.y;\n\n        if (Math.abs(Math.abs(x) - Math.abs(y)) < 40) {\n          if (x < 0 && y < 0) { // left up\n            Game.hero.go(state, \"upleft\", skew);\n          } else if (x > 0 && y < 0) { // right up\n            Game.hero.go(state, \"upright\", skew);\n          } else if (x < 0 && y > 0) { // left down\n            Game.hero.go(state, \"downleft\", skew);\n          } else if (x > 0 && y > 0) { // right down\n            Game.hero.go(state, \"downright\", skew);\n          }\n        } else if (Math.abs(x) > Math.abs(y)) { // left or right\n          if (x < 0) { // left\n            Game.hero.go(state, \"left\", speed);\n          } else { // right\n            Game.hero.go(state, \"right\", speed);\n          }\n        } else if (Math.abs(x) < Math.abs(y)) { // up or down\n          if (y < 0) { // up\n            Game.hero.go(state, \"up\", speed);\n          } else { // down\n            Game.hero.go(state, \"down\", speed);\n          }\n        }\n      } else {\n        Game.hero.stop();\n      }\n\n      function FindHint () {\n\n        var minDistance = 9999;\n        var minObject = null;\n\n        for (var key in Game.area.actors) {\n          (function (id, actor) {\n            if (!actor.data.use) return;\n            var d = Game.hero.distance(actor.x, actor.y);\n            if (d < minDistance) {\n              minDistance = d;\n              minObject = actor;\n            }\n          })(key, Game.area.actors[key]);\n        }\n\n        if (Game.hintObject) {\n          if (Game.hero.distance(Game.hintObject.x, Game.hintObject.y) >= 30) {\n            Game.dialogueLayer.removeChild(Game.hintFlag);\n            Game.hintFlag = null;\n            Game.hintObject = null;\n            if (Game.ui.useButton) {\n              Game.ui.useButton.visible = false;\n            }\n          }\n        }\n\n        if (minObject) {\n          if (minObject != Game.hintObject && minDistance < 30) {\n            Game.hintObject = minObject;\n            if (Game.hintFlag) {\n              Game.dialogueLayer.removeChild(Game.hintFlag);\n              Game.hintFlag = null;\n            }\n            Game.hintFlag = new Sprite.Bitmap(Game.resources[\"/image/hint.png\"]);\n            Game.hintFlag.x = minObject.x;\n            Game.hintFlag.y = minObject.y;\n            Game.hintFlag.center.x = 0;\n            Game.hintFlag.center.y = Game.hintFlag.height;\n            Game.dialogueLayer.appendChild(Game.hintFlag);\n            if (Game.ui.useButton) {\n              Game.ui.useButton.visible = true;\n            }\n          }\n        }\n\n      }\n\n      FindHint();\n\n\n\n\n\n      if (Game.key.isPressed(\"1\")) {\n        Game.ui.clickSpell(0)\n      }\n\n      if (Game.key.isPressed(\"2\")) {\n        Game.ui.clickSpell(1)\n      }\n\n      if (Game.key.isPressed(\"3\")) {\n        Game.ui.clickSpell(2)\n      }\n\n      if (Game.key.isPressed(\"4\")) {\n        Game.ui.clickSpell(3)\n      }\n\n      if (Game.key.isPressed(\"5\")) {\n        Game.ui.clickSpell(4)\n      }\n\n      if (Game.key.isPressed(\"6\")) {\n        Game.ui.clickSpell(5)\n      }\n\n      if (Game.key.isPressed(\"7\")) {\n        Game.ui.clickSpell(6)\n      }\n\n      if (Game.key.isPressed(\"8\")) {\n        Game.ui.clickSpell(7)\n      }\n\n      if (Game.key.isPressed(\"9\")) {\n        Game.ui.clickSpell(8)\n      }\n\n      Game.hero.focus();\n    });\n  }; // Game.oninit\n\n})();\n"]}