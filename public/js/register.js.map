{"version":3,"sources":["public/src/register.js"],"names":[],"mappings":"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","file":"public/src/register.js","sourcesContent":["/*\n\nA-RPG Game, Built using Node.js + JavaScript + ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n(function () {\n  \"use strict\";\n\n  Game.register = {};\n\n\n\n  // 英雄组件数据\n  var heroCustom = {\n    sex: \"male\",\n    body: \"light\",\n    eyes: \"blue\",\n    hair: \"\",\n    haircolor: \"black\",\n\n    head: \"\",\n    shirts: \"\",\n    pants: \"\",\n    shoes: \"\",\n\n    armorchest: \"\",\n    armorarm: \"\",\n    armorlegs: \"\",\n    armorhelms: \"\",\n    armorfeet: \"\"\n  };\n\n  // 13x21\n  heroCustom.width = 64 * 13; // 832;\n  heroCustom.height = 64 * 21; // 1344;\n  heroCustom.width *= 0.8125;\n  heroCustom.height *= 0.9375;\n  heroCustom.tilewidth = heroCustom.width / 13;\n  heroCustom.tileheight = heroCustom.height / 21;\n\n  Init();\n\n  function Init () {\n\n    window.SelectHero = function (event) {\n      if (heroCustom.sex == \"male\") {\n        document.getElementById(\"customMaleHair\").style.display = \"block\";\n        document.getElementById(\"customFemaleHair\").style.display = \"none\";\n      } else {\n        document.getElementById(\"customMaleHair\").style.display = \"none\";\n        document.getElementById(\"customFemaleHair\").style.display = \"block\";\n      }\n      var value = event.target.value;\n      var type = event.target.getAttribute(\"data-type\");\n      if (heroCustom[type] != value) {\n        heroCustom[type] = value;\n        DisplayHero();\n      }\n    };\n\n    DisplayHero();\n\n    function DisplayHero () {\n\n      var canvas = document.getElementById(\"registerPreview\");\n      var context = canvas.getContext(\"2d\");\n      context.clearRect(0, 0, canvas.width, canvas.height);\n\n      document.getElementById(\"loading\").innerHTML = \"正在载入预览\";\n      Game.drawHero(heroCustom, function (img) {\n        context.drawImage(img, 0, -128, img.width, img.height);\n        document.getElementById(\"loading\").innerHTML = \"预览\";\n      });\n    }\n\n  }\n\n  // 注册模块\n  Game.register.reg = function () {\n    document.getElementById(\"registerHeroName\").value = \"\";\n    window.ShowGameWindow(\"registerWindow\");\n    Init();\n  };\n\n  Game.register.back = function () {\n    window.ShowGameWindow(\"mainWindow\");\n  };\n\n  Game.register.submit = function () {\n    var name = document.getElementById(\"registerHeroName\").value;\n\n    if (name.trim().length <= 0) {\n      alert(\"Invalid Name\");\n      return;\n    }\n\n    HeroDefault.id = \"hero_\" + name;\n    HeroDefault.name = name;\n    HeroDefault.custom = heroCustom;\n    HeroDefault.tilewidth = heroCustom.tilewidth;\n    HeroDefault.tileheight = heroCustom.tileheight;\n\n    // 保存一个存档\n    Game.archive.save({\n      hero: HeroDefault\n    });\n\n    // 空调用，代表读取最新一个存档（last），即刚刚新建的存档\n    Game.archive.load();\n  };\n\n\n  var HeroDefault = {\n    level: 1, // 等级\n    exp: 0, // 经验值\n\n    // 最基本的属性，其他属性都由此延伸\n    $str: 10, // strength 攻击\n    $dex: 10, // dexterity 闪避\n    $int: 10, // intelligence 魔法攻击\n    $con: 10, // constitution 生命值\n    $cha: 10, // charisma 队友能力\n\n    str: 10,\n    dex: 10,\n    int: 10,\n    con: 10,\n    cha: 10,\n\n    $hp: 1, // 生命力\n    $sp: 1, // 精神力\n\n    hp: 1,\n    sp: 1,\n\n    atk: 1, // 攻击\n    def: 1, // 防御\n    matk: 1, // 魔法攻击\n    mdef: 1, // 魔法防御\n\n    buff: [], // 有益状态\n    nerf: [], // 有害状态\n\n    currentQuest: { }, // 当前任务\n    pastQuest: { }, // 完成的任务\n\n    area: \"town0001\", // 当前所在地图\n\n    type: \"hero\", // 标识这个actor的类别是hero，其他类别如npc，monster\n\n    // 能力\n    skills: [\n      \"spell0001\", // 普通剑攻击\n      \"spell0002\", // 普通枪攻击\n      \"spell0003\", // 普通弓攻击\n      \"spell0004\", // 火球术\n    ],\n    // 一共能学习多少能力\n    spellcount: 14,\n    // 技能快捷方式列表\n    spellbar: [\n      \"spell0001\",\n    ],\n\n    // 技能，例如生活技能，说服技能，交易技能\n    //skills: {\n    //  _trade: 0, // 交易，交易时的价格\n    //  _negotiate: 0, // 交涉，具体剧情，招揽同伴时的费用\n    //  _lock: 0, // 开锁\n    //  _knowledge: 0, // 知识，具体剧情，鉴定物品\n    //  _treatment: 0, // 医疗，在使用医疗物品时的效果\n    //  _animal: 0, // 动物战斗加成，动物驯养\n    //},\n\n    equipment: {\n      head: null,\n      neck: null,\n      body: \"item0005\",\n      feet: \"item0006\",\n      righthand: \"item0002\",\n      lefthand: null,\n      leftring: null,\n      rightring: null\n    },\n\n    items: [\n      { id: \"item0003\", count: 1 },\n      { id: \"item0004\", count: 1 },\n    ],\n\n    gold: 0,\n\n    animations: {\n      spellcastup: [0, 6, \"\", 800],\n      spellcastleft: [13, 19, \"\", 800],\n      spellcastdown: [26, 32, \"\", 800],\n      spellcastright: [39, 45, \"\", 800],\n\n      thrustup: [52, 59, \"\", 800],\n      thrustleft: [65, 72, \"\", 800],\n      thrustdown: [78, 85, \"\", 800],\n      thrustright: [91, 98, \"\", 800],\n\n      walkup: [104, 112, \"walkup\", 500],\n      walkleft: [117, 125, \"walkleft\", 500],\n      walkdown: [130, 138, \"walkdown\", 500],\n      walkright: [143, 151, \"walkright\", 500],\n\n      runup: [104, 112, \"runup\", 300],\n      runleft: [117, 125, \"runleft\", 300],\n      rundown: [130, 138, \"rundown\", 300],\n      runright: [143, 151, \"runright\", 300],\n\n      slashup: [156, 161, \"\", 800],\n      slashleft: [169, 174, \"\", 800],\n      slashdown: [182, 187, \"\", 800],\n      slashright: [195, 200, \"\", 800],\n\n      shootup: [208, 220, \"\", 800],\n      shootleft: [221, 233, \"\", 800],\n      shootdown: [234, 246, \"\", 800],\n      shootright: [247, 259, \"\", 800],\n\n      hurt: [260, 265, \"\", 0.3],\n\n      dead: 265,\n\n      faceup: 104,\n      faceleft: 117,\n      facedown: 130,\n      faceright: 143\n    }\n  };\n\n\n})();\n"]}