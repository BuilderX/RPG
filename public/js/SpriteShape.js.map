{"version":3,"sources":["src/SpriteShape.js"],"names":[],"mappings":"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","file":"src/SpriteShape.js","sourcesContent":["\n(function () {\n  \"use strict\";\n\n  Sprite.Shape = class Shape extends Sprite.Display {\n    constructor () {\n      super();\n      this._children = [];\n      this._width = 0;\n      this._height = 0;\n      this._image = null;\n    }\n\n    clone () {\n      var shape = new Shape();\n      shape._children = this._children.slice();\n      shape._width = this._width;\n      shape._height = this._height;\n      shape._image = this._image;\n      shape.x = this.x;\n      shape.y = this.y;\n      shape.center.x = this.center.x;\n      shape.center.y = this.center.y;\n      shape.scale.x = this.scale.x;\n      shape.scale.y = this.scale.y;\n      return shape;\n    }\n\n    get svg () {\n      return this._svg;\n    }\n\n    set svg (value) {\n      throw new TypeError(\"Sprite.Shape.svg readonly\");\n    }\n\n    get width () {\n      return this._width;\n    }\n\n    set width (value) {\n      this._width = value;\n      this.generate();\n    }\n\n    get height () {\n      return this._height;\n    }\n\n    set height (value) {\n      this._height = value;\n      this.generate();\n    }\n\n    clear () {\n      this._children = [];\n      this._width = 0;\n      this._height = 0;\n      this.generate();\n      return this;\n    }\n\n    makeConfig (defaultConfig, userConfig) {\n      if (userConfig) {\n        for (let key in userConfig) {\n          defaultConfig[key] = userConfig[key];\n        }\n      }\n      var ret = [];\n      for (let key in defaultConfig) {\n        ret.push(`${key}=\"${defaultConfig[key]}\"`);\n      }\n      return ret.join(\" \");\n    }\n\n    rect (userConfig) {\n      var config = {\n        \"x\": 0,\n        \"y\": 0,\n        \"width\": 10,\n        \"height\": 10,\n        \"stroke\": \"black\",\n        \"stroke-width\": 1,\n        \"fill\": \"white\",\n        \"fill-opacity\": 1,\n        \"stroke-opacity\": 1,\n        \"opacity\": 1,\n      };\n\n      this._children.push(`<rect ${this.makeConfig(config, userConfig)} />`);\n\n      if (config.x + config.width > this._width) {\n        this._width = config.x + config.width;\n      }\n      if (config.y + config.height > this._height) {\n        this._height = config.y + config.height;\n      }\n      this.generate();\n    }\n\n    circle (userConfig) {\n      var config = {\n        \"cx\": 10,\n        \"cy\": 10,\n        \"r\": 10,\n        \"stroke\": \"black\",\n        \"stroke-width\": 1,\n        \"fill\": \"white\",\n        \"fill-opacity\": 1,\n        \"stroke-opacity\": 1,\n        \"opacity\": 1,\n      };\n\n      this._children.push(`<circle ${this.makeConfig(config, userConfig)} />`);\n\n      if (config.cx + config.r > this._width) {\n        this._width = config.cx + config.r;\n      }\n      if (config.cy + config.r > this._height) {\n        this._height = config.cy + config.r;\n      }\n      this.generate();\n    }\n\n    ellipse (userConfig) {\n      var config = {\n        \"cx\": 10,\n        \"cy\": 10,\n        \"rx\": 5,\n        \"ry\": 10,\n        \"stroke\": \"black\",\n        \"stroke-width\": 1,\n        \"fill\": \"white\",\n        \"fill-opacity\": 1,\n        \"stroke-opacity\": 1,\n        \"opacity\": 1,\n      };\n\n      this._children.push(`<ellipse ${this.makeConfig(config, userConfig)} />`);\n\n      if (config.cx + config.rx > this._width) {\n        this._width = config.cx + config.rx;\n      }\n      if (config.cy + config.ry > this._height) {\n        this._height = config.cy + config.ry;\n      }\n      this.generate();\n    }\n\n    line (userConfig) {\n      var config = {\n        \"x1\": 10,\n        \"y1\": 10,\n        \"x2\": 20,\n        \"y2\": 20,\n        \"stroke\": \"black\",\n        \"stroke-width\": 1,\n        \"stroke-opacity\": 1,\n        \"opacity\": 1,\n      };\n\n      this._children.push(`<line ${this.makeConfig(config, userConfig)} />`);\n\n      if (Math.max(config.x1, config.x2) > this._width) {\n        this._width = Math.max(config.x1, config.x2);\n      }\n      if (Math.max(config.y1, config.y2) > this._height) {\n        this._height = Math.max(config.y1, config.y2);\n      }\n      this.generate();\n    }\n\n    polyline (userConfig) {\n      var defaultConfig = {\n        \"points\": \"20, 20, 30, 20, 30, 30, 20, 30\",\n        \"stroke\": \"black\",\n        \"stroke-width\": 1,\n        \"fill\": \"white\",\n        \"fill-opacity\": 1,\n        \"stroke-opacity\": 1,\n        \"opacity\": 1,\n      };\n\n      this._children.push(`<polyline ${this.makeConfig(config, userConfig)} />`);\n\n      var max = -1;\n      config.points.split(/, /).forEach((element) => {\n        var number = parseInt(element);\n        if (!isNaN(number) && number > max) {\n          max = number;\n        }\n      });\n\n      if (max != -1) {\n        this._width = max;\n        this._height = max;\n      }\n      this.generate();\n    }\n\n    polygon (userConfig) {\n      var config = {\n        \"points\": \"20, 20, 30, 20, 30, 30, 20, 30\",\n        \"stroke\": \"black\",\n        \"stroke-width\": 1,\n        \"fill\": \"white\",\n        \"fill-opacity\": 1,\n        \"stroke-opacity\": 1,\n        \"opacity\": 1,\n      };\n\n      this._children.push(`<polyline ${this.makeConfig(config, userConfig)} />`);\n\n      var max = -1;\n      config.points.split(/, /).forEach((element) => {\n        var number = parseInt(element);\n        if (!isNaN(number) && number > max) {\n          max = number;\n        }\n      });\n\n      if (max != -1) {\n        this._width = max;\n        this._height = max;\n      }\n      this.generate();\n    }\n\n    generate () {\n      var svg = `<?xml version=\"1.0\"?>\\n<svg width=\"${this._width}\" height=\"${this._height}\" ` +\n        `style=\"width: ${this._width}px; height: ${this._height}px;\" ` +\n        `xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\">\\n`;\n\n      this._children.forEach((shape) => {\n        svg += `  ${shape}\\n`;\n      });\n\n      svg += \"</svg>\";\n      this._svg = svg;\n\n      var blob = new Blob([svg], {type: \"image/svg+xml;charset=utf-8\"});\n      var url = window.URL.createObjectURL(blob);\n      var image = new Image();\n      image.src = url;\n\n      var Done = () => {\n        this._image = image;\n        this._width = image.width;\n        this._height = image.height;\n        window.URL.revokeObjectURL(url);\n        this.emit(\"change\");\n      };\n\n      if (image.complete) {\n        Done();\n      } else {\n        image.onload = Done;\n      }\n\n    }\n\n    draw (context) {\n      if (this._image instanceof Image && this._image.width > 0 && this._image.height > 0) {\n        this.drawImage(context, this._image,\n          0, 0, this._image.width, this._image.height,\n          0, 0, this._image.width, this._image.height\n        );\n      }\n    }\n  };\n\n})();\n"]}